<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥ | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content="è¥é”€å½’å› ,ROIåˆ†æ,è½¬åŒ–å½’å› ,å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼,è¥é”€é¢„ç®—,æ•ˆæœè¯„ä¼°"><meta name=description content="å…¨é¢è§£æè¥é”€å½’å› æ¨¡å‹å’ŒROIåˆ†ææ–¹æ³•ï¼Œä»å¤šè§¦ç‚¹å½’å› ã€LTVè®¡ç®—åˆ°é¢„ç®—ä¼˜åŒ–ï¼Œå¸®åŠ©ä¼ä¸šç§‘å­¦è¯„ä¼°è¥é”€æ•ˆæœï¼Œä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”ã€‚"><meta name=author content="æœ‰æ¡å·¥å…·å›¢é˜Ÿ"><link rel=canonical href=/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥"><meta property="og:description" content="å…¨é¢è§£æè¥é”€å½’å› æ¨¡å‹å’ŒROIåˆ†ææ–¹æ³•ï¼Œä»å¤šè§¦ç‚¹å½’å› ã€LTVè®¡ç®—åˆ°é¢„ç®—ä¼˜åŒ–ï¼Œå¸®åŠ©ä¼ä¸šç§‘å­¦è¯„ä¼°è¥é”€æ•ˆæœï¼Œä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”ã€‚"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-12-23T18:00:00+08:00"><meta property="article:modified_time" content="2025-12-23T18:00:00+08:00"><meta property="article:tag" content="è¥é”€å½’å› "><meta property="article:tag" content="ROIåˆ†æ"><meta property="article:tag" content="è¥é”€æ•ˆæœ"><meta property="article:tag" content="æ•°æ®åˆ†æ"><meta property="article:tag" content="é¢„ç®—ä¼˜åŒ–"><meta name=twitter:card content="summary"><meta name=twitter:title content="è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥"><meta name=twitter:description content="å…¨é¢è§£æè¥é”€å½’å› æ¨¡å‹å’ŒROIåˆ†ææ–¹æ³•ï¼Œä»å¤šè§¦ç‚¹å½’å› ã€LTVè®¡ç®—åˆ°é¢„ç®—ä¼˜åŒ–ï¼Œå¸®åŠ©ä¼ä¸šç§‘å­¦è¯„ä¼°è¥é”€æ•ˆæœï¼Œä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"æ‰€æœ‰æ–‡ç« ","item":"/blog/posts/"},{"@type":"ListItem","position":2,"name":"è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥","item":"/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥","name":"è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥","description":"å…¨é¢è§£æè¥é”€å½’å› æ¨¡å‹å’ŒROIåˆ†ææ–¹æ³•ï¼Œä»å¤šè§¦ç‚¹å½’å› ã€LTVè®¡ç®—åˆ°é¢„ç®—ä¼˜åŒ–ï¼Œå¸®åŠ©ä¼ä¸šç§‘å­¦è¯„ä¼°è¥é”€æ•ˆæœï¼Œä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”ã€‚","keywords":["è¥é”€å½’å› ","ROIåˆ†æ","è½¬åŒ–å½’å› ","å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼","è¥é”€é¢„ç®—","æ•ˆæœè¯„ä¼°"],"articleBody":"å¼•è¨€ åœ¨æ•°å­—åŒ–è¥é”€æ—¶ä»£ï¼Œä¼ä¸šåœ¨å„ä¸ªæ¸ é“æŠ•å…¥å¤§é‡é¢„ç®—ï¼Œä½†å¦‚ä½•å‡†ç¡®è¡¡é‡æ¯ä¸ªæ¸ é“çš„è´¡çŒ®ï¼Ÿå¦‚ä½•ç§‘å­¦åœ°è¯„ä¼°è¥é”€ROIï¼Ÿæœ¬æ–‡å°†ç³»ç»Ÿè®²è§£è¥é”€å½’å› å’ŒROIåˆ†æçš„æ–¹æ³•è®ºã€‚\nä¸€ã€è¥é”€å½’å› æ¨¡å‹ 1.1 å½’å› æ¨¡å‹ç±»å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 è¥é”€å½’å› æ¨¡å‹: å•è§¦ç‚¹å½’å› : æœ€åç‚¹å‡» (Last Click): æè¿°: è½¬åŒ–å‰æœ€åä¸€æ¬¡è§¦ç‚¹è·å¾—100%åŠŸåŠ³ ä¼˜åŠ¿: ç®€å•æ˜“ç†è§£ åŠ£åŠ¿: å¿½ç•¥å…¶ä»–è§¦ç‚¹è´¡çŒ® é€‚ç”¨: çŸ­å†³ç­–å‘¨æœŸã€å•ä¸€æ¸ é“ é¦–æ¬¡ç‚¹å‡» (First Click): æè¿°: ç¬¬ä¸€æ¬¡è§¦ç‚¹è·å¾—100%åŠŸåŠ³ ä¼˜åŠ¿: é‡è§†è·å®¢æ¸ é“ åŠ£åŠ¿: å¿½ç•¥åç»­åŸ¹è‚² é€‚ç”¨: å“ç‰Œè®¤çŸ¥ã€çº¿ç´¢è·å– æœ«æ¬¡ç‚¹å‡» (Last Non-Direct Click): æè¿°: æ’é™¤ç›´æ¥è®¿é—®çš„æœ€åç‚¹å‡»è·100%åŠŸåŠ³ ä¼˜åŠ¿: æ›´å‡†ç¡®åæ˜ æ¸ é“ä»·å€¼ åŠ£åŠ¿: ä»ç„¶ç®€å•åŒ– é€‚ç”¨: å¤šæ¸ é“è¥é”€ å¤šè§¦ç‚¹å½’å› : çº¿æ€§å½’å›  (Linear): æè¿°: æ‰€æœ‰è§¦ç‚¹å¹³å‡åˆ†é…åŠŸåŠ³ å…¬å¼: 100% / N (æ¯ä¸ªè§¦ç‚¹) ä¼˜åŠ¿: è€ƒè™‘æ‰€æœ‰è§¦ç‚¹ åŠ£åŠ¿: å¿½ç•¥å¾®å¦™å·®å¼‚ é€‚ç”¨: é•¿å†³ç­–å‘¨æœŸ æ—¶é—´è¡°å‡ (Time Decay): æè¿°: è¶Šæ¥è¿‘è½¬åŒ–çš„è§¦ç‚¹æƒé‡è¶Šé«˜ å…¬å¼: æŒ‡æ•°è¡°å‡å‡½æ•° ä¼˜åŠ¿: åæ˜ æ—¶é—´å½±å“ åŠ£åŠ¿: å¯èƒ½å¿½ç•¥æ—©æœŸè§¦ç‚¹ é€‚ç”¨: è¾ƒé•¿å†³ç­–å‘¨æœŸ ä½ç½®å½’å›  (Position Based): æè¿°: é¦–å°¾è§¦ç‚¹40%+40%ï¼Œä¸­é—´20% å…¬å¼: é¦–40% + ä¸­é—´å¹³åˆ†20% + å°¾40% ä¼˜åŠ¿: é‡è§†è·å®¢å’Œè½¬åŒ– åŠ£åŠ¿: å›ºå®šæ¯”ä¾‹å¯èƒ½ä¸é€‚ç”¨ é€‚ç”¨: å“ç‰Œä¸è½¬åŒ–å¹¶é‡ Uå‹å½’å›  (U-Shaped): æè¿°: åŒä½ç½®å½’å› ï¼ˆé¦–å°¾å„40%ï¼‰ é€‚ç”¨: é‡è§†é¦–æ¬¡äº’åŠ¨å’Œæœ€ç»ˆè½¬åŒ– ç®—æ³•å½’å› : æ•°æ®é©±åŠ¨ (Data-Driven): æè¿°: åŸºäºå†å²æ•°æ®è®¡ç®—æƒé‡ æ–¹æ³•: æœºå™¨å­¦ä¹ ç®—æ³• ä¼˜åŠ¿: æœ€å‡†ç¡® åŠ£åŠ¿: éœ€è¦å¤§é‡æ•°æ® é€‚ç”¨: å¤§å‹ä¼ä¸šã€æˆç†Ÿæ•°æ®ä½“ç³» Shapleyå€¼: æè¿°: åšå¼ˆè®ºæ–¹æ³•è®¡ç®—è¾¹é™…è´¡çŒ® æ–¹æ³•: Shapley Valueç®—æ³• ä¼˜åŠ¿: ç†è®ºä¸Šæœ€å…¬å¹³ åŠ£åŠ¿: è®¡ç®—å¤æ‚ é€‚ç”¨: ç²¾ç¡®åˆ†æéœ€æ±‚ 1.2 å½’å› æ¨¡å‹å®ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 # è¥é”€å½’å› æ¨¡å‹å®ç° import pandas as pd import numpy as np from typing import List, Dict class MarketingAttribution: \"\"\"è¥é”€å½’å› åˆ†æ\"\"\" def __init__(self, touchpoint_data): \"\"\" touchpoint_data: è§¦ç‚¹æ•°æ® [{ 'user_id': 'user_001', 'journey': ['organic', 'social', 'email', 'direct'], 'conversion': 1, 'value': 99 }] \"\"\" self.data = touchpoint_data def last_click_attribution(self): \"\"\"æœ€åç‚¹å‡»å½’å› \"\"\" attribution_results = [] for journey_data in self.data: journey = journey_data['journey'] if len(journey) \u003e 0 and journey_data['conversion']: last_touch = journey[-1] attribution_results.append({ 'user_id': journey_data['user_id'], 'attributed_channel': last_touch, 'value': journey_data['value'], 'model': 'last_click' }) df = pd.DataFrame(attribution_results) return df.groupby('attributed_channel')['value'].sum().to_dict() def first_click_attribution(self): \"\"\"é¦–æ¬¡ç‚¹å‡»å½’å› \"\"\" attribution_results = [] for journey_data in self.data: journey = journey_data['journey'] if len(journey) \u003e 0 and journey_data['conversion']: first_touch = journey[0] attribution_results.append({ 'user_id': journey_data['user_id'], 'attributed_channel': first_touch, 'value': journey_data['value'], 'model': 'first_click' }) df = pd.DataFrame(attribution_results) return df.groupby('attributed_channel')['value'].sum().to_dict() def linear_attribution(self): \"\"\"çº¿æ€§å½’å› \"\"\" attribution_results = [] for journey_data in self.data: journey = journey_data['journey'] if len(journey) \u003e 0 and journey_data['conversion']: value_per_touch = journey_data['value'] / len(journey) for touch in journey: attribution_results.append({ 'user_id': journey_data['user_id'], 'attributed_channel': touch, 'value': value_per_touch, 'model': 'linear' }) df = pd.DataFrame(attribution_results) return df.groupby('attributed_channel')['value'].sum().to_dict() def time_decay_attribution(self, decay_rate=0.5): \"\"\" æ—¶é—´è¡°å‡å½’å›  decay_rate: è¡°å‡ç‡ \"\"\" attribution_results = [] for journey_data in self.data: journey = journey_data['journey'] if len(journey) \u003e 0 and journey_data['conversion']: # è®¡ç®—æƒé‡ï¼ˆæœ€è¿‘è§¦ç‚¹æƒé‡æœ€é«˜ï¼‰ positions = list(range(len(journey))) weights = [decay_rate ** (len(journey) - 1 - pos) for pos in positions] total_weight = sum(weights) # å½’ä¸€åŒ–æƒé‡ normalized_weights = [w / total_weight for w in weights] # åˆ†é…ä»·å€¼ for i, touch in enumerate(journey): attributed_value = journey_data['value'] * normalized_weights[i] attribution_results.append({ 'user_id': journey_data['user_id'], 'attributed_channel': touch, 'value': attributed_value, 'model': 'time_decay' }) df = pd.DataFrame(attribution_results) return df.groupby('attributed_channel')['value'].sum().to_dict() def position_based_attribution(self, first_last_weight=0.4): \"\"\" ä½ç½®å½’å›  first_last_weight: é¦–å°¾è§¦ç‚¹æƒé‡ï¼ˆé»˜è®¤40%ï¼‰ \"\"\" attribution_results = [] for journey_data in self.data: journey = journey_data['journey'] if len(journey) \u003e 0 and journey_data['conversion']: journey_len = len(journey) if journey_len == 1: # åªæœ‰ä¸€ä¸ªè§¦ç‚¹ï¼Œè·å¾—100% weights = [1.0] elif journey_len == 2: # ä¸¤ä¸ªè§¦ç‚¹ï¼Œå„50% weights = [0.5, 0.5] else: # é¦–å°¾å„40%ï¼Œä¸­é—´å¹³åˆ†20% middle_weight = (1 - 2 * first_last_weight) / (journey_len - 2) weights = [first_last_weight] + \\ [middle_weight] * (journey_len - 2) + \\ [first_last_weight] # åˆ†é…ä»·å€¼ for i, touch in enumerate(journey): attributed_value = journey_data['value'] * weights[i] attribution_results.append({ 'user_id': journey_data['user_id'], 'attributed_channel': touch, 'value': attributed_value, 'model': 'position_based' }) df = pd.DataFrame(attribution_results) return df.groupby('attributed_channel')['value'].sum().to_dict() def compare_models(self): \"\"\"å¯¹æ¯”ä¸åŒå½’å› æ¨¡å‹\"\"\" results = { 'last_click': self.last_click_attribution(), 'first_click': self.first_click_attribution(), 'linear': self.linear_attribution(), 'time_decay': self.time_decay_attribution(), 'position_based': self.position_based_attribution() } # è½¬æ¢ä¸ºDataFrameæ–¹ä¾¿æ¯”è¾ƒ comparison_df = pd.DataFrame(results).fillna(0) return comparison_df äºŒã€ROIè®¡ç®—æ–¹æ³• 2.1 åŸºç¡€ROIè®¡ç®— 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 # ROIè®¡ç®—å·¥å…· class ROICalculator: \"\"\"ROIè®¡ç®—å™¨\"\"\" @staticmethod def calculate_basic_roi(revenue, cost): \"\"\" è®¡ç®—åŸºç¡€ROI revenue: æ”¶å…¥ cost: æˆæœ¬ \"\"\" if cost == 0: return float('inf') roi = ((revenue - cost) / cost) * 100 return round(roi, 2) @staticmethod def calculate_roas(revenue, ad_spend): \"\"\" è®¡ç®—ROAS (Return on Ad Spend) revenue: æ”¶å…¥ ad_spend: å¹¿å‘ŠèŠ±è´¹ \"\"\" if ad_spend == 0: return float('inf') roas = revenue / ad_spend return round(roas, 2) @staticmethod def calculate_break_even_roas(profit_margin): \"\"\" è®¡ç®—ç›ˆäºå¹³è¡¡ROAS profit_margin: åˆ©æ¶¦ç‡ (0-1) \"\"\" if profit_margin == 0: return float('inf') break_even_roas = 1 / profit_margin return round(break_even_roas, 2) @staticmethod def calculate_ltv_cac_ratio(ltv, cac): \"\"\" è®¡ç®—LTV/CACæ¯”ç‡ ltv: ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ cac: è·å®¢æˆæœ¬ \"\"\" if cac == 0: return float('inf') ratio = ltv / cac return round(ratio, 2) @staticmethod def calculate_payback_period(cac, monthly_arpu): \"\"\" è®¡ç®—å›æœ¬å‘¨æœŸ cac: è·å®¢æˆæœ¬ monthly_arpu: æœˆå‡æ¯ç”¨æˆ·æ”¶å…¥ \"\"\" if monthly_arpu == 0: return float('inf') payback_months = cac / monthly_arpu return round(payback_months, 1) def calculate_channel_roi(self, channel_data): \"\"\" è®¡ç®—å„æ¸ é“ROI channel_data: { 'channel_name': { 'spend': å¹¿å‘ŠèŠ±è´¹, 'impressions': å±•ç¤ºæ¬¡æ•°, 'clicks': ç‚¹å‡»æ¬¡æ•°, 'conversions': è½¬åŒ–æ¬¡æ•°, 'revenue': æ”¶å…¥ } } \"\"\" results = [] for channel, data in channel_data.items(): spend = data['spend'] revenue = data['revenue'] clicks = data['clicks'] conversions = data['conversions'] # åŸºç¡€æŒ‡æ ‡ roi = self.calculate_basic_roi(revenue, spend) roas = self.calculate_roas(revenue, spend) # è¡ç”ŸæŒ‡æ ‡ cpc = spend / clicks if clicks \u003e 0 else 0 cpa = spend / conversions if conversions \u003e 0 else 0 ctr = (clicks / data['impressions'] * 100) if data['impressions'] \u003e 0 else 0 cvr = (conversions / clicks * 100) if clicks \u003e 0 else 0 results.append({ 'channel': channel, 'spend': round(spend, 2), 'revenue': round(revenue, 2), 'profit': round(revenue - spend, 2), 'roi': f\"{roi}%\", 'roas': f\"{roas}x\", 'cpc': round(cpc, 2), 'cpa': round(cpa, 2), 'ctr': round(ctr, 2), 'cvr': round(cvr, 2) }) return pd.DataFrame(results) def calculate_marketing_mix_roi(self, marketing_data): \"\"\" è®¡ç®—è¥é”€ç»„åˆROI marketing_data: { 'channels': æ¸ é“æ•°æ®, 'total_revenue': æ€»æ”¶å…¥, 'baseline_revenue': åŸºçº¿æ”¶å…¥ï¼ˆæ— è¥é”€æŠ•å…¥ï¼‰ } \"\"\" total_spend = sum(ch['spend'] for ch in marketing_data['channels'].values()) incremental_revenue = marketing_data['total_revenue'] - marketing_data['baseline_revenue'] marketing_roi = self.calculate_basic_roi(incremental_revenue, total_spend) marketing_roas = self.calculate_roas(incremental_revenue, total_spend) return { 'total_spend': round(total_spend, 2), 'total_revenue': round(marketing_data['total_revenue'], 2), 'baseline_revenue': round(marketing_data['baseline_revenue'], 2), 'incremental_revenue': round(incremental_revenue, 2), 'marketing_roi': f\"{marketing_roi}%\", 'marketing_roas': f\"{marketing_roas}x\" } 2.2 å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 # LTVè®¡ç®—æ¨¡å‹ class LifetimeValueCalculator: \"\"\"å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼è®¡ç®—å™¨\"\"\" def __init__(self, customer_data): \"\"\" customer_data: å®¢æˆ·æ•°æ® å¿…éœ€åˆ—: customer_id, purchase_date, revenue \"\"\" self.data = customer_data def calculate_simple_ltv(self, avg_purchase_value, purchase_frequency, lifespan): \"\"\" ç®€å•LTVè®¡ç®— avg_purchase_value: å¹³å‡è´­ä¹°é‡‘é¢ purchase_frequency: è´­ä¹°é¢‘ç‡ï¼ˆæ¬¡/å¹´ï¼‰ lifespan: å®¢æˆ·ç”Ÿå‘½å‘¨æœŸï¼ˆå¹´ï¼‰ \"\"\" ltv = avg_purchase_value * purchase_frequency * lifespan return round(ltv, 2) def calculate_advanced_ltv(self): \"\"\" é«˜çº§LTVè®¡ç®—ï¼ˆåŸºäºå†å²æ•°æ®ï¼‰ \"\"\" # è®¡ç®—æ¯ä¸ªå®¢æˆ·çš„æŒ‡æ ‡ customer_metrics = self.data.groupby('customer_id').agg({ 'revenue': ['sum', 'mean', 'count'], 'purchase_date': ['min', 'max'] }).reset_index() customer_metrics.columns = [ 'customer_id', 'total_revenue', 'avg_purchase_value', 'purchase_count', 'first_purchase', 'last_purchase' ] # è®¡ç®—å®¢æˆ·ç”Ÿå‘½å‘¨æœŸï¼ˆå¤©æ•°ï¼‰ customer_metrics['lifespan_days'] = ( customer_metrics['last_purchase'] - customer_metrics['first_purchase'] ).dt.days + 1 # è®¡ç®—å¹´åº¦è´­ä¹°é¢‘ç‡ customer_metrics['purchase_frequency'] = ( customer_metrics['purchase_count'] / (customer_metrics['lifespan_days'] / 365) ).fillna(0) # è®¡ç®—LTV customer_metrics['ltv'] = ( customer_metrics['avg_purchase_value'] * customer_metrics['purchase_frequency'] * (customer_metrics['lifespan_days'] / 365) ) # æ•´ä½“æŒ‡æ ‡ metrics = { 'avg_ltv': customer_metrics['ltv'].mean(), 'median_ltv': customer_metrics['ltv'].median(), 'avg_purchase_value': customer_metrics['avg_purchase_value'].mean(), 'avg_purchase_frequency': customer_metrics['purchase_frequency'].mean(), 'avg_lifespan_days': customer_metrics['lifespan_days'].mean() } return { 'customer_metrics': customer_metrics, 'summary': {k: round(v, 2) for k, v in metrics.items()} } def calculate_cohort_ltv(self): \"\"\"åŒæœŸç¾¤LTVåˆ†æ\"\"\" # è·å–é¦–æ¬¡è´­ä¹°æœˆä»½ self.data['first_purchase_month'] = self.data.groupby('customer_id')['purchase_date'].transform('min').dt.to_period('M') # æŒ‰åŒæœŸç¾¤å’Œæœˆä»½åˆ†ç»„ cohort_revenue = self.data.groupby( ['first_purchase_month', 'purchase_date'] )['revenue'].sum().reset_index() # è®¡ç®—ç´¯è®¡æ”¶å…¥ cohort_revenue['period_number'] = ( cohort_revenue['purchase_date'].dt.to_period('M') - cohort_revenue['first_purchase_month'] ).apply(lambda x: x.n) cohort_pivot = cohort_revenue.pivot( index='first_purchase_month', columns='period_number', values='revenue' ).cumsum(axis=1) return cohort_pivot def predict_ltv(self, features, target='ltv'): \"\"\" é¢„æµ‹LTVï¼ˆä½¿ç”¨æœºå™¨å­¦ä¹ ï¼‰ features: å®¢æˆ·ç‰¹å¾æ•°æ® target: ç›®æ ‡å˜é‡ \"\"\" from sklearn.model_selection import train_test_split from sklearn.ensemble import RandomForestRegressor from sklearn.metrics import r2_score, mean_squared_error # åˆ†å‰²æ•°æ® X_train, X_test, y_train, y_test = train_test_split( features, target, test_size=0.2, random_state=42 ) # è®­ç»ƒæ¨¡å‹ model = RandomForestRegressor( n_estimators=100, max_depth=10, random_state=42 ) model.fit(X_train, y_train) # é¢„æµ‹ y_pred = model.predict(X_test) # è¯„ä¼° r2 = r2_score(y_test, y_pred) rmse = np.sqrt(mean_squared_error(y_test, y_pred)) return { 'model': model, 'r2_score': round(r2, 4), 'rmse': round(rmse, 2), 'feature_importance': dict(zip( features.columns, model.feature_importances_ )) } ä¸‰ã€é¢„ç®—ä¼˜åŒ–ç­–ç•¥ 3.1 åŸºäºROIçš„é¢„ç®—åˆ†é… 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 # é¢„ç®—ä¼˜åŒ–ç®—æ³• class BudgetOptimizer: \"\"\"é¢„ç®—ä¼˜åŒ–å™¨\"\"\" def __init__(self, channel_performance): \"\"\" channel_performance: æ¸ é“è¡¨ç°æ•°æ® [{ 'channel': 'æ¸ é“å', 'spend': æŠ•å…¥, 'revenue': æ”¶å…¥, 'impressions': å±•ç¤º, 'capacity': æœ€å¤§å®¹é‡ }] \"\"\" self.data = channel_performance def optimize_by_roi(self, total_budget): \"\"\" åŸºäºROIä¼˜åŒ–é¢„ç®—åˆ†é… ç­–ç•¥: æŒ‰ROIæ¯”ä¾‹åˆ†é…é¢„ç®— \"\"\" # è®¡ç®—æ¯ä¸ªæ¸ é“çš„ROI for item in self.data: item['roi'] = ((item['revenue'] - item['spend']) / item['spend'] * 100) item['roas'] = item['revenue'] / item['spend'] # è¿‡æ»¤æ­£ROIçš„æ¸ é“ positive_roi_channels = [ch for ch in self.data if ch['roi'] \u003e 0] if not positive_roi_channels: return {'error': 'æ²¡æœ‰æ­£ROIçš„æ¸ é“'} # è®¡ç®—æ€»ROIæƒé‡ total_roi_weight = sum(ch['roi'] for ch in positive_roi_channels) # åˆ†é…é¢„ç®— allocation = [] for channel in positive_roi_channels: allocated_budget = (channel['roi'] / total_roi_weight) * total_budget # æ£€æŸ¥å®¹é‡é™åˆ¶ if 'capacity' in channel and allocated_budget \u003e channel['capacity']: allocated_budget = channel['capacity'] # é¢„ä¼°æ”¶å…¥ estimated_revenue = allocated_budget * (1 + channel['roi'] / 100) allocation.append({ 'channel': channel['channel'], 'current_spend': channel['spend'], 'current_revenue': channel['revenue'], 'current_roi': round(channel['roi'], 2), 'allocated_budget': round(allocated_budget, 2), 'estimated_revenue': round(estimated_revenue, 2) }) total_estimated_revenue = sum(item['estimated_revenue'] for item in allocation) optimized_roi = ((total_estimated_revenue - total_budget) / total_budget) * 100 return { 'allocation': allocation, 'total_budget': total_budget, 'total_estimated_revenue': round(total_estimated_revenue, 2), 'optimized_roi': round(optimized_roi, 2), 'recommendation': self._get_roi_recommendation(optimized_roi) } def optimize_by_marginal_roi(self, total_budget, increment=1000): \"\"\" åŸºäºè¾¹é™…ROIä¼˜åŒ– ç­–ç•¥: é€æ­¥åˆ†é…é¢„ç®—åˆ°è¾¹é™…ROIæœ€é«˜çš„æ¸ é“ \"\"\" remaining_budget = total_budget allocation = {channel['channel']: 0 for channel in self.data} while remaining_budget \u003e 0: best_channel = None best_marginal_roi = -float('inf') # å¯»æ‰¾è¾¹é™…ROIæœ€é«˜çš„æ¸ é“ for channel in self.data: current_spend = allocation[channel['channel']] current_revenue = channel['revenue'] * (current_spend / channel['spend']) # è®¡ç®—å¢åŠ æŠ•å…¥åçš„ROI new_spend = current_spend + increment if new_spend \u003e channel.get('capacity', float('inf')): continue new_revenue = channel['revenue'] * (new_spend / channel['spend']) marginal_revenue = new_revenue - current_revenue marginal_roi = (marginal_revenue / increment) * 100 if marginal_roi \u003e best_marginal_roi: best_marginal_roi = marginal_roi best_channel = channel['channel'] # åˆ†é…é¢„ç®— if best_channel and best_marginal_roi \u003e 0: allocation[best_channel] += increment remaining_budget -= increment else: # æ²¡æœ‰æ­£è¾¹é™…ROIçš„æ¸ é“ï¼Œåœæ­¢åˆ†é… break # è½¬æ¢ä¸ºç»“æœæ ¼å¼ allocation_list = [] total_estimated_revenue = 0 for channel in self.data: channel_name = channel['channel'] allocated = allocation[channel_name] if allocated \u003e 0: estimated_revenue = channel['revenue'] * (allocated / channel['spend']) total_estimated_revenue += estimated_revenue allocation_list.append({ 'channel': channel_name, 'allocated_budget': round(allocated, 2), 'estimated_revenue': round(estimated_revenue, 2), 'channel_roi': round(channel['roi'], 2) }) optimized_roi = ((total_estimated_revenue - total_budget) / total_budget) * 100 return { 'allocation': allocation_list, 'total_budget': total_budget, 'total_estimated_revenue': round(total_estimated_revenue, 2), 'optimized_roi': round(optimized_roi, 2) } def _get_roi_recommendation(self, roi): \"\"\"è·å–ROIä¼˜åŒ–å»ºè®®\"\"\" if roi \u003e 300: return 'ä¼˜ç§€ï¼šæ‰©å¤§æŠ•å…¥è§„æ¨¡' elif roi \u003e 200: return 'è‰¯å¥½ï¼šç»§ç»­ä¼˜åŒ–' elif roi \u003e 100: return 'ä¸€èˆ¬ï¼šéœ€è¦æ”¹è¿›' else: return 'å·®ï¼šé‡æ–°è¯„ä¼°ç­–ç•¥' 3.2 å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ– 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 # å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ– from scipy.optimize import minimize import numpy as np class MultiObjectiveBudgetOptimizer: \"\"\"å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–å™¨\"\"\" def __init__(self, channels_data): \"\"\" channels_data: æ¸ é“æ•°æ® [{ 'name': 'æ¸ é“å', 'min_spend': æœ€å°æŠ•å…¥, 'max_spend': æœ€å¤§å®¹é‡, 'conversion_rate': è½¬åŒ–ç‡, 'avg_order_value': å¹³å‡å®¢å•ä»· }] \"\"\" self.channels = channels_data def optimize(self, total_budget, objectives): \"\"\" å¤šç›®æ ‡ä¼˜åŒ– objectives: { 'maximize_revenue': æƒé‡, 'maximize_conversions': æƒé‡, 'minimize_cost': æƒé‡ } \"\"\" n_channels = len(self.channels) # å†³ç­–å˜é‡ï¼šæ¯ä¸ªæ¸ é“çš„é¢„ç®— x0 = np.array([total_budget / n_channels] * n_channels) # çº¦æŸæ¡ä»¶ constraints = [ # é¢„ç®—æ€»å’Œçº¦æŸ {'type': 'eq', 'fun': lambda x: np.sum(x) - total_budget} ] # æ¯ä¸ªæ¸ é“çš„é¢„ç®—èŒƒå›´ bounds = [] for channel in self.channels: bounds.append((channel['min_spend'], channel['max_spend'])) # ç›®æ ‡å‡½æ•° def objective_function(x): total_revenue = 0 total_conversions = 0 for i, channel in enumerate(self.channels): spend = x[i] # ä¼°ç®—æ”¶å…¥ï¼ˆåŸºäºå†å²æ•°æ®çš„ç®€åŒ–æ¨¡å‹ï¼‰ estimated_conversions = spend * channel['conversion_rate'] estimated_revenue = estimated_conversions * channel['avg_order_value'] total_conversions += estimated_conversions total_revenue += estimated_revenue # å¤šç›®æ ‡åŠ æƒå’Œï¼ˆè½¬æ¢ä¸ºæœ€å°åŒ–é—®é¢˜ï¼‰ weighted_score = ( -objectives.get('maximize_revenue', 1) * total_revenue + -objectives.get('maximize_conversions', 1) * total_conversions + objectives.get('minimize_cost', 0) * total_budget ) return weighted_score # ä¼˜åŒ– result = minimize( objective_function, x0, method='SLSQP', bounds=bounds, constraints=constraints ) # è§£æç»“æœ if result.success: allocation = [] total_revenue = 0 total_conversions = 0 for i, channel in enumerate(self.channels): spend = result.x[i] conversions = spend * channel['conversion_rate'] revenue = conversions * channel['avg_order_value'] total_conversions += conversions total_revenue += revenue allocation.append({ 'channel': channel['name'], 'allocated_budget': round(spend, 2), 'estimated_conversions': round(conversions), 'estimated_revenue': round(revenue, 2) }) roi = ((total_revenue - total_budget) / total_budget) * 100 cpa = total_budget / total_conversions if total_conversions \u003e 0 else 0 return { 'success': True, 'allocation': allocation, 'total_budget': total_budget, 'estimated_revenue': round(total_revenue, 2), 'estimated_conversions': round(total_conversions), 'estimated_roi': round(roi, 2), 'estimated_cpa': round(cpa, 2) } else: return { 'success': False, 'error': result.message } å››ã€è¥é”€æ•ˆæœé¢„æµ‹ 4.1 æ—¶é—´åºåˆ—é¢„æµ‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 # è¥é”€æ•ˆæœé¢„æµ‹ import pandas as pd from sklearn.linear_model import LinearRegression from sklearn.metrics import mean_absolute_error, mean_squared_error class MarketingEffectPredictor: \"\"\"è¥é”€æ•ˆæœé¢„æµ‹å™¨\"\"\" def __init__(self, historical_data): \"\"\" historical_data: å†å²è¥é”€æ•°æ® { 'date': æ—¥æœŸ, 'channel': æ¸ é“, 'spend': æŠ•å…¥, 'impressions': å±•ç¤º, 'clicks': ç‚¹å‡», 'conversions': è½¬åŒ–, 'revenue': æ”¶å…¥ } \"\"\" self.data = historical_data def predict_performance(self, channel, future_spend, periods=4): \"\"\" é¢„æµ‹æœªæ¥è¡¨ç° channel: æ¸ é“åç§° future_spend: é¢„æœŸæŠ•å…¥ periods: é¢„æµ‹å‘¨æœŸæ•° \"\"\" # è¿‡æ»¤è¯¥æ¸ é“çš„å†å²æ•°æ® channel_data = self.data[self.data['channel'] == channel].copy() # å‡†å¤‡ç‰¹å¾ channel_data['period'] = range(len(channel_data)) # ç®€å•çº¿æ€§å›å½’é¢„æµ‹ X = channel_data[['period', 'spend']].values y_revenue = channel_data['revenue'].values y_conversions = channel_data['conversions'].values # è®­ç»ƒæ”¶å…¥é¢„æµ‹æ¨¡å‹ revenue_model = LinearRegression() revenue_model.fit(X, y_revenue) # è®­ç»ƒè½¬åŒ–é¢„æµ‹æ¨¡å‹ conversions_model = LinearRegression() conversions_model.fit(X, y_conversions) # é¢„æµ‹æœªæ¥ future_periods = len(channel_data) + np.arange(periods) future_X = np.column_stack([future_periods, [future_spend] * periods]) predicted_revenue = revenue_model.predict(future_X) predicted_conversions = conversions_model.predict(future_X) # è®¡ç®—é¢„æµ‹æŒ‡æ ‡ predictions = [] for i in range(periods): predictions.append({ 'period': i + 1, 'spend': future_spend, 'predicted_revenue': round(predicted_revenue[i], 2), 'predicted_conversions': round(predicted_conversions[i]), 'predicted_roi': round(((predicted_revenue[i] - future_spend) / future_spend) * 100, 2), 'predicted_cpa': round(future_spend / predicted_conversions[i], 2) if predicted_conversions[i] \u003e 0 else 0 }) # æ¨¡å‹è¯„ä¼° y_revenue_pred = revenue_model.predict(X) y_conversions_pred = conversions_model.predict(X) model_metrics = { 'revenue_mae': mean_absolute_error(y_revenue, y_revenue_pred), 'revenue_rmse': np.sqrt(mean_squared_error(y_revenue, y_revenue_pred)), 'conversions_mae': mean_absolute_error(y_conversions, y_conversions_pred), 'conversions_rmse': np.sqrt(mean_squared_error(y_conversions, y_conversions_pred)) } return { 'channel': channel, 'predictions': predictions, 'model_metrics': {k: round(v, 2) for k, v in model_metrics.items()}, 'confidence': self._assess_confidence(model_metrics) } def _assess_confidence(self, metrics): \"\"\"è¯„ä¼°é¢„æµ‹ç½®ä¿¡åº¦\"\"\" if metrics['revenue_mae'] \u003c 1000 and metrics['conversions_mae'] \u003c 10: return 'High' elif metrics['revenue_mae'] \u003c 5000 and metrics['conversions_mae'] \u003c 50: return 'Medium' else: return 'Low' äº”ã€è¥é”€ä»ªè¡¨ç›˜è®¾è®¡ 5.1 æ ¸å¿ƒæŒ‡æ ‡ç›‘æ§ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 è¥é”€åˆ†æä»ªè¡¨ç›˜æŒ‡æ ‡: ç¬¬ä¸€å±‚ - æ‰§è¡ŒæŒ‡æ ‡: å®æ—¶ç›‘æ§: - ä»Šæ—¥èŠ±è´¹ - ä»Šæ—¥å±•ç¤ºæ¬¡æ•° - ä»Šæ—¥ç‚¹å‡»æ¬¡æ•° - ä»Šæ—¥è½¬åŒ–æ¬¡æ•° - å®æ—¶CTR/CVR æ“ä½œé¢„è­¦: - é¢„ç®—ä½¿ç”¨ç‡ - å¼‚å¸¸æµé‡ - è½¬åŒ–ç‡ä¸‹é™ - CPAä¸Šå‡ ç¬¬äºŒå±‚ - æ•ˆæœæŒ‡æ ‡: æ¸ é“è¡¨ç°: - å„æ¸ é“ROI - å„æ¸ é“ROAS - å„æ¸ é“CPA - å„æ¸ é“è½¬åŒ–ç‡ è¶‹åŠ¿åˆ†æ: - å‘¨ç¯æ¯”å˜åŒ– - æœˆç¯æ¯”å˜åŒ– - åŒæ¯”å˜åŒ– - ç§»åŠ¨å¹³å‡ ç¬¬ä¸‰å±‚ - ä¸šåŠ¡æŒ‡æ ‡: è·å®¢æŒ‡æ ‡: - æ–°å¢ç”¨æˆ·æ•° - CAC - LTV - LTV/CACæ¯”ç‡ æ”¶å…¥æŒ‡æ ‡: - è¥é”€å¸¦æ¥æ”¶å…¥ - è¥é”€ROI - è¾¹é™…ROI - ç›ˆäºå¹³è¡¡ç‚¹ ç¬¬å››å±‚ - é¢„æµ‹æŒ‡æ ‡: é¢„æµ‹æ•°æ®: - é¢„æµ‹æœ¬æœˆæ”¶å…¥ - é¢„æµ‹LTV - é¢„æµ‹è½¬åŒ–ç‡ - é¢„æµ‹ç½®ä¿¡åº¦ ä¼˜åŒ–å»ºè®®: - é¢„ç®—è°ƒæ•´å»ºè®® - æ¸ é“ä¼˜åŒ–å»ºè®® - åˆ›æ„ä¼˜åŒ–å»ºè®® - å‡ºä»·ä¼˜åŒ–å»ºè®® æ€»ç»“ è¥é”€å½’å› å’ŒROIåˆ†ææ˜¯æ•°æ®é©±åŠ¨è¥é”€çš„æ ¸å¿ƒï¼š\né€‰æ‹©åˆé€‚çš„å½’å› æ¨¡å‹ - æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹© å»ºç«‹å®Œå–„çš„è¿½è¸ªä½“ç³» - ç¡®ä¿æ•°æ®å‡†ç¡®æ€§ ç»¼åˆè¯„ä¼°è¥é”€æ•ˆæœ - ä¸ä»…çœ‹ROIï¼Œè¿˜è¦çœ‹é•¿æœŸä»·å€¼ æŒç»­ä¼˜åŒ–é¢„ç®—åˆ†é… - åŸºäºæ•°æ®åŠ¨æ€è°ƒæ•´ å»ºç«‹é¢„æµ‹èƒ½åŠ› - ä»å†å²åˆ°æœªæ¥çš„æ´å¯Ÿ è®°ä½ï¼Œè¥é”€åˆ†æçš„ç›®æ ‡ä¸æ˜¯ç²¾ç¡®åˆ°å°æ•°ç‚¹ï¼Œè€Œæ˜¯ä¸ºå†³ç­–æä¾›å¯é ä¾æ®ã€‚åœ¨æ•°æ®åˆ†æçš„åŸºç¡€ä¸Šï¼Œç»“åˆä¸šåŠ¡æ´å¯Ÿï¼Œæ‰èƒ½åšå‡ºæœ€ä½³çš„è¥é”€å†³ç­–ã€‚\nå®ç”¨å·¥å…·\nç™¾åˆ†æ¯”è®¡ç®—å™¨ - ROIå’Œè½¬åŒ–ç‡è®¡ç®— ROIè®¡ç®—å™¨ - æŠ•èµ„å›æŠ¥åˆ†æ æŠ•èµ„è®¡ç®—å™¨ - å¤åˆå¢é•¿åˆ†æ ","wordCount":"2969","inLanguage":"zh-cn","datePublished":"2025-12-23T18:00:00+08:00","dateModified":"2025-12-23T18:00:00+08:00","author":{"@type":"Person","name":"æœ‰æ¡å·¥å…·å›¢é˜Ÿ"},"mainEntityOfPage":{"@type":"WebPage","@id":"/blog/articles/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0%E4%B8%8Eroi%E5%88%86%E6%9E%90%E7%A7%91%E5%AD%A6%E8%A1%A1%E9%87%8F%E6%AF%8F%E4%B8%80%E5%88%86%E8%90%A5%E9%94%80%E6%8A%95%E5%85%A5/"},"publisher":{"@type":"Organization","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·","logo":{"@type":"ImageObject","url":"/favicon.ico"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><article class=post-single><div class=post-content-wrapper><main class=post-content-main><header class=post-header-main><h1 class="post-title entry-hint-parent">è¥é”€å½’å› ä¸ROIåˆ†æï¼šç§‘å­¦è¡¡é‡æ¯ä¸€åˆ†è¥é”€æŠ•å…¥</h1><div class=post-description>å…¨é¢è§£æè¥é”€å½’å› æ¨¡å‹å’ŒROIåˆ†ææ–¹æ³•ï¼Œä»å¤šè§¦ç‚¹å½’å› ã€LTVè®¡ç®—åˆ°é¢„ç®—ä¼˜åŒ–ï¼Œå¸®åŠ©ä¼ä¸šç§‘å­¦è¯„ä¼°è¥é”€æ•ˆæœï¼Œä¼˜åŒ–æŠ•å…¥äº§å‡ºæ¯”ã€‚</div><div class=post-meta><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E8%90%A5%E9%94%80%E5%88%86%E6%9E%90/ class=category-link>è¥é”€åˆ†æ</a><a href=/blog/categories/roi%E5%88%86%E6%9E%90/ class=category-link>ROIåˆ†æ</a></div><span class=post-date>2025-12-23</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></div></header><div class=post-content><h2 id=å¼•è¨€>å¼•è¨€<a hidden class=anchor aria-hidden=true href=#å¼•è¨€>#</a></h2><p>åœ¨æ•°å­—åŒ–è¥é”€æ—¶ä»£ï¼Œä¼ä¸šåœ¨å„ä¸ªæ¸ é“æŠ•å…¥å¤§é‡é¢„ç®—ï¼Œä½†å¦‚ä½•å‡†ç¡®è¡¡é‡æ¯ä¸ªæ¸ é“çš„è´¡çŒ®ï¼Ÿå¦‚ä½•ç§‘å­¦åœ°è¯„ä¼°è¥é”€ROIï¼Ÿæœ¬æ–‡å°†ç³»ç»Ÿè®²è§£è¥é”€å½’å› å’ŒROIåˆ†æçš„æ–¹æ³•è®ºã€‚</p><h2 id=ä¸€è¥é”€å½’å› æ¨¡å‹>ä¸€ã€è¥é”€å½’å› æ¨¡å‹<a hidden class=anchor aria-hidden=true href=#ä¸€è¥é”€å½’å› æ¨¡å‹>#</a></h2><h3 id=11-å½’å› æ¨¡å‹ç±»å‹>1.1 å½’å› æ¨¡å‹ç±»å‹<a hidden class=anchor aria-hidden=true href=#11-å½’å› æ¨¡å‹ç±»å‹>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>è¥é”€å½’å› æ¨¡å‹</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>å•è§¦ç‚¹å½’å› </span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æœ€åç‚¹å‡» (Last Click)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>è½¬åŒ–å‰æœ€åä¸€æ¬¡è§¦ç‚¹è·å¾—100%åŠŸåŠ³</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ç®€å•æ˜“ç†è§£</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¿½ç•¥å…¶ä»–è§¦ç‚¹è´¡çŒ®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>çŸ­å†³ç­–å‘¨æœŸã€å•ä¸€æ¸ é“</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>é¦–æ¬¡ç‚¹å‡» (First Click)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ç¬¬ä¸€æ¬¡è§¦ç‚¹è·å¾—100%åŠŸåŠ³</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é‡è§†è·å®¢æ¸ é“</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¿½ç•¥åç»­åŸ¹è‚²</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å“ç‰Œè®¤çŸ¥ã€çº¿ç´¢è·å–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æœ«æ¬¡ç‚¹å‡» (Last Non-Direct Click)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æ’é™¤ç›´æ¥è®¿é—®çš„æœ€åç‚¹å‡»è·100%åŠŸåŠ³</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æ›´å‡†ç¡®åæ˜ æ¸ é“ä»·å€¼</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ä»ç„¶ç®€å•åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¤šæ¸ é“è¥é”€</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>å¤šè§¦ç‚¹å½’å› </span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>çº¿æ€§å½’å›  (Linear)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æ‰€æœ‰è§¦ç‚¹å¹³å‡åˆ†é…åŠŸåŠ³</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>å…¬å¼</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>100</span><span style=color:#a5d6ff>% / N (æ¯ä¸ªè§¦ç‚¹)</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>è€ƒè™‘æ‰€æœ‰è§¦ç‚¹</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¿½ç•¥å¾®å¦™å·®å¼‚</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é•¿å†³ç­–å‘¨æœŸ</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æ—¶é—´è¡°å‡ (Time Decay)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>è¶Šæ¥è¿‘è½¬åŒ–çš„è§¦ç‚¹æƒé‡è¶Šé«˜</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>å…¬å¼</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æŒ‡æ•°è¡°å‡å‡½æ•°</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>åæ˜ æ—¶é—´å½±å“</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¯èƒ½å¿½ç•¥æ—©æœŸè§¦ç‚¹</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>è¾ƒé•¿å†³ç­–å‘¨æœŸ</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>ä½ç½®å½’å›  (Position Based)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é¦–å°¾è§¦ç‚¹40%+40%ï¼Œä¸­é—´20%</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>å…¬å¼</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é¦–40% + ä¸­é—´å¹³åˆ†20% + å°¾40%</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é‡è§†è·å®¢å’Œè½¬åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å›ºå®šæ¯”ä¾‹å¯èƒ½ä¸é€‚ç”¨</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å“ç‰Œä¸è½¬åŒ–å¹¶é‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>Uå‹å½’å›  (U-Shaped)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>åŒä½ç½®å½’å› ï¼ˆé¦–å°¾å„40%ï¼‰</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>é‡è§†é¦–æ¬¡äº’åŠ¨å’Œæœ€ç»ˆè½¬åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>ç®—æ³•å½’å› </span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æ•°æ®é©±åŠ¨ (Data-Driven)</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>åŸºäºå†å²æ•°æ®è®¡ç®—æƒé‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æ–¹æ³•</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æœºå™¨å­¦ä¹ ç®—æ³•</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>æœ€å‡†ç¡®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>éœ€è¦å¤§é‡æ•°æ®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>å¤§å‹ä¼ä¸šã€æˆç†Ÿæ•°æ®ä½“ç³»</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>Shapleyå€¼</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æè¿°</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>åšå¼ˆè®ºæ–¹æ³•è®¡ç®—è¾¹é™…è´¡çŒ®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>æ–¹æ³•</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>Shapley Valueç®—æ³•</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>ä¼˜åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ç†è®ºä¸Šæœ€å…¬å¹³</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>åŠ£åŠ¿</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>è®¡ç®—å¤æ‚</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span><span style=color:#7ee787>é€‚ç”¨</span>:<span style=color:#6e7681> </span><span style=color:#a5d6ff>ç²¾ç¡®åˆ†æéœ€æ±‚</span><span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=12-å½’å› æ¨¡å‹å®ç°>1.2 å½’å› æ¨¡å‹å®ç°<a hidden class=anchor aria-hidden=true href=#12-å½’å› æ¨¡å‹å®ç°>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">149
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">150
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">151
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">152
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">153
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">154
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">155
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">156
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">157
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">158
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">159
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">160
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">161
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">162
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">163
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">164
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">165
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># è¥é”€å½’å› æ¨¡å‹å®ç°</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>pandas</span> <span style=color:#ff7b72>as</span> <span style=color:#ff7b72>pd</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>numpy</span> <span style=color:#ff7b72>as</span> <span style=color:#ff7b72>np</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>typing</span> <span style=color:#ff7b72>import</span> List, Dict
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>MarketingAttribution</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;è¥é”€å½’å› åˆ†æ&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self, touchpoint_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        touchpoint_data: è§¦ç‚¹æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        [{
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;user_id&#39;: &#39;user_001&#39;,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;journey&#39;: [&#39;organic&#39;, &#39;social&#39;, &#39;email&#39;, &#39;direct&#39;],
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;conversion&#39;: 1,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;value&#39;: 99
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>data <span style=color:#ff7b72;font-weight:700>=</span> touchpoint_data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>last_click_attribution</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;æœ€åç‚¹å‡»å½’å› &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        attribution_results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> journey_data <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            journey <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;journey&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> len(journey) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>and</span> journey_data[<span style=color:#a5d6ff>&#39;conversion&#39;</span>]:
</span></span><span style=display:flex><span>                last_touch <span style=color:#ff7b72;font-weight:700>=</span> journey[<span style=color:#ff7b72;font-weight:700>-</span><span style=color:#a5d6ff>1</span>]
</span></span><span style=display:flex><span>                attribution_results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;user_id&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;user_id&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>: last_touch,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;value&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;value&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;model&#39;</span>: <span style=color:#a5d6ff>&#39;last_click&#39;</span>
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(attribution_results)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> df<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>)[<span style=color:#a5d6ff>&#39;value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>to_dict()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>first_click_attribution</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;é¦–æ¬¡ç‚¹å‡»å½’å› &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        attribution_results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> journey_data <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            journey <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;journey&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> len(journey) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>and</span> journey_data[<span style=color:#a5d6ff>&#39;conversion&#39;</span>]:
</span></span><span style=display:flex><span>                first_touch <span style=color:#ff7b72;font-weight:700>=</span> journey[<span style=color:#a5d6ff>0</span>]
</span></span><span style=display:flex><span>                attribution_results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;user_id&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;user_id&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>: first_touch,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;value&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;value&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;model&#39;</span>: <span style=color:#a5d6ff>&#39;first_click&#39;</span>
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(attribution_results)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> df<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>)[<span style=color:#a5d6ff>&#39;value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>to_dict()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>linear_attribution</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;çº¿æ€§å½’å› &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        attribution_results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> journey_data <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            journey <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;journey&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> len(journey) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>and</span> journey_data[<span style=color:#a5d6ff>&#39;conversion&#39;</span>]:
</span></span><span style=display:flex><span>                value_per_touch <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;value&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> len(journey)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>for</span> touch <span style=color:#ff7b72;font-weight:700>in</span> journey:
</span></span><span style=display:flex><span>                    attribution_results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;user_id&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;user_id&#39;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>: touch,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;value&#39;</span>: value_per_touch,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;model&#39;</span>: <span style=color:#a5d6ff>&#39;linear&#39;</span>
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(attribution_results)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> df<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>)[<span style=color:#a5d6ff>&#39;value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>to_dict()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>time_decay_attribution</span>(self, decay_rate<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>0.5</span>):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        æ—¶é—´è¡°å‡å½’å› 
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        decay_rate: è¡°å‡ç‡
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        attribution_results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> journey_data <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            journey <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;journey&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> len(journey) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>and</span> journey_data[<span style=color:#a5d6ff>&#39;conversion&#39;</span>]:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># è®¡ç®—æƒé‡ï¼ˆæœ€è¿‘è§¦ç‚¹æƒé‡æœ€é«˜ï¼‰</span>
</span></span><span style=display:flex><span>                positions <span style=color:#ff7b72;font-weight:700>=</span> list(range(len(journey)))
</span></span><span style=display:flex><span>                weights <span style=color:#ff7b72;font-weight:700>=</span> [decay_rate <span style=color:#ff7b72;font-weight:700>**</span> (len(journey) <span style=color:#ff7b72;font-weight:700>-</span> <span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>-</span> pos) <span style=color:#ff7b72>for</span> pos <span style=color:#ff7b72;font-weight:700>in</span> positions]
</span></span><span style=display:flex><span>                total_weight <span style=color:#ff7b72;font-weight:700>=</span> sum(weights)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># å½’ä¸€åŒ–æƒé‡</span>
</span></span><span style=display:flex><span>                normalized_weights <span style=color:#ff7b72;font-weight:700>=</span> [w <span style=color:#ff7b72;font-weight:700>/</span> total_weight <span style=color:#ff7b72>for</span> w <span style=color:#ff7b72;font-weight:700>in</span> weights]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># åˆ†é…ä»·å€¼</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>for</span> i, touch <span style=color:#ff7b72;font-weight:700>in</span> enumerate(journey):
</span></span><span style=display:flex><span>                    attributed_value <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;value&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> normalized_weights[i]
</span></span><span style=display:flex><span>                    attribution_results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;user_id&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;user_id&#39;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>: touch,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;value&#39;</span>: attributed_value,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;model&#39;</span>: <span style=color:#a5d6ff>&#39;time_decay&#39;</span>
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(attribution_results)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> df<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>)[<span style=color:#a5d6ff>&#39;value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>to_dict()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>position_based_attribution</span>(self, first_last_weight<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>0.4</span>):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ä½ç½®å½’å› 
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        first_last_weight: é¦–å°¾è§¦ç‚¹æƒé‡ï¼ˆé»˜è®¤40%ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        attribution_results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> journey_data <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            journey <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;journey&#39;</span>]
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> len(journey) <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72;font-weight:700>and</span> journey_data[<span style=color:#a5d6ff>&#39;conversion&#39;</span>]:
</span></span><span style=display:flex><span>                journey_len <span style=color:#ff7b72;font-weight:700>=</span> len(journey)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> journey_len <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>1</span>:
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># åªæœ‰ä¸€ä¸ªè§¦ç‚¹ï¼Œè·å¾—100%</span>
</span></span><span style=display:flex><span>                    weights <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#a5d6ff>1.0</span>]
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>elif</span> journey_len <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>2</span>:
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># ä¸¤ä¸ªè§¦ç‚¹ï¼Œå„50%</span>
</span></span><span style=display:flex><span>                    weights <span style=color:#ff7b72;font-weight:700>=</span> [<span style=color:#a5d6ff>0.5</span>, <span style=color:#a5d6ff>0.5</span>]
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>                    <span style=color:#8b949e;font-style:italic># é¦–å°¾å„40%ï¼Œä¸­é—´å¹³åˆ†20%</span>
</span></span><span style=display:flex><span>                    middle_weight <span style=color:#ff7b72;font-weight:700>=</span> (<span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>-</span> <span style=color:#a5d6ff>2</span> <span style=color:#ff7b72;font-weight:700>*</span> first_last_weight) <span style=color:#ff7b72;font-weight:700>/</span> (journey_len <span style=color:#ff7b72;font-weight:700>-</span> <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>                    weights <span style=color:#ff7b72;font-weight:700>=</span> [first_last_weight] <span style=color:#ff7b72;font-weight:700>+</span> \
</span></span><span style=display:flex><span>                             [middle_weight] <span style=color:#ff7b72;font-weight:700>*</span> (journey_len <span style=color:#ff7b72;font-weight:700>-</span> <span style=color:#a5d6ff>2</span>) <span style=color:#ff7b72;font-weight:700>+</span> \
</span></span><span style=display:flex><span>                             [first_last_weight]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># åˆ†é…ä»·å€¼</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>for</span> i, touch <span style=color:#ff7b72;font-weight:700>in</span> enumerate(journey):
</span></span><span style=display:flex><span>                    attributed_value <span style=color:#ff7b72;font-weight:700>=</span> journey_data[<span style=color:#a5d6ff>&#39;value&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> weights[i]
</span></span><span style=display:flex><span>                    attribution_results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;user_id&#39;</span>: journey_data[<span style=color:#a5d6ff>&#39;user_id&#39;</span>],
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>: touch,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;value&#39;</span>: attributed_value,
</span></span><span style=display:flex><span>                        <span style=color:#a5d6ff>&#39;model&#39;</span>: <span style=color:#a5d6ff>&#39;position_based&#39;</span>
</span></span><span style=display:flex><span>                    })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(attribution_results)
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> df<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;attributed_channel&#39;</span>)[<span style=color:#a5d6ff>&#39;value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>to_dict()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>compare_models</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;å¯¹æ¯”ä¸åŒå½’å› æ¨¡å‹&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        results <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;last_click&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>last_click_attribution(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;first_click&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>first_click_attribution(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;linear&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>linear_attribution(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;time_decay&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>time_decay_attribution(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;position_based&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>position_based_attribution()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è½¬æ¢ä¸ºDataFrameæ–¹ä¾¿æ¯”è¾ƒ</span>
</span></span><span style=display:flex><span>        comparison_df <span style=color:#ff7b72;font-weight:700>=</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(results)<span style=color:#ff7b72;font-weight:700>.</span>fillna(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> comparison_df
</span></span></code></pre></td></tr></table></div></div><h2 id=äºŒroiè®¡ç®—æ–¹æ³•>äºŒã€ROIè®¡ç®—æ–¹æ³•<a hidden class=anchor aria-hidden=true href=#äºŒroiè®¡ç®—æ–¹æ³•>#</a></h2><h3 id=21-åŸºç¡€roiè®¡ç®—>2.1 åŸºç¡€ROIè®¡ç®—<a hidden class=anchor aria-hidden=true href=#21-åŸºç¡€roiè®¡ç®—>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># ROIè®¡ç®—å·¥å…·</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>ROICalculator</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;ROIè®¡ç®—å™¨&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@staticmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_basic_roi</span>(revenue, cost):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—åŸºç¡€ROI
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        revenue: æ”¶å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        cost: æˆæœ¬
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> cost <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        roi <span style=color:#ff7b72;font-weight:700>=</span> ((revenue <span style=color:#ff7b72;font-weight:700>-</span> cost) <span style=color:#ff7b72;font-weight:700>/</span> cost) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(roi, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@staticmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_roas</span>(revenue, ad_spend):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—ROAS (Return on Ad Spend)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        revenue: æ”¶å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ad_spend: å¹¿å‘ŠèŠ±è´¹
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> ad_spend <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        roas <span style=color:#ff7b72;font-weight:700>=</span> revenue <span style=color:#ff7b72;font-weight:700>/</span> ad_spend
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(roas, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@staticmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_break_even_roas</span>(profit_margin):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—ç›ˆäºå¹³è¡¡ROAS
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        profit_margin: åˆ©æ¶¦ç‡ (0-1)
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> profit_margin <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        break_even_roas <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>/</span> profit_margin
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(break_even_roas, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@staticmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_ltv_cac_ratio</span>(ltv, cac):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—LTV/CACæ¯”ç‡
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ltv: ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        cac: è·å®¢æˆæœ¬
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> cac <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        ratio <span style=color:#ff7b72;font-weight:700>=</span> ltv <span style=color:#ff7b72;font-weight:700>/</span> cac
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(ratio, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#d2a8ff;font-weight:700>@staticmethod</span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_payback_period</span>(cac, monthly_arpu):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—å›æœ¬å‘¨æœŸ
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        cac: è·å®¢æˆæœ¬
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        monthly_arpu: æœˆå‡æ¯ç”¨æˆ·æ”¶å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> monthly_arpu <span style=color:#ff7b72;font-weight:700>==</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        payback_months <span style=color:#ff7b72;font-weight:700>=</span> cac <span style=color:#ff7b72;font-weight:700>/</span> monthly_arpu
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(payback_months, <span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_channel_roi</span>(self, channel_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—å„æ¸ é“ROI
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        channel_data: {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;channel_name&#39;: {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                &#39;spend&#39;: å¹¿å‘ŠèŠ±è´¹,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                &#39;impressions&#39;: å±•ç¤ºæ¬¡æ•°,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                &#39;clicks&#39;: ç‚¹å‡»æ¬¡æ•°,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                &#39;conversions&#39;: è½¬åŒ–æ¬¡æ•°,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>                &#39;revenue&#39;: æ”¶å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        results <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> channel, data <span style=color:#ff7b72;font-weight:700>in</span> channel_data<span style=color:#ff7b72;font-weight:700>.</span>items():
</span></span><span style=display:flex><span>            spend <span style=color:#ff7b72;font-weight:700>=</span> data[<span style=color:#a5d6ff>&#39;spend&#39;</span>]
</span></span><span style=display:flex><span>            revenue <span style=color:#ff7b72;font-weight:700>=</span> data[<span style=color:#a5d6ff>&#39;revenue&#39;</span>]
</span></span><span style=display:flex><span>            clicks <span style=color:#ff7b72;font-weight:700>=</span> data[<span style=color:#a5d6ff>&#39;clicks&#39;</span>]
</span></span><span style=display:flex><span>            conversions <span style=color:#ff7b72;font-weight:700>=</span> data[<span style=color:#a5d6ff>&#39;conversions&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># åŸºç¡€æŒ‡æ ‡</span>
</span></span><span style=display:flex><span>            roi <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>calculate_basic_roi(revenue, spend)
</span></span><span style=display:flex><span>            roas <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>calculate_roas(revenue, spend)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># è¡ç”ŸæŒ‡æ ‡</span>
</span></span><span style=display:flex><span>            cpc <span style=color:#ff7b72;font-weight:700>=</span> spend <span style=color:#ff7b72;font-weight:700>/</span> clicks <span style=color:#ff7b72>if</span> clicks <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            cpa <span style=color:#ff7b72;font-weight:700>=</span> spend <span style=color:#ff7b72;font-weight:700>/</span> conversions <span style=color:#ff7b72>if</span> conversions <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            ctr <span style=color:#ff7b72;font-weight:700>=</span> (clicks <span style=color:#ff7b72;font-weight:700>/</span> data[<span style=color:#a5d6ff>&#39;impressions&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>) <span style=color:#ff7b72>if</span> data[<span style=color:#a5d6ff>&#39;impressions&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            cvr <span style=color:#ff7b72;font-weight:700>=</span> (conversions <span style=color:#ff7b72;font-weight:700>/</span> clicks <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>) <span style=color:#ff7b72>if</span> clicks <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            results<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;channel&#39;</span>: channel,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;spend&#39;</span>: round(spend, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;revenue&#39;</span>: round(revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;profit&#39;</span>: round(revenue <span style=color:#ff7b72;font-weight:700>-</span> spend, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;roi&#39;</span>: <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>{</span>roi<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;roas&#39;</span>: <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>{</span>roas<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>x&#34;</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;cpc&#39;</span>: round(cpc, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;cpa&#39;</span>: round(cpa, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;ctr&#39;</span>: round(ctr, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;cvr&#39;</span>: round(cvr, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> pd<span style=color:#ff7b72;font-weight:700>.</span>DataFrame(results)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_marketing_mix_roi</span>(self, marketing_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        è®¡ç®—è¥é”€ç»„åˆROI
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        marketing_data: {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;channels&#39;: æ¸ é“æ•°æ®,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;total_revenue&#39;: æ€»æ”¶å…¥,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;baseline_revenue&#39;: åŸºçº¿æ”¶å…¥ï¼ˆæ— è¥é”€æŠ•å…¥ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        total_spend <span style=color:#ff7b72;font-weight:700>=</span> sum(ch[<span style=color:#a5d6ff>&#39;spend&#39;</span>] <span style=color:#ff7b72>for</span> ch <span style=color:#ff7b72;font-weight:700>in</span> marketing_data[<span style=color:#a5d6ff>&#39;channels&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>values())
</span></span><span style=display:flex><span>        incremental_revenue <span style=color:#ff7b72;font-weight:700>=</span> marketing_data[<span style=color:#a5d6ff>&#39;total_revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>-</span> marketing_data[<span style=color:#a5d6ff>&#39;baseline_revenue&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        marketing_roi <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>calculate_basic_roi(incremental_revenue, total_spend)
</span></span><span style=display:flex><span>        marketing_roas <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>calculate_roas(incremental_revenue, total_spend)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_spend&#39;</span>: round(total_spend, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_revenue&#39;</span>: round(marketing_data[<span style=color:#a5d6ff>&#39;total_revenue&#39;</span>], <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;baseline_revenue&#39;</span>: round(marketing_data[<span style=color:#a5d6ff>&#39;baseline_revenue&#39;</span>], <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;incremental_revenue&#39;</span>: round(incremental_revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;marketing_roi&#39;</span>: <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>{</span>marketing_roi<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>%&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;marketing_roas&#39;</span>: <span style=color:#79c0ff>f</span><span style=color:#a5d6ff>&#34;</span><span style=color:#a5d6ff>{</span>marketing_roas<span style=color:#a5d6ff>}</span><span style=color:#a5d6ff>x&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span></code></pre></td></tr></table></div></div><h3 id=22-å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼>2.2 å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼<a hidden class=anchor aria-hidden=true href=#22-å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># LTVè®¡ç®—æ¨¡å‹</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>LifetimeValueCalculator</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;å®¢æˆ·ç”Ÿå‘½å‘¨æœŸä»·å€¼è®¡ç®—å™¨&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self, customer_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        customer_data: å®¢æˆ·æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        å¿…éœ€åˆ—: customer_id, purchase_date, revenue
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>data <span style=color:#ff7b72;font-weight:700>=</span> customer_data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_simple_ltv</span>(self, avg_purchase_value, purchase_frequency, lifespan):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ç®€å•LTVè®¡ç®—
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        avg_purchase_value: å¹³å‡è´­ä¹°é‡‘é¢
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        purchase_frequency: è´­ä¹°é¢‘ç‡ï¼ˆæ¬¡/å¹´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        lifespan: å®¢æˆ·ç”Ÿå‘½å‘¨æœŸï¼ˆå¹´ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        ltv <span style=color:#ff7b72;font-weight:700>=</span> avg_purchase_value <span style=color:#ff7b72;font-weight:700>*</span> purchase_frequency <span style=color:#ff7b72;font-weight:700>*</span> lifespan
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> round(ltv, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_advanced_ltv</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        é«˜çº§LTVè®¡ç®—ï¼ˆåŸºäºå†å²æ•°æ®ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—æ¯ä¸ªå®¢æˆ·çš„æŒ‡æ ‡</span>
</span></span><span style=display:flex><span>        customer_metrics <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>data<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;customer_id&#39;</span>)<span style=color:#ff7b72;font-weight:700>.</span>agg({
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;revenue&#39;</span>: [<span style=color:#a5d6ff>&#39;sum&#39;</span>, <span style=color:#a5d6ff>&#39;mean&#39;</span>, <span style=color:#a5d6ff>&#39;count&#39;</span>],
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;purchase_date&#39;</span>: [<span style=color:#a5d6ff>&#39;min&#39;</span>, <span style=color:#a5d6ff>&#39;max&#39;</span>]
</span></span><span style=display:flex><span>        })<span style=color:#ff7b72;font-weight:700>.</span>reset_index()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        customer_metrics<span style=color:#ff7b72;font-weight:700>.</span>columns <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;customer_id&#39;</span>, <span style=color:#a5d6ff>&#39;total_revenue&#39;</span>, <span style=color:#a5d6ff>&#39;avg_purchase_value&#39;</span>,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;purchase_count&#39;</span>, <span style=color:#a5d6ff>&#39;first_purchase&#39;</span>, <span style=color:#a5d6ff>&#39;last_purchase&#39;</span>
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—å®¢æˆ·ç”Ÿå‘½å‘¨æœŸï¼ˆå¤©æ•°ï¼‰</span>
</span></span><span style=display:flex><span>        customer_metrics[<span style=color:#a5d6ff>&#39;lifespan_days&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> (
</span></span><span style=display:flex><span>            customer_metrics[<span style=color:#a5d6ff>&#39;last_purchase&#39;</span>] <span style=color:#ff7b72;font-weight:700>-</span> customer_metrics[<span style=color:#a5d6ff>&#39;first_purchase&#39;</span>]
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>.</span>dt<span style=color:#ff7b72;font-weight:700>.</span>days <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—å¹´åº¦è´­ä¹°é¢‘ç‡</span>
</span></span><span style=display:flex><span>        customer_metrics[<span style=color:#a5d6ff>&#39;purchase_frequency&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> (
</span></span><span style=display:flex><span>            customer_metrics[<span style=color:#a5d6ff>&#39;purchase_count&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span>
</span></span><span style=display:flex><span>            (customer_metrics[<span style=color:#a5d6ff>&#39;lifespan_days&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>365</span>)
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>.</span>fillna(<span style=color:#a5d6ff>0</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—LTV</span>
</span></span><span style=display:flex><span>        customer_metrics[<span style=color:#a5d6ff>&#39;ltv&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> (
</span></span><span style=display:flex><span>            customer_metrics[<span style=color:#a5d6ff>&#39;avg_purchase_value&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span>
</span></span><span style=display:flex><span>            customer_metrics[<span style=color:#a5d6ff>&#39;purchase_frequency&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span>
</span></span><span style=display:flex><span>            (customer_metrics[<span style=color:#a5d6ff>&#39;lifespan_days&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>365</span>)
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ•´ä½“æŒ‡æ ‡</span>
</span></span><span style=display:flex><span>        metrics <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;avg_ltv&#39;</span>: customer_metrics[<span style=color:#a5d6ff>&#39;ltv&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>mean(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;median_ltv&#39;</span>: customer_metrics[<span style=color:#a5d6ff>&#39;ltv&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>median(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;avg_purchase_value&#39;</span>: customer_metrics[<span style=color:#a5d6ff>&#39;avg_purchase_value&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>mean(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;avg_purchase_frequency&#39;</span>: customer_metrics[<span style=color:#a5d6ff>&#39;purchase_frequency&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>mean(),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;avg_lifespan_days&#39;</span>: customer_metrics[<span style=color:#a5d6ff>&#39;lifespan_days&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>mean()
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;customer_metrics&#39;</span>: customer_metrics,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;summary&#39;</span>: {k: round(v, <span style=color:#a5d6ff>2</span>) <span style=color:#ff7b72>for</span> k, v <span style=color:#ff7b72;font-weight:700>in</span> metrics<span style=color:#ff7b72;font-weight:700>.</span>items()}
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>calculate_cohort_ltv</span>(self):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;åŒæœŸç¾¤LTVåˆ†æ&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è·å–é¦–æ¬¡è´­ä¹°æœˆä»½</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>data[<span style=color:#a5d6ff>&#39;first_purchase_month&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>data<span style=color:#ff7b72;font-weight:700>.</span>groupby(<span style=color:#a5d6ff>&#39;customer_id&#39;</span>)[<span style=color:#a5d6ff>&#39;purchase_date&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>transform(<span style=color:#a5d6ff>&#39;min&#39;</span>)<span style=color:#ff7b72;font-weight:700>.</span>dt<span style=color:#ff7b72;font-weight:700>.</span>to_period(<span style=color:#a5d6ff>&#39;M&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æŒ‰åŒæœŸç¾¤å’Œæœˆä»½åˆ†ç»„</span>
</span></span><span style=display:flex><span>        cohort_revenue <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>data<span style=color:#ff7b72;font-weight:700>.</span>groupby(
</span></span><span style=display:flex><span>            [<span style=color:#a5d6ff>&#39;first_purchase_month&#39;</span>, <span style=color:#a5d6ff>&#39;purchase_date&#39;</span>]
</span></span><span style=display:flex><span>        )[<span style=color:#a5d6ff>&#39;revenue&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>sum()<span style=color:#ff7b72;font-weight:700>.</span>reset_index()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—ç´¯è®¡æ”¶å…¥</span>
</span></span><span style=display:flex><span>        cohort_revenue[<span style=color:#a5d6ff>&#39;period_number&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> (
</span></span><span style=display:flex><span>            cohort_revenue[<span style=color:#a5d6ff>&#39;purchase_date&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>dt<span style=color:#ff7b72;font-weight:700>.</span>to_period(<span style=color:#a5d6ff>&#39;M&#39;</span>) <span style=color:#ff7b72;font-weight:700>-</span>
</span></span><span style=display:flex><span>            cohort_revenue[<span style=color:#a5d6ff>&#39;first_purchase_month&#39;</span>]
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>.</span>apply(<span style=color:#ff7b72>lambda</span> x: x<span style=color:#ff7b72;font-weight:700>.</span>n)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        cohort_pivot <span style=color:#ff7b72;font-weight:700>=</span> cohort_revenue<span style=color:#ff7b72;font-weight:700>.</span>pivot(
</span></span><span style=display:flex><span>            index<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;first_purchase_month&#39;</span>,
</span></span><span style=display:flex><span>            columns<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;period_number&#39;</span>,
</span></span><span style=display:flex><span>            values<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;revenue&#39;</span>
</span></span><span style=display:flex><span>        )<span style=color:#ff7b72;font-weight:700>.</span>cumsum(axis<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>1</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> cohort_pivot
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>predict_ltv</span>(self, features, target<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;ltv&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        é¢„æµ‹LTVï¼ˆä½¿ç”¨æœºå™¨å­¦ä¹ ï¼‰
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        features: å®¢æˆ·ç‰¹å¾æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        target: ç›®æ ‡å˜é‡
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>from</span> <span style=color:#ff7b72>sklearn.model_selection</span> <span style=color:#ff7b72>import</span> train_test_split
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>from</span> <span style=color:#ff7b72>sklearn.ensemble</span> <span style=color:#ff7b72>import</span> RandomForestRegressor
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>from</span> <span style=color:#ff7b72>sklearn.metrics</span> <span style=color:#ff7b72>import</span> r2_score, mean_squared_error
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># åˆ†å‰²æ•°æ®</span>
</span></span><span style=display:flex><span>        X_train, X_test, y_train, y_test <span style=color:#ff7b72;font-weight:700>=</span> train_test_split(
</span></span><span style=display:flex><span>            features, target, test_size<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>0.2</span>, random_state<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>42</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®­ç»ƒæ¨¡å‹</span>
</span></span><span style=display:flex><span>        model <span style=color:#ff7b72;font-weight:700>=</span> RandomForestRegressor(
</span></span><span style=display:flex><span>            n_estimators<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>100</span>,
</span></span><span style=display:flex><span>            max_depth<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>10</span>,
</span></span><span style=display:flex><span>            random_state<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>42</span>
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>        model<span style=color:#ff7b72;font-weight:700>.</span>fit(X_train, y_train)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># é¢„æµ‹</span>
</span></span><span style=display:flex><span>        y_pred <span style=color:#ff7b72;font-weight:700>=</span> model<span style=color:#ff7b72;font-weight:700>.</span>predict(X_test)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è¯„ä¼°</span>
</span></span><span style=display:flex><span>        r2 <span style=color:#ff7b72;font-weight:700>=</span> r2_score(y_test, y_pred)
</span></span><span style=display:flex><span>        rmse <span style=color:#ff7b72;font-weight:700>=</span> np<span style=color:#ff7b72;font-weight:700>.</span>sqrt(mean_squared_error(y_test, y_pred))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;model&#39;</span>: model,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;r2_score&#39;</span>: round(r2, <span style=color:#a5d6ff>4</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;rmse&#39;</span>: round(rmse, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;feature_importance&#39;</span>: dict(zip(
</span></span><span style=display:flex><span>                features<span style=color:#ff7b72;font-weight:700>.</span>columns,
</span></span><span style=display:flex><span>                model<span style=color:#ff7b72;font-weight:700>.</span>feature_importances_
</span></span><span style=display:flex><span>            ))
</span></span><span style=display:flex><span>        }
</span></span></code></pre></td></tr></table></div></div><h2 id=ä¸‰é¢„ç®—ä¼˜åŒ–ç­–ç•¥>ä¸‰ã€é¢„ç®—ä¼˜åŒ–ç­–ç•¥<a hidden class=anchor aria-hidden=true href=#ä¸‰é¢„ç®—ä¼˜åŒ–ç­–ç•¥>#</a></h2><h3 id=31-åŸºäºroiçš„é¢„ç®—åˆ†é…>3.1 åŸºäºROIçš„é¢„ç®—åˆ†é…<a hidden class=anchor aria-hidden=true href=#31-åŸºäºroiçš„é¢„ç®—åˆ†é…>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">119
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">120
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">121
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">122
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">123
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">124
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">125
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">126
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">127
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">128
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">129
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">130
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">131
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">132
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">133
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">134
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">135
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">136
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">137
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">138
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">139
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">140
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">141
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">142
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">143
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">144
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">145
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">146
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">147
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">148
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># é¢„ç®—ä¼˜åŒ–ç®—æ³•</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>BudgetOptimizer</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;é¢„ç®—ä¼˜åŒ–å™¨&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self, channel_performance):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        channel_performance: æ¸ é“è¡¨ç°æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        [{
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;channel&#39;: &#39;æ¸ é“å&#39;,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;spend&#39;: æŠ•å…¥,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;revenue&#39;: æ”¶å…¥,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;impressions&#39;: å±•ç¤º,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;capacity&#39;: æœ€å¤§å®¹é‡
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>data <span style=color:#ff7b72;font-weight:700>=</span> channel_performance
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>optimize_by_roi</span>(self, total_budget):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        åŸºäºROIä¼˜åŒ–é¢„ç®—åˆ†é…
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ç­–ç•¥: æŒ‰ROIæ¯”ä¾‹åˆ†é…é¢„ç®—
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—æ¯ä¸ªæ¸ é“çš„ROI</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> item <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            item[<span style=color:#a5d6ff>&#39;roi&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> ((item[<span style=color:#a5d6ff>&#39;revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>-</span> item[<span style=color:#a5d6ff>&#39;spend&#39;</span>]) <span style=color:#ff7b72;font-weight:700>/</span> item[<span style=color:#a5d6ff>&#39;spend&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>)
</span></span><span style=display:flex><span>            item[<span style=color:#a5d6ff>&#39;roas&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> item[<span style=color:#a5d6ff>&#39;revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> item[<span style=color:#a5d6ff>&#39;spend&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è¿‡æ»¤æ­£ROIçš„æ¸ é“</span>
</span></span><span style=display:flex><span>        positive_roi_channels <span style=color:#ff7b72;font-weight:700>=</span> [ch <span style=color:#ff7b72>for</span> ch <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data <span style=color:#ff7b72>if</span> ch[<span style=color:#a5d6ff>&#39;roi&#39;</span>] <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> <span style=color:#ff7b72;font-weight:700>not</span> positive_roi_channels:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {<span style=color:#a5d6ff>&#39;error&#39;</span>: <span style=color:#a5d6ff>&#39;æ²¡æœ‰æ­£ROIçš„æ¸ é“&#39;</span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—æ€»ROIæƒé‡</span>
</span></span><span style=display:flex><span>        total_roi_weight <span style=color:#ff7b72;font-weight:700>=</span> sum(ch[<span style=color:#a5d6ff>&#39;roi&#39;</span>] <span style=color:#ff7b72>for</span> ch <span style=color:#ff7b72;font-weight:700>in</span> positive_roi_channels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># åˆ†é…é¢„ç®—</span>
</span></span><span style=display:flex><span>        allocation <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> channel <span style=color:#ff7b72;font-weight:700>in</span> positive_roi_channels:
</span></span><span style=display:flex><span>            allocated_budget <span style=color:#ff7b72;font-weight:700>=</span> (channel[<span style=color:#a5d6ff>&#39;roi&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> total_roi_weight) <span style=color:#ff7b72;font-weight:700>*</span> total_budget
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># æ£€æŸ¥å®¹é‡é™åˆ¶</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> <span style=color:#a5d6ff>&#39;capacity&#39;</span> <span style=color:#ff7b72;font-weight:700>in</span> channel <span style=color:#ff7b72;font-weight:700>and</span> allocated_budget <span style=color:#ff7b72;font-weight:700>&gt;</span> channel[<span style=color:#a5d6ff>&#39;capacity&#39;</span>]:
</span></span><span style=display:flex><span>                allocated_budget <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;capacity&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># é¢„ä¼°æ”¶å…¥</span>
</span></span><span style=display:flex><span>            estimated_revenue <span style=color:#ff7b72;font-weight:700>=</span> allocated_budget <span style=color:#ff7b72;font-weight:700>*</span> (<span style=color:#a5d6ff>1</span> <span style=color:#ff7b72;font-weight:700>+</span> channel[<span style=color:#a5d6ff>&#39;roi&#39;</span>] <span style=color:#ff7b72;font-weight:700>/</span> <span style=color:#a5d6ff>100</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            allocation<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;channel&#39;</span>: channel[<span style=color:#a5d6ff>&#39;channel&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;current_spend&#39;</span>: channel[<span style=color:#a5d6ff>&#39;spend&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;current_revenue&#39;</span>: channel[<span style=color:#a5d6ff>&#39;revenue&#39;</span>],
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;current_roi&#39;</span>: round(channel[<span style=color:#a5d6ff>&#39;roi&#39;</span>], <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;allocated_budget&#39;</span>: round(allocated_budget, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;estimated_revenue&#39;</span>: round(estimated_revenue, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        total_estimated_revenue <span style=color:#ff7b72;font-weight:700>=</span> sum(item[<span style=color:#a5d6ff>&#39;estimated_revenue&#39;</span>] <span style=color:#ff7b72>for</span> item <span style=color:#ff7b72;font-weight:700>in</span> allocation)
</span></span><span style=display:flex><span>        optimized_roi <span style=color:#ff7b72;font-weight:700>=</span> ((total_estimated_revenue <span style=color:#ff7b72;font-weight:700>-</span> total_budget) <span style=color:#ff7b72;font-weight:700>/</span> total_budget) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;allocation&#39;</span>: allocation,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_budget&#39;</span>: total_budget,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_estimated_revenue&#39;</span>: round(total_estimated_revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;optimized_roi&#39;</span>: round(optimized_roi, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;recommendation&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>_get_roi_recommendation(optimized_roi)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>optimize_by_marginal_roi</span>(self, total_budget, increment<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>1000</span>):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        åŸºäºè¾¹é™…ROIä¼˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        ç­–ç•¥: é€æ­¥åˆ†é…é¢„ç®—åˆ°è¾¹é™…ROIæœ€é«˜çš„æ¸ é“
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        remaining_budget <span style=color:#ff7b72;font-weight:700>=</span> total_budget
</span></span><span style=display:flex><span>        allocation <span style=color:#ff7b72;font-weight:700>=</span> {channel[<span style=color:#a5d6ff>&#39;channel&#39;</span>]: <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>for</span> channel <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>while</span> remaining_budget <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>            best_channel <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#79c0ff>None</span>
</span></span><span style=display:flex><span>            best_marginal_roi <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#ff7b72;font-weight:700>-</span>float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># å¯»æ‰¾è¾¹é™…ROIæœ€é«˜çš„æ¸ é“</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> channel <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>                current_spend <span style=color:#ff7b72;font-weight:700>=</span> allocation[channel[<span style=color:#a5d6ff>&#39;channel&#39;</span>]]
</span></span><span style=display:flex><span>                current_revenue <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> (current_spend <span style=color:#ff7b72;font-weight:700>/</span> channel[<span style=color:#a5d6ff>&#39;spend&#39;</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># è®¡ç®—å¢åŠ æŠ•å…¥åçš„ROI</span>
</span></span><span style=display:flex><span>                new_spend <span style=color:#ff7b72;font-weight:700>=</span> current_spend <span style=color:#ff7b72;font-weight:700>+</span> increment
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> new_spend <span style=color:#ff7b72;font-weight:700>&gt;</span> channel<span style=color:#ff7b72;font-weight:700>.</span>get(<span style=color:#a5d6ff>&#39;capacity&#39;</span>, float(<span style=color:#a5d6ff>&#39;inf&#39;</span>)):
</span></span><span style=display:flex><span>                    <span style=color:#ff7b72>continue</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                new_revenue <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> (new_spend <span style=color:#ff7b72;font-weight:700>/</span> channel[<span style=color:#a5d6ff>&#39;spend&#39;</span>])
</span></span><span style=display:flex><span>                marginal_revenue <span style=color:#ff7b72;font-weight:700>=</span> new_revenue <span style=color:#ff7b72;font-weight:700>-</span> current_revenue
</span></span><span style=display:flex><span>                marginal_roi <span style=color:#ff7b72;font-weight:700>=</span> (marginal_revenue <span style=color:#ff7b72;font-weight:700>/</span> increment) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>if</span> marginal_roi <span style=color:#ff7b72;font-weight:700>&gt;</span> best_marginal_roi:
</span></span><span style=display:flex><span>                    best_marginal_roi <span style=color:#ff7b72;font-weight:700>=</span> marginal_roi
</span></span><span style=display:flex><span>                    best_channel <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;channel&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># åˆ†é…é¢„ç®—</span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> best_channel <span style=color:#ff7b72;font-weight:700>and</span> best_marginal_roi <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>                allocation[best_channel] <span style=color:#ff7b72;font-weight:700>+=</span> increment
</span></span><span style=display:flex><span>                remaining_budget <span style=color:#ff7b72;font-weight:700>-=</span> increment
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># æ²¡æœ‰æ­£è¾¹é™…ROIçš„æ¸ é“ï¼Œåœæ­¢åˆ†é…</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è½¬æ¢ä¸ºç»“æœæ ¼å¼</span>
</span></span><span style=display:flex><span>        allocation_list <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>        total_estimated_revenue <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> channel <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>data:
</span></span><span style=display:flex><span>            channel_name <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;channel&#39;</span>]
</span></span><span style=display:flex><span>            allocated <span style=color:#ff7b72;font-weight:700>=</span> allocation[channel_name]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>if</span> allocated <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span>:
</span></span><span style=display:flex><span>                estimated_revenue <span style=color:#ff7b72;font-weight:700>=</span> channel[<span style=color:#a5d6ff>&#39;revenue&#39;</span>] <span style=color:#ff7b72;font-weight:700>*</span> (allocated <span style=color:#ff7b72;font-weight:700>/</span> channel[<span style=color:#a5d6ff>&#39;spend&#39;</span>])
</span></span><span style=display:flex><span>                total_estimated_revenue <span style=color:#ff7b72;font-weight:700>+=</span> estimated_revenue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                allocation_list<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;channel&#39;</span>: channel_name,
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;allocated_budget&#39;</span>: round(allocated, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;estimated_revenue&#39;</span>: round(estimated_revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;channel_roi&#39;</span>: round(channel[<span style=color:#a5d6ff>&#39;roi&#39;</span>], <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        optimized_roi <span style=color:#ff7b72;font-weight:700>=</span> ((total_estimated_revenue <span style=color:#ff7b72;font-weight:700>-</span> total_budget) <span style=color:#ff7b72;font-weight:700>/</span> total_budget) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;allocation&#39;</span>: allocation_list,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_budget&#39;</span>: total_budget,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;total_estimated_revenue&#39;</span>: round(total_estimated_revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;optimized_roi&#39;</span>: round(optimized_roi, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>_get_roi_recommendation</span>(self, roi):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;è·å–ROIä¼˜åŒ–å»ºè®®&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> roi <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>300</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;ä¼˜ç§€ï¼šæ‰©å¤§æŠ•å…¥è§„æ¨¡&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>elif</span> roi <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>200</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;è‰¯å¥½ï¼šç»§ç»­ä¼˜åŒ–&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>elif</span> roi <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>100</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;ä¸€èˆ¬ï¼šéœ€è¦æ”¹è¿›&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;å·®ï¼šé‡æ–°è¯„ä¼°ç­–ç•¥&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=32-å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–>3.2 å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–<a hidden class=anchor aria-hidden=true href=#32-å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">  9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 96
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 97
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 98
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 99
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">100
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">101
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">102
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">103
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">104
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">105
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">106
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">107
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">108
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">109
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">110
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">111
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">112
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">113
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">114
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">115
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">116
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">117
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">118
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>scipy.optimize</span> <span style=color:#ff7b72>import</span> minimize
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>numpy</span> <span style=color:#ff7b72>as</span> <span style=color:#ff7b72>np</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>MultiObjectiveBudgetOptimizer</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;å¤šç›®æ ‡é¢„ç®—ä¼˜åŒ–å™¨&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self, channels_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        channels_data: æ¸ é“æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        [{
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;name&#39;: &#39;æ¸ é“å&#39;,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;min_spend&#39;: æœ€å°æŠ•å…¥,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;max_spend&#39;: æœ€å¤§å®¹é‡,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;conversion_rate&#39;: è½¬åŒ–ç‡,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;avg_order_value&#39;: å¹³å‡å®¢å•ä»·
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }]
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>channels <span style=color:#ff7b72;font-weight:700>=</span> channels_data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>optimize</span>(self, total_budget, objectives):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        å¤šç›®æ ‡ä¼˜åŒ–
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        objectives: {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;maximize_revenue&#39;: æƒé‡,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;maximize_conversions&#39;: æƒé‡,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;minimize_cost&#39;: æƒé‡
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        n_channels <span style=color:#ff7b72;font-weight:700>=</span> len(self<span style=color:#ff7b72;font-weight:700>.</span>channels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># å†³ç­–å˜é‡ï¼šæ¯ä¸ªæ¸ é“çš„é¢„ç®—</span>
</span></span><span style=display:flex><span>        x0 <span style=color:#ff7b72;font-weight:700>=</span> np<span style=color:#ff7b72;font-weight:700>.</span>array([total_budget <span style=color:#ff7b72;font-weight:700>/</span> n_channels] <span style=color:#ff7b72;font-weight:700>*</span> n_channels)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># çº¦æŸæ¡ä»¶</span>
</span></span><span style=display:flex><span>        constraints <span style=color:#ff7b72;font-weight:700>=</span> [
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># é¢„ç®—æ€»å’Œçº¦æŸ</span>
</span></span><span style=display:flex><span>            {<span style=color:#a5d6ff>&#39;type&#39;</span>: <span style=color:#a5d6ff>&#39;eq&#39;</span>, <span style=color:#a5d6ff>&#39;fun&#39;</span>: <span style=color:#ff7b72>lambda</span> x: np<span style=color:#ff7b72;font-weight:700>.</span>sum(x) <span style=color:#ff7b72;font-weight:700>-</span> total_budget}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ¯ä¸ªæ¸ é“çš„é¢„ç®—èŒƒå›´</span>
</span></span><span style=display:flex><span>        bounds <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> channel <span style=color:#ff7b72;font-weight:700>in</span> self<span style=color:#ff7b72;font-weight:700>.</span>channels:
</span></span><span style=display:flex><span>            bounds<span style=color:#ff7b72;font-weight:700>.</span>append((channel[<span style=color:#a5d6ff>&#39;min_spend&#39;</span>], channel[<span style=color:#a5d6ff>&#39;max_spend&#39;</span>]))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># ç›®æ ‡å‡½æ•°</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>objective_function</span>(x):
</span></span><span style=display:flex><span>            total_revenue <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            total_conversions <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> i, channel <span style=color:#ff7b72;font-weight:700>in</span> enumerate(self<span style=color:#ff7b72;font-weight:700>.</span>channels):
</span></span><span style=display:flex><span>                spend <span style=color:#ff7b72;font-weight:700>=</span> x[i]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic># ä¼°ç®—æ”¶å…¥ï¼ˆåŸºäºå†å²æ•°æ®çš„ç®€åŒ–æ¨¡å‹ï¼‰</span>
</span></span><span style=display:flex><span>                estimated_conversions <span style=color:#ff7b72;font-weight:700>=</span> spend <span style=color:#ff7b72;font-weight:700>*</span> channel[<span style=color:#a5d6ff>&#39;conversion_rate&#39;</span>]
</span></span><span style=display:flex><span>                estimated_revenue <span style=color:#ff7b72;font-weight:700>=</span> estimated_conversions <span style=color:#ff7b72;font-weight:700>*</span> channel[<span style=color:#a5d6ff>&#39;avg_order_value&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                total_conversions <span style=color:#ff7b72;font-weight:700>+=</span> estimated_conversions
</span></span><span style=display:flex><span>                total_revenue <span style=color:#ff7b72;font-weight:700>+=</span> estimated_revenue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic># å¤šç›®æ ‡åŠ æƒå’Œï¼ˆè½¬æ¢ä¸ºæœ€å°åŒ–é—®é¢˜ï¼‰</span>
</span></span><span style=display:flex><span>            weighted_score <span style=color:#ff7b72;font-weight:700>=</span> (
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>-</span>objectives<span style=color:#ff7b72;font-weight:700>.</span>get(<span style=color:#a5d6ff>&#39;maximize_revenue&#39;</span>, <span style=color:#a5d6ff>1</span>) <span style=color:#ff7b72;font-weight:700>*</span> total_revenue <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72;font-weight:700>-</span>objectives<span style=color:#ff7b72;font-weight:700>.</span>get(<span style=color:#a5d6ff>&#39;maximize_conversions&#39;</span>, <span style=color:#a5d6ff>1</span>) <span style=color:#ff7b72;font-weight:700>*</span> total_conversions <span style=color:#ff7b72;font-weight:700>+</span>
</span></span><span style=display:flex><span>                objectives<span style=color:#ff7b72;font-weight:700>.</span>get(<span style=color:#a5d6ff>&#39;minimize_cost&#39;</span>, <span style=color:#a5d6ff>0</span>) <span style=color:#ff7b72;font-weight:700>*</span> total_budget
</span></span><span style=display:flex><span>            )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> weighted_score
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># ä¼˜åŒ–</span>
</span></span><span style=display:flex><span>        result <span style=color:#ff7b72;font-weight:700>=</span> minimize(
</span></span><span style=display:flex><span>            objective_function,
</span></span><span style=display:flex><span>            x0,
</span></span><span style=display:flex><span>            method<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>&#39;SLSQP&#39;</span>,
</span></span><span style=display:flex><span>            bounds<span style=color:#ff7b72;font-weight:700>=</span>bounds,
</span></span><span style=display:flex><span>            constraints<span style=color:#ff7b72;font-weight:700>=</span>constraints
</span></span><span style=display:flex><span>        )
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è§£æç»“æœ</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> result<span style=color:#ff7b72;font-weight:700>.</span>success:
</span></span><span style=display:flex><span>            allocation <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>            total_revenue <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            total_conversions <span style=color:#ff7b72;font-weight:700>=</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>for</span> i, channel <span style=color:#ff7b72;font-weight:700>in</span> enumerate(self<span style=color:#ff7b72;font-weight:700>.</span>channels):
</span></span><span style=display:flex><span>                spend <span style=color:#ff7b72;font-weight:700>=</span> result<span style=color:#ff7b72;font-weight:700>.</span>x[i]
</span></span><span style=display:flex><span>                conversions <span style=color:#ff7b72;font-weight:700>=</span> spend <span style=color:#ff7b72;font-weight:700>*</span> channel[<span style=color:#a5d6ff>&#39;conversion_rate&#39;</span>]
</span></span><span style=display:flex><span>                revenue <span style=color:#ff7b72;font-weight:700>=</span> conversions <span style=color:#ff7b72;font-weight:700>*</span> channel[<span style=color:#a5d6ff>&#39;avg_order_value&#39;</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                total_conversions <span style=color:#ff7b72;font-weight:700>+=</span> conversions
</span></span><span style=display:flex><span>                total_revenue <span style=color:#ff7b72;font-weight:700>+=</span> revenue
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                allocation<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;channel&#39;</span>: channel[<span style=color:#a5d6ff>&#39;name&#39;</span>],
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;allocated_budget&#39;</span>: round(spend, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;estimated_conversions&#39;</span>: round(conversions),
</span></span><span style=display:flex><span>                    <span style=color:#a5d6ff>&#39;estimated_revenue&#39;</span>: round(revenue, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>                })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            roi <span style=color:#ff7b72;font-weight:700>=</span> ((total_revenue <span style=color:#ff7b72;font-weight:700>-</span> total_budget) <span style=color:#ff7b72;font-weight:700>/</span> total_budget) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>
</span></span><span style=display:flex><span>            cpa <span style=color:#ff7b72;font-weight:700>=</span> total_budget <span style=color:#ff7b72;font-weight:700>/</span> total_conversions <span style=color:#ff7b72>if</span> total_conversions <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;success&#39;</span>: <span style=color:#79c0ff>True</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;allocation&#39;</span>: allocation,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;total_budget&#39;</span>: total_budget,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;estimated_revenue&#39;</span>: round(total_revenue, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;estimated_conversions&#39;</span>: round(total_conversions),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;estimated_roi&#39;</span>: round(roi, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;estimated_cpa&#39;</span>: round(cpa, <span style=color:#a5d6ff>2</span>)
</span></span><span style=display:flex><span>            }
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;success&#39;</span>: <span style=color:#79c0ff>False</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;error&#39;</span>: result<span style=color:#ff7b72;font-weight:700>.</span>message
</span></span><span style=display:flex><span>            }
</span></span></code></pre></td></tr></table></div></div><h2 id=å››è¥é”€æ•ˆæœé¢„æµ‹>å››ã€è¥é”€æ•ˆæœé¢„æµ‹<a hidden class=anchor aria-hidden=true href=#å››è¥é”€æ•ˆæœé¢„æµ‹>#</a></h2><h3 id=41-æ—¶é—´åºåˆ—é¢„æµ‹>4.1 æ—¶é—´åºåˆ—é¢„æµ‹<a hidden class=anchor aria-hidden=true href=#41-æ—¶é—´åºåˆ—é¢„æµ‹>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">87
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">88
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">89
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">90
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">91
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">92
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">93
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">94
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">95
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">96
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#8b949e;font-style:italic># è¥é”€æ•ˆæœé¢„æµ‹</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>import</span> <span style=color:#ff7b72>pandas</span> <span style=color:#ff7b72>as</span> <span style=color:#ff7b72>pd</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>sklearn.linear_model</span> <span style=color:#ff7b72>import</span> LinearRegression
</span></span><span style=display:flex><span><span style=color:#ff7b72>from</span> <span style=color:#ff7b72>sklearn.metrics</span> <span style=color:#ff7b72>import</span> mean_absolute_error, mean_squared_error
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>MarketingEffectPredictor</span>:
</span></span><span style=display:flex><span>    <span style=color:#a5d6ff>&#34;&#34;&#34;è¥é”€æ•ˆæœé¢„æµ‹å™¨&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>__init__</span>(self, historical_data):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        historical_data: å†å²è¥é”€æ•°æ®
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        {
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;date&#39;: æ—¥æœŸ,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;channel&#39;: æ¸ é“,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;spend&#39;: æŠ•å…¥,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;impressions&#39;: å±•ç¤º,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;clicks&#39;: ç‚¹å‡»,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;conversions&#39;: è½¬åŒ–,
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>            &#39;revenue&#39;: æ”¶å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        }
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        self<span style=color:#ff7b72;font-weight:700>.</span>data <span style=color:#ff7b72;font-weight:700>=</span> historical_data
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>predict_performance</span>(self, channel, future_spend, periods<span style=color:#ff7b72;font-weight:700>=</span><span style=color:#a5d6ff>4</span>):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        é¢„æµ‹æœªæ¥è¡¨ç°
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        channel: æ¸ é“åç§°
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        future_spend: é¢„æœŸæŠ•å…¥
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        periods: é¢„æµ‹å‘¨æœŸæ•°
</span></span></span><span style=display:flex><span><span style=color:#a5d6ff>        &#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è¿‡æ»¤è¯¥æ¸ é“çš„å†å²æ•°æ®</span>
</span></span><span style=display:flex><span>        channel_data <span style=color:#ff7b72;font-weight:700>=</span> self<span style=color:#ff7b72;font-weight:700>.</span>data[self<span style=color:#ff7b72;font-weight:700>.</span>data[<span style=color:#a5d6ff>&#39;channel&#39;</span>] <span style=color:#ff7b72;font-weight:700>==</span> channel]<span style=color:#ff7b72;font-weight:700>.</span>copy()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># å‡†å¤‡ç‰¹å¾</span>
</span></span><span style=display:flex><span>        channel_data[<span style=color:#a5d6ff>&#39;period&#39;</span>] <span style=color:#ff7b72;font-weight:700>=</span> range(len(channel_data))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># ç®€å•çº¿æ€§å›å½’é¢„æµ‹</span>
</span></span><span style=display:flex><span>        X <span style=color:#ff7b72;font-weight:700>=</span> channel_data[[<span style=color:#a5d6ff>&#39;period&#39;</span>, <span style=color:#a5d6ff>&#39;spend&#39;</span>]]<span style=color:#ff7b72;font-weight:700>.</span>values
</span></span><span style=display:flex><span>        y_revenue <span style=color:#ff7b72;font-weight:700>=</span> channel_data[<span style=color:#a5d6ff>&#39;revenue&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>values
</span></span><span style=display:flex><span>        y_conversions <span style=color:#ff7b72;font-weight:700>=</span> channel_data[<span style=color:#a5d6ff>&#39;conversions&#39;</span>]<span style=color:#ff7b72;font-weight:700>.</span>values
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®­ç»ƒæ”¶å…¥é¢„æµ‹æ¨¡å‹</span>
</span></span><span style=display:flex><span>        revenue_model <span style=color:#ff7b72;font-weight:700>=</span> LinearRegression()
</span></span><span style=display:flex><span>        revenue_model<span style=color:#ff7b72;font-weight:700>.</span>fit(X, y_revenue)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®­ç»ƒè½¬åŒ–é¢„æµ‹æ¨¡å‹</span>
</span></span><span style=display:flex><span>        conversions_model <span style=color:#ff7b72;font-weight:700>=</span> LinearRegression()
</span></span><span style=display:flex><span>        conversions_model<span style=color:#ff7b72;font-weight:700>.</span>fit(X, y_conversions)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># é¢„æµ‹æœªæ¥</span>
</span></span><span style=display:flex><span>        future_periods <span style=color:#ff7b72;font-weight:700>=</span> len(channel_data) <span style=color:#ff7b72;font-weight:700>+</span> np<span style=color:#ff7b72;font-weight:700>.</span>arange(periods)
</span></span><span style=display:flex><span>        future_X <span style=color:#ff7b72;font-weight:700>=</span> np<span style=color:#ff7b72;font-weight:700>.</span>column_stack([future_periods, [future_spend] <span style=color:#ff7b72;font-weight:700>*</span> periods])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        predicted_revenue <span style=color:#ff7b72;font-weight:700>=</span> revenue_model<span style=color:#ff7b72;font-weight:700>.</span>predict(future_X)
</span></span><span style=display:flex><span>        predicted_conversions <span style=color:#ff7b72;font-weight:700>=</span> conversions_model<span style=color:#ff7b72;font-weight:700>.</span>predict(future_X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># è®¡ç®—é¢„æµ‹æŒ‡æ ‡</span>
</span></span><span style=display:flex><span>        predictions <span style=color:#ff7b72;font-weight:700>=</span> []
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> i <span style=color:#ff7b72;font-weight:700>in</span> range(periods):
</span></span><span style=display:flex><span>            predictions<span style=color:#ff7b72;font-weight:700>.</span>append({
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;period&#39;</span>: i <span style=color:#ff7b72;font-weight:700>+</span> <span style=color:#a5d6ff>1</span>,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;spend&#39;</span>: future_spend,
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;predicted_revenue&#39;</span>: round(predicted_revenue[i], <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;predicted_conversions&#39;</span>: round(predicted_conversions[i]),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;predicted_roi&#39;</span>: round(((predicted_revenue[i] <span style=color:#ff7b72;font-weight:700>-</span> future_spend) <span style=color:#ff7b72;font-weight:700>/</span> future_spend) <span style=color:#ff7b72;font-weight:700>*</span> <span style=color:#a5d6ff>100</span>, <span style=color:#a5d6ff>2</span>),
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>&#39;predicted_cpa&#39;</span>: round(future_spend <span style=color:#ff7b72;font-weight:700>/</span> predicted_conversions[i], <span style=color:#a5d6ff>2</span>) <span style=color:#ff7b72>if</span> predicted_conversions[i] <span style=color:#ff7b72;font-weight:700>&gt;</span> <span style=color:#a5d6ff>0</span> <span style=color:#ff7b72>else</span> <span style=color:#a5d6ff>0</span>
</span></span><span style=display:flex><span>            })
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic># æ¨¡å‹è¯„ä¼°</span>
</span></span><span style=display:flex><span>        y_revenue_pred <span style=color:#ff7b72;font-weight:700>=</span> revenue_model<span style=color:#ff7b72;font-weight:700>.</span>predict(X)
</span></span><span style=display:flex><span>        y_conversions_pred <span style=color:#ff7b72;font-weight:700>=</span> conversions_model<span style=color:#ff7b72;font-weight:700>.</span>predict(X)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        model_metrics <span style=color:#ff7b72;font-weight:700>=</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;revenue_mae&#39;</span>: mean_absolute_error(y_revenue, y_revenue_pred),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;revenue_rmse&#39;</span>: np<span style=color:#ff7b72;font-weight:700>.</span>sqrt(mean_squared_error(y_revenue, y_revenue_pred)),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;conversions_mae&#39;</span>: mean_absolute_error(y_conversions, y_conversions_pred),
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;conversions_rmse&#39;</span>: np<span style=color:#ff7b72;font-weight:700>.</span>sqrt(mean_squared_error(y_conversions, y_conversions_pred))
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> {
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;channel&#39;</span>: channel,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;predictions&#39;</span>: predictions,
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;model_metrics&#39;</span>: {k: round(v, <span style=color:#a5d6ff>2</span>) <span style=color:#ff7b72>for</span> k, v <span style=color:#ff7b72;font-weight:700>in</span> model_metrics<span style=color:#ff7b72;font-weight:700>.</span>items()},
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#39;confidence&#39;</span>: self<span style=color:#ff7b72;font-weight:700>.</span>_assess_confidence(model_metrics)
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>def</span> <span style=color:#d2a8ff;font-weight:700>_assess_confidence</span>(self, metrics):
</span></span><span style=display:flex><span>        <span style=color:#a5d6ff>&#34;&#34;&#34;è¯„ä¼°é¢„æµ‹ç½®ä¿¡åº¦&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>if</span> metrics[<span style=color:#a5d6ff>&#39;revenue_mae&#39;</span>] <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>1000</span> <span style=color:#ff7b72;font-weight:700>and</span> metrics[<span style=color:#a5d6ff>&#39;conversions_mae&#39;</span>] <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>10</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;High&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>elif</span> metrics[<span style=color:#a5d6ff>&#39;revenue_mae&#39;</span>] <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>5000</span> <span style=color:#ff7b72;font-weight:700>and</span> metrics[<span style=color:#a5d6ff>&#39;conversions_mae&#39;</span>] <span style=color:#ff7b72;font-weight:700>&lt;</span> <span style=color:#a5d6ff>50</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Medium&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>else</span>:
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>return</span> <span style=color:#a5d6ff>&#39;Low&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=äº”è¥é”€ä»ªè¡¨ç›˜è®¾è®¡>äº”ã€è¥é”€ä»ªè¡¨ç›˜è®¾è®¡<a hidden class=anchor aria-hidden=true href=#äº”è¥é”€ä»ªè¡¨ç›˜è®¾è®¡>#</a></h2><h3 id=51-æ ¸å¿ƒæŒ‡æ ‡ç›‘æ§>5.1 æ ¸å¿ƒæŒ‡æ ‡ç›‘æ§<a hidden class=anchor aria-hidden=true href=#51-æ ¸å¿ƒæŒ‡æ ‡ç›‘æ§>#</a></h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#7ee787>è¥é”€åˆ†æä»ªè¡¨ç›˜æŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>ç¬¬ä¸€å±‚ - æ‰§è¡ŒæŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>å®æ—¶ç›‘æ§</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ä»Šæ—¥èŠ±è´¹</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ä»Šæ—¥å±•ç¤ºæ¬¡æ•°</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ä»Šæ—¥ç‚¹å‡»æ¬¡æ•°</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ä»Šæ—¥è½¬åŒ–æ¬¡æ•°</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å®æ—¶CTR/CVR</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æ“ä½œé¢„è­¦</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„ç®—ä½¿ç”¨ç‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å¼‚å¸¸æµé‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>è½¬åŒ–ç‡ä¸‹é™</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>CPAä¸Šå‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>ç¬¬äºŒå±‚ - æ•ˆæœæŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æ¸ é“è¡¨ç°</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å„æ¸ é“ROI</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å„æ¸ é“ROAS</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å„æ¸ é“CPA</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å„æ¸ é“è½¬åŒ–ç‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>è¶‹åŠ¿åˆ†æ</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å‘¨ç¯æ¯”å˜åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>æœˆç¯æ¯”å˜åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>åŒæ¯”å˜åŒ–</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ç§»åŠ¨å¹³å‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>ç¬¬ä¸‰å±‚ - ä¸šåŠ¡æŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>è·å®¢æŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>æ–°å¢ç”¨æˆ·æ•°</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>CAC</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>LTV</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>LTV/CACæ¯”ç‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>æ”¶å…¥æŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>è¥é”€å¸¦æ¥æ”¶å…¥</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>è¥é”€ROI</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>è¾¹é™…ROI</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>ç›ˆäºå¹³è¡¡ç‚¹</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>  </span><span style=color:#7ee787>ç¬¬å››å±‚ - é¢„æµ‹æŒ‡æ ‡</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>é¢„æµ‹æ•°æ®</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„æµ‹æœ¬æœˆæ”¶å…¥</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„æµ‹LTV</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„æµ‹è½¬åŒ–ç‡</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„æµ‹ç½®ä¿¡åº¦</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>    </span><span style=color:#7ee787>ä¼˜åŒ–å»ºè®®</span>:<span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>é¢„ç®—è°ƒæ•´å»ºè®®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>æ¸ é“ä¼˜åŒ–å»ºè®®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>åˆ›æ„ä¼˜åŒ–å»ºè®®</span><span style=color:#6e7681>
</span></span></span><span style=display:flex><span><span style=color:#6e7681>      </span>- <span style=color:#a5d6ff>å‡ºä»·ä¼˜åŒ–å»ºè®®</span><span style=color:#6e7681>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>è¥é”€å½’å› å’ŒROIåˆ†ææ˜¯æ•°æ®é©±åŠ¨è¥é”€çš„æ ¸å¿ƒï¼š</p><ol><li><strong>é€‰æ‹©åˆé€‚çš„å½’å› æ¨¡å‹</strong> - æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹é€‰æ‹©</li><li><strong>å»ºç«‹å®Œå–„çš„è¿½è¸ªä½“ç³»</strong> - ç¡®ä¿æ•°æ®å‡†ç¡®æ€§</li><li><strong>ç»¼åˆè¯„ä¼°è¥é”€æ•ˆæœ</strong> - ä¸ä»…çœ‹ROIï¼Œè¿˜è¦çœ‹é•¿æœŸä»·å€¼</li><li><strong>æŒç»­ä¼˜åŒ–é¢„ç®—åˆ†é…</strong> - åŸºäºæ•°æ®åŠ¨æ€è°ƒæ•´</li><li><strong>å»ºç«‹é¢„æµ‹èƒ½åŠ›</strong> - ä»å†å²åˆ°æœªæ¥çš„æ´å¯Ÿ</li></ol><p>è®°ä½ï¼Œè¥é”€åˆ†æçš„ç›®æ ‡ä¸æ˜¯ç²¾ç¡®åˆ°å°æ•°ç‚¹ï¼Œè€Œæ˜¯ä¸ºå†³ç­–æä¾›å¯é ä¾æ®ã€‚åœ¨æ•°æ®åˆ†æçš„åŸºç¡€ä¸Šï¼Œç»“åˆä¸šåŠ¡æ´å¯Ÿï¼Œæ‰èƒ½åšå‡ºæœ€ä½³çš„è¥é”€å†³ç­–ã€‚</p><blockquote><p><strong>å®ç”¨å·¥å…·</strong></p><ul><li><a href=https://www.util.cn/tools/percentage-calculator/>ç™¾åˆ†æ¯”è®¡ç®—å™¨</a> - ROIå’Œè½¬åŒ–ç‡è®¡ç®—</li><li><a href=https://www.util.cn/tools/roi-calculator/>ROIè®¡ç®—å™¨</a> - æŠ•èµ„å›æŠ¥åˆ†æ</li><li><a href=https://www.util.cn/tools/investment-calculator/>æŠ•èµ„è®¡ç®—å™¨</a> - å¤åˆå¢é•¿åˆ†æ</li></ul></blockquote></div><footer class=post-footer-modern><div class=post-tags-modern><span class=tags-label>ğŸ·ï¸ æ ‡ç­¾</span><div class=tags-list><a href=/blog/tags/%E8%90%A5%E9%94%80%E5%BD%92%E5%9B%A0/ class=tag-pill>è¥é”€å½’å› 
</a><a href=/blog/tags/roi%E5%88%86%E6%9E%90/ class=tag-pill>ROIåˆ†æ
</a><a href=/blog/tags/%E8%90%A5%E9%94%80%E6%95%88%E6%9E%9C/ class=tag-pill>è¥é”€æ•ˆæœ
</a><a href=/blog/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/ class=tag-pill>æ•°æ®åˆ†æ
</a><a href=/blog/tags/%E9%A2%84%E7%AE%97%E4%BC%98%E5%8C%96/ class=tag-pill>é¢„ç®—ä¼˜åŒ–</a></div></div><style>.post-footer-modern{margin-top:3rem;padding-top:2rem;border-top:1px solid var(--border,#333333)}.post-tags-modern{display:flex;align-items:center;gap:1rem;margin-bottom:2rem;flex-wrap:wrap}.tags-label{font-size:.875rem;font-weight:600;color:var(--secondary,#999999) !important;white-space:nowrap}.tags-list{display:flex;flex-wrap:wrap;gap:.5rem;flex:1}.tag-pill{display:inline-block;padding:.25rem .75rem;background:rgba(255,255,255,5%);border:1px solid var(--border,#333333);border-radius:0;color:var(--secondary,#cccccc) !important;text-decoration:none;font-size:.8rem;font-weight:500;transition:all .2s ease}.tag-pill:hover{background:var(--primary,#ffffff);color:var(--background,#000000) !important;border-color:var(--primary,#ffffff);transform:translateY(-1px)}.post-nav-modern{margin-top:2rem}.nav-grid{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.nav-card{display:flex;align-items:center;gap:1rem;padding:1.25rem;background:rgba(255,255,255,2%);border:1px solid var(--border,#333333);border-radius:12px;text-decoration:none;transition:all .2s ease;min-height:80px}.nav-card:hover{background:rgba(255,255,255,5%);border-color:var(--primary,#ffffff);transform:translateY(-2px)}.nav-card.nav-prev{justify-content:flex-start}.nav-card.nav-next{justify-content:flex-end;text-align:right}.nav-card.nav-next .nav-content{text-align:right}.nav-empty{display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,1%);border:1px dashed var(--border,#333333);color:var(--secondary,#666666)}.nav-arrow{font-size:1.5rem;color:var(--primary,#ffffff);font-weight:300}.nav-content{flex:1}.nav-title{font-size:.95rem;font-weight:600;color:var(--primary,#ffffff) !important;line-height:1.4;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}[data-theme=light] .post-footer-modern{border-color:var(--border-light,#dee2e6)}[data-theme=light] .tags-label{color:var(--secondary-light,#6c757d) !important}[data-theme=light] .tag-pill{background:rgba(0,0,0,5%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#495057) !important}[data-theme=light] .tag-pill:hover{background:var(--primary-light,#0066cc);color:var(--background-light,#ffffff) !important;border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-card{background:rgba(0,0,0,2%);border-color:var(--border-light,#dee2e6)}[data-theme=light] .nav-card:hover{background:rgba(0,102,204,5%);border-color:var(--primary-light,#0066cc)}[data-theme=light] .nav-empty{background:rgba(0,0,0,1%);border-color:var(--border-light,#dee2e6);color:var(--secondary-light,#6c757d)}[data-theme=light] .nav-arrow{color:var(--primary-light,#0066cc)}[data-theme=light] .nav-title{color:var(--primary-light,#212529) !important}@media(max-width:768px){.nav-grid{grid-template-columns:1fr;gap:.75rem}.nav-card{padding:1rem;min-height:70px}.nav-card.nav-next{text-align:left}.nav-card.nav-next .nav-content{text-align:left}.nav-title{font-size:.875rem}.post-tags-modern{flex-direction:column;gap:.75rem}}@media(max-width:480px){.nav-arrow{font-size:1.25rem}.nav-card{padding:.875rem}.nav-title{font-size:.8rem;-webkit-line-clamp:1}}</style><nav class=post-nav-modern><div class=nav-grid><a href=/blog/articles/%E7%A4%BE%E4%BA%A4%E5%AA%92%E4%BD%93%E8%90%A5%E9%94%80%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E6%89%93%E9%80%A0%E7%97%85%E6%AF%92%E5%BC%8F%E4%BC%A0%E6%92%AD%E7%9A%84%E5%93%81%E7%89%8C%E5%86%85%E5%AE%B9/ class="nav-card nav-prev"><div class=nav-arrow>â†</div><div class=nav-content><div class=nav-title>ç¤¾äº¤åª’ä½“è¥é”€å®Œå…¨æŒ‡å—ï¼šæ‰“é€ ç—…æ¯’å¼ä¼ æ’­çš„å“ç‰Œå†…å®¹</div></div></a><a href=/blog/articles/vue-3.5%E5%93%8D%E5%BA%94%E5%BC%8F%E7%B3%BB%E7%BB%9F%E6%B7%B1%E5%BA%A6%E8%A7%A3%E6%9E%90proxy%E4%B8%8Ereactivity-api%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86/ class="nav-card nav-next"><div class=nav-content><div class=nav-title>Vue 3.5å“åº”å¼ç³»ç»Ÿæ·±åº¦è§£æï¼šProxyä¸Reactivity APIçš„å®ç°åŸç†</div></div><div class=nav-arrow>â†’</div></a></div></nav></footer></main><aside class=post-sidebar><div class=sidebar-toc id=sidebar-toc><div class=toc-header><div class=toc-title>ç›®å½•</div><button class=toc-toggle id=toc-toggle aria-label="Toggle TOC">
<svg class="toc-toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6 6 18M6 6l12 12"/></svg></button></div><div class=toc-content id=toc-content><ul class=toc-list><li class="toc-item toc-h2"><a href=#h2-0 class=toc-item-link><span class=toc-item-text>å¼•è¨€</span></a></li><li class="toc-item toc-h2"><a href=#h2-1 class=toc-item-link><span class=toc-item-text>ä¸€ã€è¥é”€å½’å› æ¨¡å‹</span></a></li><li class="toc-item toc-h2"><a href=#h2-2 class=toc-item-link><span class=toc-item-text>äºŒã€ROIè®¡ç®—æ–¹æ³•</span></a></li><li class="toc-item toc-h2"><a href=#h2-3 class=toc-item-link><span class=toc-item-text>ä¸‰ã€é¢„ç®—ä¼˜åŒ–ç­–ç•¥</span></a></li><li class="toc-item toc-h2"><a href=#h2-4 class=toc-item-link><span class=toc-item-text>å››ã€è¥é”€æ•ˆæœé¢„æµ‹</span></a></li><li class="toc-item toc-h2"><a href=#h2-5 class=toc-item-link><span class=toc-item-text>äº”ã€è¥é”€ä»ªè¡¨ç›˜è®¾è®¡</span></a></li><li class="toc-item toc-h2"><a href=#h2-6 class=toc-item-link><span class=toc-item-text>æ€»ç»“</span></a></li></ul></div></div><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toc"),t=document.getElementById("toc-toggle"),o=document.getElementById("toc-content"),i=t?.querySelector(".toc-toggle-icon");if(!e)return;let n=!1;t&&t.addEventListener("click",function(){n=!n,n?(o.style.display="none",e.style.width="auto",i.innerHTML='<path d="M9 18l6-6-6-6"/>'):(o.style.display="block",e.style.width="200px",i.innerHTML='<path d="M18 6L6 18M6 6l12 12"/>')});const s=document.querySelector(".post-content");if(s){const e=s.querySelectorAll("h1");e.forEach((e,t)=>{e.id=`h1-${t}`});const t=s.querySelectorAll("h2");t.forEach((e,t)=>{e.id=`h2-${t}`})}const a=document.querySelectorAll(".toc-item-link");a.forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const n=this.getAttribute("href").substring(1),t=document.getElementById(n);if(t){const e=document.querySelector(".post-header-main")?.offsetHeight||0,n=t.offsetTop-e-20;window.scrollTo({top:n,behavior:"smooth"})}})})})</script><style>.sidebar-toc{position:sticky;top:2rem;width:200px;background:#fff;border:1px solid #e5e7eb;border-radius:4px;overflow:hidden;box-shadow:0 1px 3px rgba(0,0,0,.1);z-index:100}.sidebar-toc.hidden{display:none}.toc-header{padding:12px 16px;border-bottom:1px solid #e5e7eb;background:#fafbfc;display:flex;align-items:center;justify-content:space-between}.toc-title{margin:0;font-size:13px;font-weight:500;color:#374151 !important;font-family:-apple-system,BlinkMacSystemFont,segoe ui,Roboto,sans-serif;text-transform:uppercase;letter-spacing:1px}.toc-toggle{background:0 0;border:none;cursor:pointer;padding:4px;border-radius:4px;display:flex;align-items:center;justify-content:center;transition:all .2s ease;color:#6b7280}.toc-toggle:hover{background:#e5e7eb;color:#374151}.toc-toggle-icon{transition:transform .2s ease}.toc-content{padding:12px 0}.toc-list{list-style:none;margin:0;padding:0}.toc-item{margin-bottom:4px;display:block !important;visibility:visible !important}.toc-h1,.toc-h2{display:block !important}.toc-h2{margin-left:0}.toc-item-link{display:flex;align-items:center;gap:8px;padding:8px 12px;color:#374151 !important;text-decoration:none;font-size:13px;line-height:1.4;border-radius:3px;transition:all .2s ease;font-weight:400}.toc-item-link:hover{background:#f8fafc;color:#1f2937 !important}.toc-item-link.active{background:#e0f2fe;color:#01579b !important;font-weight:500}.toc-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}.dot-red{background:#ef4444}.dot-blue{background:#2196f3}.toc-item-text{color:#1f2937 !important;font-weight:400;flex:1;display:inline !important;visibility:visible !important;opacity:1 !important;font-size:13px !important;line-height:1.4 !important}.toc-item-link .toc-item-text{color:#1f2937 !important;display:inline !important;visibility:visible !important;opacity:1 !important}.toc-item.active .dot-red{background:#d32f2f}.toc-item.active .dot-blue{background:#1976d2}[data-theme=dark] .sidebar-toc{background:#1f2937;border-color:#374151;box-shadow:0 1px 3px rgba(0,0,0,.3)}[data-theme=dark] .toc-header{background:#111827;border-color:#374151}[data-theme=dark] .toc-title{color:#f3f4f6 !important}[data-theme=dark] .toc-toggle{color:#9ca3af}[data-theme=dark] .toc-toggle:hover{background:#374151;color:#f3f4f6}[data-theme=dark] .toc-item-link{color:#e5e7eb !important}[data-theme=dark] .toc-item-link:hover{background:#374151;color:#f9fafb !important}[data-theme=dark] .toc-item-link.active{background:#0d47a1;color:#fff !important}[data-theme=dark] .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}[data-theme=dark] .toc-item-link .toc-item-text{color:#f9fafb !important;display:inline !important;visibility:visible !important;opacity:1 !important}@media(max-width:1024px){.sidebar-toc{display:none}.post-content-wrapper{grid-template-columns:1fr !important;padding:0 1rem !important}}</style><style>.post-content-wrapper{display:grid;grid-template-columns:1fr 200px;gap:2rem;padding:0 2rem;max-width:100%}.post-content-main{min-width:0}.post-sidebar{position:sticky;top:2rem;height:fit-content;min-width:0}.post-header-main{margin-bottom:2rem;padding-bottom:1rem;border-bottom:1px solid var(--border,#333333)}.post-header-main .post-title{color:var(--primary,#ffffff) !important;font-size:2.5rem;font-weight:700;line-height:1.2;margin-bottom:1rem}.post-header-main .post-description{color:var(--secondary,#cccccc) !important;font-size:1.1rem;line-height:1.6;margin-bottom:1rem}.post-header-main .post-meta{margin-bottom:0}@media(max-width:1024px){.post-content-wrapper{grid-template-columns:1fr !important;gap:1rem;padding:0 1rem !important}.post-sidebar{display:none}}@media(max-width:768px){.post-header-main .post-title{font-size:2rem}.post-header-main .post-description{font-size:1rem}}</style></aside></div></article></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>