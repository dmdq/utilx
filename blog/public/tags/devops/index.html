<!doctype html><html lang=zh-cn dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>DevOps | æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</title><meta name=keywords content><meta name=description content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·ï¼šåˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒ"><meta name=author content="util.cn Team"><link rel=canonical href=/blog/tags/devops/><link crossorigin=anonymous href=/blog/assets/css/stylesheet.7e8505b7cdf8bb22ab2305e53c2700bb06c7e64faeb72cd3468823a9a3bd3d6e.css integrity="sha256-foUFt834uyKrIwXlPCcAuwbH5k+utyzTRogjqaO9PW4=" rel="preload stylesheet" as=style><link rel=icon href=/favicon.ico><link rel=icon type=image/png sizes=16x16 href=/blog/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=/blog/favicon-32x32.png><link rel=apple-touch-icon href=/blog/apple-touch-icon.png><link rel=mask-icon href=/blog/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/blog/tags/devops/feed.xml title=rss><link rel=alternate hreflang=zh-cn href=/blog/tags/devops/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><script src=/js/external-link-config.js></script><script src=/js/external-link-interceptor.js></script><link rel=stylesheet href=/blog/css/custom.css media=screen><script type=application/ld+json>{"@context":"https://schema.org","@type":"WebSite","name":"æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«","url":"https://www.util.cn/blog/","description":"æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚","publisher":{"@type":"Organization","name":"æœ‰æ¡å·¥å…·","url":"https://www.util.cn","logo":{"@type":"ImageObject","url":"https://www.util.cn/blog/logo/logo-256.png","width":256,"height":256}},"potentialAction":[{"@type":"SearchAction","target":"https://www.util.cn/blog/search?q={search_term_string}","query-input":"required name=search_term_string"}]}</script><meta property="og:type" content="website"><meta property="og:title" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta property="og:description" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚æä¾›JSONæ ¼å¼åŒ–ã€SQLä¼˜åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰åœ¨çº¿å·¥å…·çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—ï¼Œå¸®åŠ©å¼€å‘è€…æå‡å·¥ä½œæ•ˆç‡ã€‚"><meta property="og:url" content="https://www.util.cn/blog/"><meta property="og:site_name" content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢"><meta property="og:image" content="https://www.util.cn/blog/logo/logo-256.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><meta name=twitter:card content="summary_large_image"><meta name=twitter:title content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· | å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ & ç¼–ç¨‹æŠ€å·§åˆ†äº«"><meta name=twitter:description content="æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ - åˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒã€‚"><meta name=twitter:image content="https://www.util.cn/blog/logo/logo-256.png"><meta name=baidu-site-verification content><meta name=category content="æŠ€æœ¯åšå®¢,å¼€å‘è€…å·¥å…·,ç¼–ç¨‹æ•™ç¨‹"><meta name=coverage content="Worldwide"><meta name=distribution content="Global"><meta name=rating content="General"><script id=51la_code async crossorigin=anonymous src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=pro"></script><script>window.addEventListener("load",function(){setTimeout(function(){typeof la!="undefined"?console.log("51laç»Ÿè®¡å·²åŠ è½½"):(console.warn("51laç»Ÿè®¡åŠ è½½å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ¡ˆ"),function(){var e=document.createElement("script");e.src="https://sdk.51.la/js-sdk-pro.min.js?id=3OM52V0xJAPv6ozF&hash=backup",e.async=!0,document.head.appendChild(e)}())},3e3)})</script><meta property="og:url" content="/blog/tags/devops/"><meta property="og:site_name" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·"><meta property="og:title" content="DevOps"><meta property="og:description" content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·ï¼šåˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒ"><meta property="og:locale" content="zh-cn"><meta property="og:type" content="website"><meta name=twitter:card content="summary"><meta name=twitter:title content="DevOps"><meta name=twitter:description content="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·ï¼šåˆ†äº«å¼€å‘è€…å·¥å…·ä½¿ç”¨æ•™ç¨‹ã€ç¼–ç¨‹æŠ€å·§å’Œå®æˆ˜å¼€å‘ç»éªŒ"></head><body class=list id=top><header class=header><nav class=nav><div class=logo><a href=/blog/ accesskey=h title="æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…· (Alt + H)">æŠ€æœ¯åšå®¢ - æœ‰æ¡å·¥å…·</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/blog/posts/ title="æ‰€æœ‰æ–‡ç« åˆ—è¡¨ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŸ¥çœ‹æ‰€æœ‰æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ–‡ç« </span></a></li><li><a href=https://www.util.cn title="æœ‰æ¡å·¥å…· - å¼€å‘è€…çš„å¸¸ç”¨å·¥å…·é›†åˆï¼šæ— å¹¿å‘Š Â· æœ¬åœ°è®¡ç®— Â· å³å¼€å³ç”¨çš„åœ¨çº¿å·¥å…·å¹³å°ï¼Œæä¾›JSONæ ¼å¼åŒ–ã€SQLæ ¼å¼åŒ–ã€Markdownç¼–è¾‘å™¨ç­‰å®ç”¨å·¥å…·"><span>æœ‰æ¡å·¥å…·</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li><li><a href=/blog/categories/ title="æ–‡ç« åˆ†ç±» - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æŠ€æœ¯é¢†åŸŸåˆ†ç±»çš„ä¼˜è´¨æ–‡ç« ï¼ŒåŒ…æ‹¬å‰ç«¯å¼€å‘ã€å·¥å…·ä½¿ç”¨ã€ç¼–ç¨‹æŠ€å·§ç­‰"><span>åˆ†ç±»</span></a></li><li><a href=/blog/tags/ title="æ ‡ç­¾äº‘ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡æ ‡ç­¾å¿«é€Ÿæ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹"><span>æ ‡ç­¾</span></a></li><li><a href=/blog/archives/ title="æ–‡ç« å½’æ¡£ - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šæŒ‰æ—¶é—´æŸ¥çœ‹å†å²æ–‡ç« "><span>å½’æ¡£</span></a></li><li><a href=/blog/search/ title="æœç´¢æ–‡ç«  - æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢ï¼šé€šè¿‡å…³é”®è¯æœç´¢æ‰¾åˆ°æ„Ÿå…´è¶£çš„æŠ€æœ¯æ–‡ç« å’Œæ•™ç¨‹å†…å®¹ï¼Œæ”¯æŒæ ‡é¢˜ã€å†…å®¹ã€åˆ†ç±»å’Œæ ‡ç­¾æœç´¢"><span>æœç´¢</span></a></li></ul></nav></header><main class=main><header class=page-header><h1>DevOps</h1></header><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>äº‘åŸç”Ÿæ¶æ„å®Œå…¨æŒ‡å—ï¼šKubernetesä¸å¾®æœåŠ¡å®è·µ</h2></header><div class=entry-content><p>å¼•è¨€ äº‘åŸç”Ÿæ¶æ„æ˜¯ç°ä»£åº”ç”¨éƒ¨ç½²çš„æ ‡å‡†æ¨¡å¼ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•ä½¿ç”¨Kubernetesã€æœåŠ¡ç½‘æ ¼å’ŒDevOpså®è·µæ„å»ºå¼¹æ€§ã€å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ã€‚
ä¸€ã€Kubernetesæ ¸å¿ƒæ¦‚å¿µ 1.1 Podä¸Deployment 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 # ========== Podé…ç½® ========== apiVersion: v1 kind: Pod metadata: name: nginx-pod labels: app: nginx spec: containers: - name: nginx image: nginx:1.25 ports: - containerPort: 80 resources: requests: memory: "64Mi" cpu: "250m" limits: memory: "128Mi" cpu: "500m" livenessProbe: httpGet: path: / port: 80 initialDelaySeconds: 30 periodSeconds: 10 readinessProbe: httpGet: path: / port: 80 initialDelaySeconds: 5 periodSeconds: 5 --- # ========== Deploymenté…ç½® ========== apiVersion: apps/v1 kind: Deployment metadata: name: nginx-deployment spec: replicas: 3 selector: matchLabels: app: nginx strategy: type: RollingUpdate rollingUpdate: maxSurge: 1 maxUnavailable: 0 template: metadata: labels: app: nginx spec: containers: - name: nginx image: nginx:1.25 ports: - containerPort: 80 env: - name: ENVIRONMENT value: "production" volumeMounts: - name: config-volume mountPath: /etc/nginx/config.d volumes: - name: config-volume configMap: name: nginx-config 1.2 Serviceä¸Ingress 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 # ========== Serviceé…ç½® ========== apiVersion: v1 kind: Service metadata: name: nginx-service spec: type: ClusterIP selector: app: nginx ports: - port: 80 targetPort: 80 protocol: TCP --- # ========== Ingressé…ç½® ========== apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: nginx-ingress annotations: kubernetes.io/ingress.class: nginx cert-manager.io/cluster-issuer: letsencrypt-prod nginx.ingress.kubernetes.io/ssl-redirect: "true" spec: tls: - hosts: - app.example.com secretName: app-tls rules: - host: app.example.com http: paths: - path: / pathType: Prefix backend: service: name: nginx-service port: number: 80 äºŒã€æœåŠ¡ç½‘æ ¼ 2.1 Istioé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # ========== Istio VirtualService ========== apiVersion: networking.istio.io/v1beta1 kind: VirtualService metadata: name: reviews spec: hosts: - reviews http: - match: - headers: end-user: exact: jason fault: delay: percentage: value: 100 fixedDelay: 3s route: - destination: host: reviews subset: v2 - route: - destination: host: reviews subset: v1 --- # ========== Istio DestinationRule ========== apiVersion: networking.istio.io/v1beta1 kind: DestinationRule metadata: name: reviews spec: host: reviews trafficPolicy: loadBalancer: simple: LEAST_CONN subsets: - name: v1 labels: version: v1 - name: v2 labels: version: v2 trafficPolicy: loadBalancer: simple: RANDOM ä¸‰ã€äº‘åŸç”Ÿæœ€ä½³å®è·µ 3.1 å¥åº·æ£€æŸ¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 livenessProbe: httpGet: path: /health/live port: 8080 initialDelaySeconds: 30 periodSeconds: 10 timeoutSeconds: 5 failureThreshold: 3 readinessProbe: httpGet: path: /health/ready port: 8080 initialDelaySeconds: 5 periodSeconds: 5 timeoutSeconds: 3 failureThreshold: 3 startupProbe: httpGet: path: /health/startup port: 8080 initialDelaySeconds: 0 periodSeconds: 5 timeoutSeconds: 3 failureThreshold: 30 3.2 èµ„æºé™åˆ¶ 1 2 3 4 5 6 7 resources: requests: memory: "256Mi" cpu: "250m" limits: memory: "512Mi" cpu: "500m" æ€»ç»“ äº‘åŸç”Ÿæ¶æ„æ˜¯ç°ä»£åº”ç”¨éƒ¨ç½²çš„æœ€ä½³å®è·µã€‚é€šè¿‡Kubernetesã€æœåŠ¡ç½‘æ ¼å’ŒDevOpsçš„ç»“åˆï¼Œå¯ä»¥æ„å»ºå¼¹æ€§ã€å¯æ‰©å±•çš„åº”ç”¨ç³»ç»Ÿã€‚
...</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/ class=category-link>äº‘åŸç”Ÿ</a><a href=/blog/categories/kubernetes/ class=category-link>Kubernetes</a></div><span class=post-date>2025-12-30</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to äº‘åŸç”Ÿæ¶æ„å®Œå…¨æŒ‡å—ï¼šKubernetesä¸å¾®æœåŠ¡å®è·µ" href=/blog/articles/%E4%BA%91%E5%8E%9F%E7%94%9F%E6%9E%B6%E6%9E%84%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97kubernetes%E4%B8%8E%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%9E%E8%B7%B5/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>DevOpsä¸CI/CDå®Œå…¨æŒ‡å—ï¼šæ„å»ºé«˜æ•ˆçš„è½¯ä»¶äº¤ä»˜æµæ°´çº¿</h2></header><div class=entry-content><p>å¼•è¨€ åœ¨å½“ä»Šå¿«é€Ÿè¿­ä»£çš„è½¯ä»¶å¼€å‘ç¯å¢ƒä¸­ï¼ŒDevOpså®è·µå’ŒCI/CDæµæ°´çº¿å·²æˆä¸ºå›¢é˜Ÿæé«˜äº¤ä»˜æ•ˆç‡ã€ä¿è¯è½¯ä»¶è´¨é‡çš„å…³é”®ã€‚æœ¬æ–‡å°†æ·±å…¥æ¢è®¨å¦‚ä½•æ„å»ºå®Œæ•´çš„DevOpsä½“ç³»ï¼Œä»ä»£ç æäº¤åˆ°ç”Ÿäº§éƒ¨ç½²çš„å…¨æµç¨‹è‡ªåŠ¨åŒ–å®è·µã€‚
ä¸€ã€DevOpsæ ¸å¿ƒç†å¿µ 1.1 DevOpsçš„CALMSæ¨¡å‹ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 # ========== DevOps CALMSæ¨¡å‹ ========== """ C - Culture (æ–‡åŒ–) â”œâ”€â”€ åä½œç²¾ç¥ â”œâ”€â”€ æŒç»­æ”¹è¿› â”œâ”€â”€ å®¹é”™å¿ƒæ€ â””â”€â”€ é€æ˜æ²Ÿé€š A - Automation (è‡ªåŠ¨åŒ–) â”œâ”€â”€ æ„å»ºè‡ªåŠ¨åŒ– â”œâ”€â”€ æµ‹è¯•è‡ªåŠ¨åŒ– â”œâ”€â”€ éƒ¨ç½²è‡ªåŠ¨åŒ– â””â”€â”€ ç›‘æ§è‡ªåŠ¨åŒ– L - Lean (ç²¾ç›Š) â”œâ”€â”€ æ¶ˆé™¤æµªè´¹ â”œâ”€â”€ æŒç»­äº¤ä»˜ â”œâ”€â”€ å¿«é€Ÿåé¦ˆ â””â”€â”€ ä»·å€¼æµä¼˜åŒ– M - Measurement (åº¦é‡) â”œâ”€â”€ å…³é”®æŒ‡æ ‡è¿½è¸ª â”œâ”€â”€ æ•°æ®é©±åŠ¨å†³ç­– â”œâ”€â”€ æŒç»­ç›‘æ§ â””â”€â”€ æ•ˆæœè¯„ä¼° S - Sharing (åˆ†äº«) â”œâ”€â”€ çŸ¥è¯†å…±äº« â”œâ”€â”€ æœ€ä½³å®è·µä¼ æ’­ â”œâ”€â”€ å·¥å…·å…±äº« â””â”€â”€ ç»éªŒæ€»ç»“ """ # DevOpsæˆç†Ÿåº¦è¯„ä¼°æ¨¡å‹ DEVOPS_MATURITY_LEVELS = { "Level 1 - åˆå§‹çº§": { "characteristics": [ "æ‰‹åŠ¨æ“ä½œä¸ºä¸»", "ç¼ºä¹æ ‡å‡†åŒ–æµç¨‹", "å¼€å‘å’Œè¿ç»´åˆ†ç¦»" ], "practices": [], "improvements": [ "å»ºç«‹åŸºç¡€è‡ªåŠ¨åŒ–æµç¨‹", "åˆ¶å®šæ ‡å‡†åŒ–è§„èŒƒ" ] }, "Level 2 - å¯é‡å¤çº§": { "characteristics": [ "æœ‰åŸºæœ¬çš„CIæµç¨‹", "ç¯å¢ƒé…ç½®åˆæ­¥æ ‡å‡†åŒ–", "æ–‡æ¡£åŒ–æµç¨‹" ], "practices": [ "ç‰ˆæœ¬æ§åˆ¶", "å•å…ƒæµ‹è¯•", "åŸºç¡€è‡ªåŠ¨åŒ–æ„å»º" ], "improvements": [ "æ‰©å±•è‡ªåŠ¨åŒ–èŒƒå›´", "å¢åŠ æµ‹è¯•è¦†ç›–ç‡" ] }, "Level 3 - å·²å®šä¹‰çº§": { "characteristics": [ "å®Œæ•´çš„CI/CDæµæ°´çº¿", "åŸºç¡€è®¾æ–½å³ä»£ç ", "è‡ªåŠ¨åŒ–æµ‹è¯•ä½“ç³»" ], "practices": [ "æŒç»­é›†æˆ", "æŒç»­éƒ¨ç½²", "è‡ªåŠ¨åŒ–æµ‹è¯•", "é…ç½®ç®¡ç†" ], "improvements": [ "ä¼˜åŒ–éƒ¨ç½²æµç¨‹", "å¢å¼ºç›‘æ§èƒ½åŠ›" ] }, "Level 4 - å¯ç®¡ç†çº§": { "characteristics": [ "å…¨é“¾è·¯è‡ªåŠ¨åŒ–", "å®Œå–„çš„ç›‘æ§ä½“ç³»", "å¿«é€Ÿæ•…éšœæ¢å¤" ], "practices": [ "è‡ªåŠ¨åŒ–è¿ç»´", "ç›‘æ§å‘Šè­¦", "æ•…éšœè‡ªæ„ˆ", "æ€§èƒ½ä¼˜åŒ–" ], "improvements": [ "æŒç»­ä¼˜åŒ–", "æˆæœ¬æ§åˆ¶" ] }, "Level 5 - ä¼˜åŒ–çº§": { "characteristics": [ "æ™ºèƒ½è¿ç»´", "é¢„æµ‹æ€§ç»´æŠ¤", "æŒç»­åˆ›æ–°" ], "practices": [ "AIè¾…åŠ©å†³ç­–", "æ··æ²Œå·¥ç¨‹", "è‡ªåŠ¨åŒ–ä¼˜åŒ–" ], "improvements": [ "æŒç»­æ¼”è¿›" ] } } 1.2 DevOpsæŒ‡æ ‡ä½“ç³» 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 # ========== DORAæŒ‡æ ‡ ========== class DORAMetrics: """DORA (DevOps Research and Assessment) æ ¸å¿ƒæŒ‡æ ‡""" @staticmethod def deployment_frequency(deployments: int, days: int) -> float: """ éƒ¨ç½²é¢‘ç‡ - ç²¾è‹±çº§ï¼šæŒ‰éœ€éƒ¨ç½² (æ¯å¤©å¤šæ¬¡) - é«˜ç»©æ•ˆï¼šæ¯å‘¨1-6ä¸ªæœˆ - ä¸­ç­‰ç»©æ•ˆï¼šæ¯æœˆ1-6ä¸ªæœˆ - ä½ç»©æ•ˆï¼šå°‘äºæ¯6ä¸ªæœˆ1æ¬¡ """ return deployments / days @staticmethod def lead_time_for_changes(commit_time: str, deploy_time: str) -> float: """ å˜æ›´å‰ç½®æ—¶é—´ ä»ä»£ç æäº¤åˆ°æˆåŠŸéƒ¨ç½²çš„æ—¶é—´ - ç²¾è‹±çº§ï¼šå°äº1å°æ—¶ - é«˜ç»©æ•ˆï¼šå°äº1å¤© - ä¸­ç­‰ç»©æ•ˆï¼š1å‘¨-1ä¸ªæœˆ - ä½ç»©æ•ˆï¼šè¶…è¿‡1ä¸ªæœˆ """ from datetime import datetime commit = datetime.fromisoformat(commit_time) deploy = datetime.fromisoformat(deploy_time) return (deploy - commit).total_seconds() / 3600 # å°æ—¶ @staticmethod def time_to_restore_service(incident_time: str, restore_time: str) -> float: """ æœåŠ¡æ¢å¤æ—¶é—´ - ç²¾è‹±çº§ï¼šå°äº1å°æ—¶ - é«˜ç»©æ•ˆï¼šå°äº1å¤© - ä¸­ç­‰ç»©æ•ˆï¼š1å¤©-1å‘¨ - ä½ç»©æ•ˆï¼šè¶…è¿‡1å‘¨ """ from datetime import datetime incident = datetime.fromisoformat(incident_time) restore = datetime.fromisoformat(restore_time) return (restore - incident).total_seconds() / 3600 # å°æ—¶ @staticmethod def change_failure_rate(total_deployments: int, failed_deployments: int) -> float: """ å˜æ›´å¤±è´¥ç‡ - ç²¾è‹±çº§ï¼š0-15% - é«˜ç»©æ•ˆï¼š15-30% - ä¸­ç­‰ç»©æ•ˆï¼š30-60% - ä½ç»©æ•ˆï¼šè¶…è¿‡60% """ return (failed_deployments / total_deployments) * 100 @classmethod def evaluate_performance(cls, metrics: dict) -> str: """è¯„ä¼°å›¢é˜ŸDevOpsç»©æ•ˆç­‰çº§""" score = 0 if metrics['deployment_frequency'] >= 1: # æ¯å¤©è‡³å°‘1æ¬¡ score += 1 if metrics['lead_time'] &lt;= 1: # å°äº1å°æ—¶ score += 1 if metrics['restore_time'] &lt;= 1: # å°äº1å°æ—¶ score += 1 if metrics['failure_rate'] &lt;= 15: # å°äº15% score += 1 levels = { 4: "ç²¾è‹±çº§", 3: "é«˜ç»©æ•ˆ", 2: "ä¸­ç­‰ç»©æ•ˆ", 1: "ä½ç»©æ•ˆ", 0: "ä½ç»©æ•ˆ" } return levels[score] # ========== è‡ªå®šä¹‰DevOpsæŒ‡æ ‡ ========== class DevOpsMetricsCollector: """DevOpsæŒ‡æ ‡æ”¶é›†å™¨""" def __init__(self): self.metrics = { 'builds': [], 'deployments': [], 'incidents': [], 'tests': [] } def record_build(self, build_info: dict): """è®°å½•æ„å»ºä¿¡æ¯""" self.metrics['builds'].append({ 'timestamp': build_info['timestamp'], 'branch': build_info['branch'], 'commit': build_info['commit'], 'status': build_info['status'], 'duration': build_info['duration'], 'triggered_by': build_info['triggered_by'] }) def record_deployment(self, deployment_info: dict): """è®°å½•éƒ¨ç½²ä¿¡æ¯""" self.metrics['deployments'].append({ 'timestamp': deployment_info['timestamp'], 'environment': deployment_info['environment'], 'version': deployment_info['version'], 'status': deployment_info['status'], 'duration': deployment_info['duration'], 'deployed_by': deployment_info['deployed_by'] }) def record_incident(self, incident_info: dict): """è®°å½•æ•…éšœä¿¡æ¯""" self.metrics['incidents'].append({ 'detected_at': incident_info['detected_at'], 'resolved_at': incident_info.get('resolved_at'), 'severity': incident_info['severity'], 'affected_services': incident_info['affected_services'], 'root_cause': incident_info.get('root_cause') }) def calculate_metrics(self, days: int = 30) -> dict: """è®¡ç®—DevOpsæŒ‡æ ‡""" from datetime import datetime, timedelta cutoff_time = datetime.now() - timedelta(days=days) # ç­›é€‰æ—¶é—´èŒƒå›´å†…çš„æ•°æ® recent_builds = [ b for b in self.metrics['builds'] if datetime.fromisoformat(b['timestamp']) > cutoff_time ] recent_deployments = [ d for d in self.metrics['deployments'] if datetime.fromisoformat(d['timestamp']) > cutoff_time ] recent_incidents = [ i for i in self.metrics['incidents'] if datetime.fromisoformat(i['detected_at']) > cutoff_time ] # è®¡ç®—æŒ‡æ ‡ total_builds = len(recent_builds) successful_builds = len([b for b in recent_builds if b['status'] == 'success']) build_success_rate = (successful_builds / total_builds * 100) if total_builds > 0 else 0 total_deployments = len(recent_deployments) successful_deployments = len([d for d in recent_deployments if d['status'] == 'success']) deployment_success_rate = (successful_deployments / total_deployments * 100) if total_deployments > 0 else 0 deployment_frequency = total_deployments / days total_incidents = len(recent_incidents) resolved_incidents = len([i for i in recent_incidents if i.get('resolved_at')]) avg_resolution_time = 0 if resolved_incidents > 0: resolution_times = [] for incident in recent_incidents: if incident.get('resolved_at'): detected = datetime.fromisoformat(incident['detected_at']) resolved = datetime.fromisoformat(incident['resolved_at']) resolution_times.append((resolved - detected).total_seconds() / 3600) avg_resolution_time = sum(resolution_times) / len(resolution_times) return { 'build_metrics': { 'total_builds': total_builds, 'success_rate': round(build_success_rate, 2), 'avg_duration': round( sum(b['duration'] for b in recent_builds) / total_builds if total_builds > 0 else 0, 2 ) }, 'deployment_metrics': { 'total_deployments': total_deployments, 'success_rate': round(deployment_success_rate, 2), 'frequency_per_day': round(deployment_frequency, 2) }, 'incident_metrics': { 'total_incidents': total_incidents, 'resolved_incidents': resolved_incidents, 'avg_resolution_time_hours': round(avg_resolution_time, 2) } } äºŒã€æŒç»­é›†æˆ(CI)å®è·µ 2.1 Gitå·¥ä½œæµ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 # ========== Gitå·¥ä½œæµæ¨¡å‹ ========== class GitWorkflow: """Gitå·¥ä½œæµç®¡ç†""" BRANCH_STRATEGIES = { "Git Flow": { "branches": { "main": "ç”Ÿäº§åˆ†æ”¯ï¼Œåªæ¥å—æ¥è‡ªreleaseçš„åˆå¹¶", "develop": "å¼€å‘ä¸»åˆ†æ”¯", "feature": "åŠŸèƒ½å¼€å‘åˆ†æ”¯ï¼Œä»developåˆ›å»º", "release": "å‘å¸ƒå‡†å¤‡åˆ†æ”¯ï¼Œä»developåˆ›å»º", "hotfix": "ç´§æ€¥ä¿®å¤åˆ†æ”¯ï¼Œä»mainåˆ›å»º" }, "workflow": """ 1. ä»developåˆ›å»ºfeatureåˆ†æ”¯ 2. å®Œæˆå¼€å‘ååˆå¹¶å›develop 3. å‡†å¤‡å‘å¸ƒæ—¶åˆ›å»ºreleaseåˆ†æ”¯ 4. æµ‹è¯•é€šè¿‡ååˆå¹¶åˆ°mainå’Œdevelop 5. ç´§æ€¥ä¿®å¤ä»mainåˆ›å»ºhotfixåˆ†æ”¯ 6. ä¿®å¤ååˆå¹¶åˆ°mainå’Œdevelop """ }, "GitHub Flow": { "branches": { "main": "å§‹ç»ˆå¯éƒ¨ç½²çš„ç”Ÿäº§åˆ†æ”¯", "feature": "åŠŸèƒ½åˆ†æ”¯ï¼Œä»mainåˆ›å»º" }, "workflow": """ 1. ä»mainåˆ›å»ºfeatureåˆ†æ”¯ 2. æäº¤å¹¶æ¨é€åˆ°è¿œç¨‹ 3. åˆ›å»ºPull Request 4. Code Reviewå’Œè®¨è®º 5. åˆå¹¶åˆ°main 6. ç«‹å³éƒ¨ç½² """ }, "GitLab Flow": { "branches": { "main": "ä¸»åˆ†æ”¯", "feature": "åŠŸèƒ½åˆ†æ”¯", "environment": "ç¯å¢ƒåˆ†æ”¯ï¼ˆstaging, productionï¼‰" }, "workflow": """ 1. ä»mainåˆ›å»ºfeatureåˆ†æ”¯ 2. å®Œæˆååˆå¹¶å›main 3. mainåˆ†æ”¯è§¦å‘CI/CD 4. é€šè¿‡æµ‹è¯•åéƒ¨ç½²åˆ°staging 5. äººå·¥éªŒè¯åéƒ¨ç½²åˆ°production """ }, "Trunk Based Development": { "branches": { "trunk/main": "ä¸»åˆ†æ”¯ï¼Œæ‰€æœ‰å¼€å‘åœ¨æ­¤è¿›è¡Œ" }, "workflow": """ 1. å¼€å‘è€…ç›´æ¥åœ¨ä¸»åˆ†æ”¯æäº¤ 2. ä½¿ç”¨Feature Flagsæ§åˆ¶åŠŸèƒ½å‘å¸ƒ 3. é¢‘ç¹é›†æˆåˆ°ä¸»åˆ†æ”¯ 4. æŒç»­éƒ¨ç½² """ } } class BranchProtectionRules: """åˆ†æ”¯ä¿æŠ¤è§„åˆ™""" def __init__(self): self.rules = {} def add_protection(self, branch: str, rules: dict): """æ·»åŠ åˆ†æ”¯ä¿æŠ¤è§„åˆ™""" self.rules[branch] = { 'require_pull_request': rules.get('require_pull_request', True), 'require_approvals': rules.get('require_approvals', 1), 'dismiss_stale_reviews': rules.get('dismiss_stale_reviews', True), 'require_status_checks': rules.get('require_status_checks', True), 'required_status_checks': rules.get('required_status_checks', []), 'require_linear_history': rules.get('require_linear_history', True), 'allow_force_pushes': rules.get('allow_force_pushes', False), 'allow_deletions': rules.get('allow_deletions', False) } def check_protection(self, branch: str) -> dict: """æ£€æŸ¥åˆ†æ”¯ä¿æŠ¤çŠ¶æ€""" return self.rules.get(branch, {}) 2.2 CIæµæ°´çº¿é…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 # ========== Jenkins Pipeline ========== # Jenkinsfile pipeline { agent any tools { maven 'Maven 3.8' jdk 'JDK 11' } environment { APP_NAME = 'my-application' VERSION = "${env.BUILD_ID}" REGISTRY = 'registry.example.com' IMAGE_NAME = "${REGISTRY}/${APP_NAME}:${VERSION}" } stages { stage('Checkout') { steps { checkout scm } } stage('Setup') { steps { sh ''' echo "Setting up build environment..." python3 -m venv venv . venv/bin/activate pip install -r requirements.txt ''' } } stage('Code Quality') { parallel { stage('Lint') { steps { sh ''' . venv/bin/activate flake8 src/ --max-line-length=120 ''' } } stage('Security Scan') { steps { sh ''' . venv/bin/activate bandit -r src/ ''' } } } } stage('Unit Tests') { steps { sh ''' . venv/bin/activate pytest tests/unit/ --cov=src --cov-report=xml --cov-report=html ''' } post { always { junit 'test-results/*.xml' publishHTML([ allowMissing: false, alwaysLinkToLastBuild: true, keepAll: true, reportDir: 'htmlcov', reportFiles: 'index.html', reportName: 'Coverage Report' ]) } } } stage('Integration Tests') { steps { sh ''' docker-compose -f docker-compose.test.yml up -d sleep 10 . venv/bin/activate pytest tests/integration/ docker-compose -f docker-compose.test.yml down ''' } } stage('Build') { steps { sh ''' . venv/bin/activate python setup.py sdist bdist_wheel ''' } } stage('Docker Build') { steps { script { docker.build(image: IMAGE_NAME) } } } stage('Security Scan Image') { steps { sh ''' trivy image ${IMAGE_NAME} --severity HIGH,CRITICAL ''' } } stage('Push to Registry') { when { branch 'main' } steps { script { docker.withRegistry("https://${REGISTRY}", 'docker-registry-credentials') { docker.image(IMAGE_NAME).push() docker.image(IMAGE_NAME).push('latest') } } } } stage('Deploy to Staging') { when { branch 'main' } steps { sh ''' kubectl set image deployment/${APP_NAME} \ ${APP_NAME}=${IMAGE_NAME} \ --namespace=staging kubectl rollout status deployment/${APP_NAME} \ --namespace=staging ''' } } stage('Smoke Tests') { when { branch 'main' } steps { sh ''' . venv/bin/activate pytest tests/smoke/ --base-url=https://staging.example.com ''' } } stage('Deploy to Production') { when { branch 'main' approval { input 'Deploy to Production?' } } steps { sh ''' kubectl set image deployment/${APP_NAME} \ ${APP_NAME}=${IMAGE_NAME} \ --namespace=production kubectl rollout status deployment/${APP_NAME} \ --namespace=production ''' } } } post { success { echo "Pipeline succeeded!" cleanWs() } failure { echo "Pipeline failed!" mail to: 'team@example.com', subject: "Build Failed: ${env.JOB_NAME} #${env.BUILD_NUMBER}", body: "Check console output at ${env.BUILD_URL}" } always { sh ''' docker system prune -f ''' } } } # ========== GitHub Actions Workflow ========== # .github/workflows/ci-cd.yml name: CI/CD Pipeline on: push: branches: [main, develop] pull_request: branches: [main, develop] env: REGISTRY: ghcr.io IMAGE_NAME: ${{ github.repository }} jobs: lint: name: Lint runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Set up Python uses: actions/setup-python@v4 with: python-version: '3.9' cache: 'pip' - name: Install dependencies run: | python -m pip install --upgrade pip pip install flake8 black isort - name: Run flake8 run: | flake8 src/ tests/ --count --select=E9,F63,F7,F82 --show-source --statistics - name: Check code formatting run: | black --check src/ tests/ - name: Check import ordering run: | isort --check-only src/ tests/ test: name: Test runs-on: ubuntu-latest strategy: matrix: python-version: ['3.8', '3.9', '3.10', '3.11'] steps: - uses: actions/checkout@v3 - name: Set up Python ${{ matrix.python-version }} uses: actions/setup-python@v4 with: python-version: ${{ matrix.python-version }} cache: 'pip' - name: Install dependencies run: | python -m pip install --upgrade pip pip install -r requirements.txt pip install -r requirements-dev.txt - name: Run tests run: | pytest tests/ --cov=src --cov-report=xml --cov-report=html - name: Upload coverage uses: codecov/codecov-action@v3 with: file: ./coverage.xml flags: unittests name: codecov-umbrella security: name: Security Scan runs-on: ubuntu-latest steps: - uses: actions/checkout@v3 - name: Run Bandit run: | pip install bandit[toml] bandit -r src/ - name: Run Safety run: | pip install safety safety check --file requirements.txt - name: Run Trivy uses: aquasecurity/trivy-action@master with: scan-type: 'fs' scan-ref: '.' format: 'sarif' output: 'trivy-results.sarif' - name: Upload Trivy results uses: github/codeql-action/upload-sarif@v2 with: sarif_file: 'trivy-results.sarif' build: name: Build Docker Image runs-on: ubuntu-latest needs: [lint, test, security] if: github.event_name == 'push' && github.ref == 'refs/heads/main' permissions: contents: read packages: write steps: - uses: actions/checkout@v3 - name: Set up Docker Buildx uses: docker/setup-buildx-action@v2 - name: Log in to Container Registry uses: docker/login-action@v2 with: registry: ${{ env.REGISTRY }} username: ${{ github.actor }} password: ${{ secrets.GITHUB_TOKEN }} - name: Extract metadata id: meta uses: docker/metadata-action@v4 with: images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }} tags: | type=ref,event=branch type=semver,pattern={{version}} type=semver,pattern={{major}}.{{minor}} type=sha,prefix={{branch}}- - name: Build and push uses: docker/build-push-action@v4 with: context: . push: true tags: ${{ steps.meta.outputs.tags }} labels: ${{ steps.meta.outputs.labels }} cache-from: type=gha cache-to: type=gha,mode=max deploy: name: Deploy runs-on: ubuntu-latest needs: build if: github.event_name == 'push' && github.ref == 'refs/heads/main' environment: name: production url: https://example.com steps: - uses: actions/checkout@v3 - name: Configure AWS credentials uses: aws-actions/configure-aws-credentials@v2 with: aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }} aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }} aws-region: us-east-1 - name: Update kubeconfig run: | aws eks update-kubeconfig --name production-cluster --region us-east-1 - name: Deploy to Kubernetes run: | kubectl set image deployment/app \ app=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.sha }} \ --namespace=production - name: Verify deployment run: | kubectl rollout status deployment/app --namespace=production 2.3 æµ‹è¯•è‡ªåŠ¨åŒ–ç­–ç•¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 # ========== æµ‹è¯•é‡‘å­—å¡” ========== class TestAutomationStrategy: """æµ‹è¯•è‡ªåŠ¨åŒ–ç­–ç•¥""" TEST_PYRAMID = { "Unit Tests (70%)": { "scope": "å•ä¸ªå‡½æ•°/ç±»", "speed": "æ¯«ç§’çº§", "cost": "ä½", "isolation": "å®Œå…¨éš”ç¦»", "examples": [ "å‡½æ•°è¿”å›å€¼éªŒè¯", "è¾¹ç•Œæ¡ä»¶æµ‹è¯•", "å¼‚å¸¸å¤„ç†æµ‹è¯•" ] }, "Integration Tests (20%)": { "scope": "å¤šä¸ªç»„ä»¶åä½œ", "speed": "ç§’çº§", "cost": "ä¸­", "isolation": "éƒ¨åˆ†éš”ç¦»", "examples": [ "APIé›†æˆæµ‹è¯•", "æ•°æ®åº“é›†æˆæµ‹è¯•", "æœåŠ¡é—´é€šä¿¡æµ‹è¯•" ] }, "E2E Tests (10%)": { "scope": "å®Œæ•´ç”¨æˆ·æµç¨‹", "speed": "åˆ†é’Ÿçº§", "cost": "é«˜", "isolation": "æ— éš”ç¦»", "examples": [ "ç”¨æˆ·æ³¨å†Œæµç¨‹", "è´­ç‰©è½¦å®Œæ•´æµç¨‹", "æ”¯ä»˜å®Œæ•´æµç¨‹" ] } } class AutomatedTestSuite: """è‡ªåŠ¨åŒ–æµ‹è¯•å¥—ä»¶""" def __init__(self): self.unit_tests = [] self.integration_tests = [] self.e2e_tests = [] def add_unit_test(self, test_func): """æ·»åŠ å•å…ƒæµ‹è¯•""" self.unit_tests.append(test_func) def add_integration_test(self, test_func): """æ·»åŠ é›†æˆæµ‹è¯•""" self.integration_tests.append(test_func) def add_e2e_test(self, test_func): """æ·»åŠ E2Eæµ‹è¯•""" self.e2e_tests.append(test_func) def run_all_tests(self): """è¿è¡Œæ‰€æœ‰æµ‹è¯•""" results = { 'unit': self._run_tests(self.unit_tests), 'integration': self._run_tests(self.integration_tests), 'e2e': self._run_tests(self.e2e_tests) } return results def _run_tests(self, tests): """è¿è¡Œæµ‹è¯•""" passed = 0 failed = 0 for test in tests: try: test() passed += 1 except AssertionError as e: failed += 1 print(f"Test failed: {e}") return { 'total': len(tests), 'passed': passed, 'failed': failed } # ========== æµ‹è¯•é©±åŠ¨å¼€å‘(TDD)å·¥ä½œæµ ========== class TDDWorkflow: """TDDå·¥ä½œæµ""" @staticmethod def red_green_refactor(feature_name: str): """ Red-Green-Refactorå¾ªç¯ Red: ç¼–å†™å¤±è´¥çš„æµ‹è¯• Green: ç¼–å†™æœ€å°‘ä»£ç ä½¿æµ‹è¯•é€šè¿‡ Refactor: é‡æ„ä»£ç  """ print(f"\n=== TDD Workflow for {feature_name} ===") # Red: ç¼–å†™æµ‹è¯• print("\n[RED] Writing failing test...") test_code = f""" def test_{feature_name}(): result = {feature_name}() assert result is not None """ print(test_code) # Green: å®ç°åŠŸèƒ½ print("\n[GREEN] Implementing minimum code to pass...") impl_code = f""" def {feature_name}(): return True """ print(impl_code) # Refactor: é‡æ„ print("\n[REFACTOR] Improving code quality...") print("Optimizing implementation...") return True # ========== è¡Œä¸ºé©±åŠ¨å¼€å‘(BDD) ========== class BDDScenario: """BDDåœºæ™¯å®šä¹‰""" def __init__(self, name: str): self.name = name self.given_steps = [] self.when_steps = [] self.then_steps = [] def given(self, description: str, action=None): """Givenæ­¥éª¤""" self.given_steps.append({ 'description': description, 'action': action }) return self def when(self, description: str, action=None): """Whenæ­¥éª¤""" self.when_steps.append({ 'description': description, 'action': action }) return self def then(self, description: str, assertion=None): """Thenæ­¥éª¤""" self.then_steps.append({ 'description': description, 'assertion': assertion }) return self def execute(self): """æ‰§è¡Œåœºæ™¯""" print(f"\nScenario: {self.name}") # æ‰§è¡ŒGivenæ­¥éª¤ print("\nGiven:") context = {} for step in self.given_steps: print(f" {step['description']}") if step['action']: context.update(step['action'](context) or {}) # æ‰§è¡ŒWhenæ­¥éª¤ print("\nWhen:") for step in self.when_steps: print(f" {step['description']}") if step['action']: context.update(step['action'](context) or {}) # æ‰§è¡ŒThenæ­¥éª¤ print("\nThen:") for step in self.then_steps: print(f" {step['description']}") if step['assertion']: step['assertion'](context) return context # ä½¿ç”¨ç¤ºä¾‹ def user_login_scenario(): """ç”¨æˆ·ç™»å½•åœºæ™¯""" scenario = BDDScenario("User successfully logs in") scenario.given("a registered user with email 'user@example.com' and password 'password123'") .when("the user submits valid credentials") .then("the user should be authenticated") .then("the user should receive an authentication token") # å®é™…æ‰§è¡Œæ—¶ä¼šå®ç°å…·ä½“çš„actionå’Œassertion return scenario ä¸‰ã€æŒç»­éƒ¨ç½²(CD)å®è·µ 3.1 éƒ¨ç½²ç­–ç•¥ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 # ========== éƒ¨ç½²ç­–ç•¥ ========== class DeploymentStrategy: """éƒ¨ç½²ç­–ç•¥""" @staticmethod def rolling_update(deployment_config: dict): """ æ»šåŠ¨æ›´æ–° é€æ­¥æ›¿æ¢æ—§å®ä¾‹ï¼Œç¡®ä¿æœåŠ¡å§‹ç»ˆå¯ç”¨ """ total_replicas = deployment_config['replicas'] max_unavailable = deployment_config.get('max_unavailable', 1) max_surge = deployment_config.get('max_surge', 1) print(f"Starting rolling update...") print(f"Total replicas: {total_replicas}") print(f"Max unavailable: {max_unavailable}") print(f"Max surge: {max_surge}") for i in range(total_replicas): print(f"Updating replica {i+1}/{total_replicas}...") # éƒ¨ç½²æ–°å®ä¾‹ # ç­‰å¾…å¥åº·æ£€æŸ¥é€šè¿‡ # ç»ˆæ­¢æ—§å®ä¾‹ print("Rolling update completed!") @staticmethod def blue_green_deployment(deployment_config: dict): """ è“ç»¿éƒ¨ç½² å¹¶è¡Œç»´æŠ¤ä¸¤å¥—ç¯å¢ƒï¼Œé€šè¿‡åˆ‡æ¢æµé‡å®ç°é›¶åœæœºéƒ¨ç½² """ print("Starting blue-green deployment...") # å½“å‰ç¯å¢ƒ current_env = deployment_config['current_environment'] # 'blue' or 'green' # ç›®æ ‡ç¯å¢ƒ target_env = 'green' if current_env == 'blue' else 'blue' print(f"Current environment: {current_env}") print(f"Target environment: {target_env}") # 1. åœ¨ç›®æ ‡ç¯å¢ƒéƒ¨ç½²æ–°ç‰ˆæœ¬ print(f"\n1. Deploying new version to {target_env} environment...") # éƒ¨ç½²åˆ°ç›®æ ‡ç¯å¢ƒ # 2. ç­‰å¾…ç›®æ ‡ç¯å¢ƒå¥åº·æ£€æŸ¥ print(f"\n2. Waiting for {target_env} to be healthy...") # å¥åº·æ£€æŸ¥ # 3. åˆ‡æ¢æµé‡ print(f"\n3. Switching traffic from {current_env} to {target_env}...") # åˆ‡æ¢è´Ÿè½½å‡è¡¡å™¨ # 4. éªŒè¯æ–°ç‰ˆæœ¬ print(f"\n4. Validating {target_env}...") # è¿è¡ŒçƒŸé›¾æµ‹è¯• # 5. ä¿ç•™æ—§ç¯å¢ƒï¼ˆå¯é€‰å›æ»šï¼‰ print(f"\n5. Keeping {current_env} as rollback option...") print("Blue-green deployment completed!") @staticmethod def canary_deployment(deployment_config: dict): """ é‡‘ä¸é›€éƒ¨ç½² é€æ­¥å°†æµé‡å¼•å¯¼åˆ°æ–°ç‰ˆæœ¬ï¼Œç›‘æ§é—®é¢˜å¹¶å¿«é€Ÿå›æ»š """ print("Starting canary deployment...") canary_steps = deployment_config.get('canary_steps', [ {'percentage': 5, 'duration': 300}, # 5% æµé‡ï¼Œ5åˆ†é’Ÿ {'percentage': 25, 'duration': 600}, # 25% æµé‡ï¼Œ10åˆ†é’Ÿ {'percentage': 50, 'duration': 600}, # 50% æµé‡ï¼Œ10åˆ†é’Ÿ {'percentage': 100, 'duration': 0} # 100% æµé‡ ]) for step in canary_steps: percentage = step['percentage'] duration = step['duration'] print(f"\nRouting {percentage}% of traffic to canary...") # è°ƒæ•´æµé‡åˆ†é… # ç›‘æ§å…³é”®æŒ‡æ ‡ # å¦‚æœæ£€æµ‹åˆ°é—®é¢˜ï¼Œç«‹å³å›æ»š if duration > 0: print(f"Monitoring for {duration} seconds...") # ç­‰å¾…å¹¶ç›‘æ§ print("\nAll traffic routed to new version!") print("Canary deployment completed!") @staticmethod def a_b_testing_deployment(deployment_config: dict): """ A/Bæµ‹è¯•éƒ¨ç½² åŒæ—¶è¿è¡Œå¤šä¸ªç‰ˆæœ¬ï¼ŒæŒ‰ç‰¹å®šè§„åˆ™åˆ†é…æµé‡ """ print("Starting A/B testing deployment...") variants = deployment_config['variants'] # [{'name': 'A', 'percentage': 50}, ...] total_percentage = sum(v['percentage'] for v in variants) if total_percentage != 100: raise ValueError(f"Total percentage must be 100%, got {total_percentage}%") print("Traffic allocation:") for variant in variants: print(f" {variant['name']}: {variant['percentage']}%") # é…ç½®æµé‡åˆ†é…è§„åˆ™ # è®¾ç½®æŒ‡æ ‡æ”¶é›† # é…ç½®è‡ªåŠ¨å›æ»šè§„åˆ™ print("A/B testing deployment completed!") # ========== éƒ¨ç½²å›æ»š ========== class DeploymentRollback: """éƒ¨ç½²å›æ»š""" def __init__(self, deployment_manager): self.deployment_manager = deployment_manager self.rollback_history = [] def execute_rollback(self, target_version: str, reason: str): """æ‰§è¡Œå›æ»š""" print(f"\nInitiating rollback to version {target_version}") print(f"Reason: {reason}") # 1. è®°å½•å›æ»š rollback_record = { 'timestamp': datetime.now().isoformat(), 'from_version': self.deployment_manager.get_current_version(), 'to_version': target_version, 'reason': reason } self.rollback_history.append(rollback_record) # 2. æ‰§è¡Œå›æ»š try: # åœæ­¢å½“å‰ç‰ˆæœ¬ print("Stopping current version...") # éƒ¨ç½²ç›®æ ‡ç‰ˆæœ¬ print(f"Deploying version {target_version}...") # éªŒè¯å›æ»š print("Verifying rollback...") print(f"Rollback to version {target_version} completed successfully!") except Exception as e: print(f"Rollback failed: {e}") raise def get_rollback_history(self): """è·å–å›æ»šå†å²""" return self.rollback_history 3.2 GitOpså®è·µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 # ========== GitOps with ArgoCD ========== # åº”ç”¨éƒ¨ç½²æ¸…å• # apps/application.yaml apiVersion: argoproj.io/v1alpha1 kind: Application metadata: name: my-application namespace: argocd spec: project: default source: repoURL: https://github.com/org/infrastructure.git targetRevision: main path: apps/my-application helm: valueFiles: - values-prod.yaml destination: server: https://kubernetes.default.svc namespace: production syncPolicy: automated: prune: true selfHeal: true syncOptions: - CreateNamespace=true # Kuberneteséƒ¨ç½²æ¸…å• # apps/my-application/deployment.yaml apiVersion: apps/v1 kind: Deployment metadata: name: my-application labels: app: my-application spec: replicas: 3 selector: matchLabels: app: my-application template: metadata: labels: app: my-application spec: containers: - name: app image: registry.example.com/my-application:{{ .Values.image.tag }} ports: - containerPort: 8080 resources: requests: memory: "128Mi" cpu: "100m" limits: memory: "256Mi" cpu: "200m" livenessProbe: httpGet: path: /health port: 8080 initialDelaySeconds: 30 periodSeconds: 10 readinessProbe: httpGet: path: /ready port: 8080 initialDelaySeconds: 5 periodSeconds: 5 --- apiVersion: v1 kind: Service metadata: name: my-application spec: selector: app: my-application ports: - port: 80 targetPort: 8080 type: ClusterIP --- apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: my-application annotations: cert-manager.io/cluster-issuer: letsencrypt-prod nginx.ingress.kubernetes.io/ssl-redirect: "true" spec: ingressClassName: nginx tls: - hosts: - app.example.com secretName: my-application-tls rules: - host: app.example.com http: paths: - path: / pathType: Prefix backend: service: name: my-application port: number: 80 # Helm Values # apps/my-application/values-prod.yaml image: tag: "1.2.3" replicas: 3 resources: requests: memory: "256Mi" cpu: "200m" limits: memory: "512Mi" cpu: "500m" autoscaling: enabled: true minReplicas: 3 maxReplicas: 10 targetCPUUtilizationPercentage: 70 targetMemoryUtilizationPercentage: 80 database: host: postgres-production.example.com port: 5432 name: app_production sslMode: require å››ã€åŸºç¡€è®¾æ–½å³ä»£ç (IaC) 4.1 Terraformé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 # ========== Terraformé…ç½®ç¤ºä¾‹ ========== # ä¸»é…ç½®æ–‡ä»¶ # main.tf terraform { required_version = ">= 1.0" required_providers { aws = { source = "hashicorp/aws" version = "~> 5.0" } } backend "s3" { bucket = "terraform-state-prod" key = "production/terraform.tfstate" region = "us-east-1" encrypt = true dynamodb_table = "terraform-locks" } } provider "aws" { region = var.aws_region default_tags { tags = { Environment = var.environment Project = var.project_name ManagedBy = "Terraform" } } } # VPCé…ç½® # modules/vpc/main.tf resource "aws_vpc" "main" { cidr_block = var.vpc_cidr enable_dns_hostnames = true enable_dns_support = true tags = { Name = "${var.project_name}-vpc" } } resource "aws_internet_gateway" "main" { vpc_id = aws_vpc.main.id tags = { Name = "${var.project_name}-igw" } } resource "aws_subnet" "public" { count = length(var.availability_zones) vpc_id = aws_vpc.main.id cidr_block = cidrsubnet(var.vpc_cidr, 8, count.index) availability_zone = var.availability_zones[count.index] map_public_ip_on_launch = true tags = { Name = "${var.project_name}-public-${count.index}" Type = "Public" } } resource "aws_subnet" "private" { count = length(var.availability_zones) vpc_id = aws_vpc.main.id cidr_block = cidrsubnet(var.vpc_cidr, 8, count.index + length(var.availability_zones)) availability_zone = var.availability_zones[count.index] tags = { Name = "${var.project_name}-private-${count.index}" Type = "Private" } } resource "aws_eip" "nat" { count = length(var.availability_zones) domain = "vpc" tags = { Name = "${var.project_name}-nat-${count.index}" } depends_on = [aws_internet_gateway.main] } resource "aws_nat_gateway" "main" { count = length(var.availability_zones) allocation_id = aws_eip.nat[count.index].id subnet_id = aws_subnet.public[count.index].id tags = { Name = "${var.project_name}-nat-${count.index}" } depends_on = [aws_internet_gateway.main] } # EKSé›†ç¾¤é…ç½® # modules/eks/main.tf resource "aws_eks_cluster" "main" { name = "${var.project_name}-cluster" role_arn = aws_iam_role.cluster.arn version = var.kubernetes_version vpc_config { subnet_ids = concat( aws_subnet.private[*].id, aws_subnet.public[*].id ) endpoint_private_access = true endpoint_public_access = true public_access_cidrs = var.allowed_public_access_cidrs } enabled_cluster_log_types = var.cluster_log_types depends_on = [ aws_iam_role_policy_attachment.cluster_amazon_eks_cluster_policy, aws_iam_role_policy_attachment.cluster_amazon_eks_vpc_resource_controller, ] tags = { Name = "${var.project_name}-eks" } } resource "aws_eks_node_group" "main" { cluster_name = aws_eks_cluster.main.name node_group_name = "${var.project_name}-node-group" node_role_arn = aws_iam_role.node.arn subnet_ids = aws_subnet.private[*].id scaling_config { desired_size = var.node_group_desired_size max_size = var.node_group_max_size min_size = var.node_group_min_size } instance_types = var.node_instance_types remote_access { ec2_ssh_key = var.ssh_key_name source_security_group_ids = [aws_security_group.node.id] } labels = { Environment = var.environment Project = var.project_name } tags = { Name = "${var.project_name}-node" } depends_on = [ aws_iam_role_policy_attachment.node_amazon_eks_worker_node_policy, aws_iam_role_policy_attachment.node_amazon_eks_cni_policy, aws_iam_role_policy_attachment.node_amazon_ec2_container_registry_read_only, ] } # å˜é‡å®šä¹‰ # variables.tf variable "aws_region" { description = "AWS region" type = string default = "us-east-1" } variable "environment" { description = "Environment name" type = string validation { condition = contains(["development", "staging", "production"], var.environment) error_message = "Environment must be development, staging, or production." } } variable "project_name" { description = "Project name" type = string } variable "vpc_cidr" { description = "CIDR block for VPC" type = string default = "10.0.0.0/16" } variable "availability_zones" { description = "List of availability zones" type = list(string) default = ["us-east-1a", "us-east-1b", "us-east-1c"] } # è¾“å‡ºå®šä¹‰ # outputs.tf output "cluster_id" { description = "EKS cluster ID" value = aws_eks_cluster.main.id } output "cluster_endpoint" { description = "EKS cluster endpoint" value = aws_eks_cluster.main.endpoint } output "cluster_security_group_id" { description = "Security group ID attached to the EKS cluster" value = aws_eks_cluster.main.vpc_config[0].cluster_security_group_id } output "cluster_certificate_authority_data" { description = "Base64 encoded certificate data required to communicate with the cluster" value = aws_eks_cluster.main.certificate_authority[0].data } 4.2 Dockerä¸Kubernetesé…ç½® 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 # ========== Dockeré…ç½® ========== # Dockerfile FROM python:3.11-slim # è®¾ç½®å·¥ä½œç›®å½• WORKDIR /app # è®¾ç½®ç¯å¢ƒå˜é‡ ENV PYTHONDONTWRITEBYTECODE=1 \ PYTHONUNBUFFERED=1 \ PIP_NO_CACHE_DIR=1 \ PIP_DISABLE_PIP_VERSION_CHECK=1 # å®‰è£…ç³»ç»Ÿä¾èµ– RUN apt-get update && \ apt-get install -y --no-install-recommends \ gcc \ libc6-dev \ && rm -rf /var/lib/apt/lists/* # å¤åˆ¶ä¾èµ–æ–‡ä»¶ COPY requirements.txt . # å®‰è£…Pythonä¾èµ– RUN pip install --no-cache-dir -r requirements.txt # å¤åˆ¶åº”ç”¨ä»£ç  COPY src/ ./src/ COPY config/ ./config/ # åˆ›å»ºérootç”¨æˆ· RUN useradd -m -u 1000 appuser && \ chown -R appuser:appuser /app USER appuser # æš´éœ²ç«¯å£ EXPOSE 8080 # å¥åº·æ£€æŸ¥ HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \ CMD curl -f http://localhost:8080/health || exit 1 # å¯åŠ¨åº”ç”¨ CMD ["gunicorn", "src.app:app", "--bind", "0.0.0.0:8080", "--workers", "4"] # docker-compose.yml version: '3.8' services: app: build: context: . dockerfile: Dockerfile image: my-application:latest ports: - "8080:8080" environment: - DATABASE_URL=postgresql://user:password@db:5432/app - REDIS_URL=redis://redis:6379 depends_on: db: condition: service_healthy redis: condition: service_started healthcheck: test: ["CMD", "curl", "-f", "http://localhost:8080/health"] interval: 30s timeout: 10s retries: 3 start_period: 40s restart: unless-stopped db: image: postgres:15-alpine environment: - POSTGRES_DB=app - POSTGRES_USER=user - POSTGRES_PASSWORD=password volumes: - postgres_data:/var/lib/postgresql/data healthcheck: test: ["CMD-SHELL", "pg_isready -U user -d app"] interval: 10s timeout: 5s retries: 5 restart: unless-stopped redis: image: redis:7-alpine volumes: - redis_data:/data restart: unless-stopped nginx: image: nginx:alpine ports: - "80:80" - "443:443" volumes: - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro - ./nginx/ssl:/etc/nginx/ssl:ro depends_on: - app restart: unless-stopped volumes: postgres_data: redis_data: # ========== Kubernetesé…ç½® ========== # deployment.yaml apiVersion: apps/v1 kind: Deployment metadata: name: my-application labels: app: my-application spec: replicas: 3 strategy: type: RollingUpdate rollingUpdate: maxSurge: 1 maxUnavailable: 0 selector: matchLabels: app: my-application template: metadata: labels: app: my-application spec: serviceAccountName: my-application securityContext: runAsNonRoot: true runAsUser: 1000 fsGroup: 1000 containers: - name: app image: registry.example.com/my-application:1.0.0 ports: - name: http containerPort: 8080 protocol: TCP env: - name: DATABASE_URL valueFrom: secretKeyRef: name: app-secrets key: database-url - name: REDIS_URL valueFrom: configMapKeyRef: name: app-config key: redis-url resources: requests: memory: "128Mi" cpu: "100m" limits: memory: "256Mi" cpu: "200m" livenessProbe: httpGet: path: /health port: http initialDelaySeconds: 30 periodSeconds: 10 timeoutSeconds: 5 failureThreshold: 3 readinessProbe: httpGet: path: /ready port: http initialDelaySeconds: 5 periodSeconds: 5 timeoutSeconds: 3 failureThreshold: 3 lifecycle: preStop: exec: command: - sh - -c - sleep 15 terminationGracePeriodSeconds: 30 # service.yaml apiVersion: v1 kind: Service metadata: name: my-application spec: type: ClusterIP selector: app: my-application ports: - name: http port: 80 targetPort: http protocol: TCP # hpa.yaml apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: my-application spec: scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: my-application minReplicas: 3 maxReplicas: 10 metrics: - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 - type: Resource resource: name: memory target: type: Utilization averageUtilization: 80 behavior: scaleDown: stabilizationWindowSeconds: 300 policies: - type: Percent value: 50 periodSeconds: 60 scaleUp: stabilizationWindowSeconds: 0 policies: - type: Percent value: 100 periodSeconds: 30 - type: Pods value: 2 periodSeconds: 60 selectPolicy: Max æ€»ç»“ æ„å»ºé«˜æ•ˆçš„DevOpså’ŒCI/CDæµæ°´çº¿éœ€è¦ï¼š
...</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a><a href=/blog/categories/ci/cd/ class=category-link>CI/CD</a></div><span class=post-date>2025-12-30</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to DevOpsä¸CI/CDå®Œå…¨æŒ‡å—ï¼šæ„å»ºé«˜æ•ˆçš„è½¯ä»¶äº¤ä»˜æµæ°´çº¿" href=/blog/articles/devops%E4%B8%8Eci/cd%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E6%9E%84%E5%BB%BA%E9%AB%98%E6%95%88%E7%9A%84%E8%BD%AF%E4%BB%B6%E4%BA%A4%E4%BB%98%E6%B5%81%E6%B0%B4%E7%BA%BF/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Dockerä¸Kuberneteså®¹å™¨åŒ–éƒ¨ç½²ï¼šä»é›¶æ­å»ºç”Ÿäº§çº§å®¹å™¨åŒ–ç³»ç»Ÿ</h2></header><div class=entry-content><p>å¼•è¨€ å®¹å™¨åŒ–æŠ€æœ¯å½»åº•æ”¹å˜äº†åº”ç”¨çš„éƒ¨ç½²å’Œè¿ç»´æ–¹å¼ã€‚Dockeræä¾›äº†è½»é‡çº§çš„å®¹å™¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œè€ŒKubernetesï¼ˆK8sï¼‰åˆ™æä¾›äº†å¼ºå¤§çš„å®¹å™¨ç¼–æ’èƒ½åŠ›ã€‚æœ¬æ–‡å°†ä»é›¶å¼€å§‹ï¼Œæ·±å…¥è®²è§£å¦‚ä½•ä½¿ç”¨Dockerå’ŒKubernetesæ„å»ºç”Ÿäº§çº§çš„å®¹å™¨åŒ–ç³»ç»Ÿã€‚
ä¸€ã€DockeråŸºç¡€ 1.1 Dockeræ ¸å¿ƒæ¦‚å¿µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # Dockerä¸‰å¤§æ ¸å¿ƒæ¦‚å¿µ # 1. é•œåƒï¼ˆImageï¼‰ï¼šåº”ç”¨çš„åªè¯»æ¨¡æ¿ # 2. å®¹å™¨ï¼ˆContainerï¼‰ï¼šé•œåƒçš„è¿è¡Œå®ä¾‹ # 3. ä»“åº“ï¼ˆRegistryï¼‰ï¼šå­˜å‚¨å’Œåˆ†å‘é•œåƒ # æŸ¥çœ‹Dockerç‰ˆæœ¬ docker --version docker info # è¿è¡Œç¬¬ä¸€ä¸ªå®¹å™¨ docker run hello-world # äº¤äº’å¼è¿è¡Œå®¹å™¨ docker run -it ubuntu bash 1.2 Dockerfileæœ€ä½³å®è·µ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 # 1. é€‰æ‹©åˆé€‚çš„åŸºç¡€é•œåƒ # ç”Ÿäº§ç¯å¢ƒæ¨èä½¿ç”¨alpineæˆ–distroless FROM node:20-alpine AS builder # 2. è®¾ç½®å·¥ä½œç›®å½• WORKDIR /app # 3. ä¼˜åŒ–ä¾èµ–å®‰è£…ï¼ˆåˆ©ç”¨Dockerç¼“å­˜ï¼‰ # å…ˆå¤åˆ¶packageæ–‡ä»¶ï¼Œå®‰è£…ä¾èµ–åå†å¤åˆ¶æºä»£ç  COPY package*.json ./ RUN npm ci --only=production # 4. å¤åˆ¶æºä»£ç  COPY . . # 5. æ„å»ºåº”ç”¨ RUN npm run build # 6. ç”Ÿäº§é•œåƒï¼ˆå¤šé˜¶æ®µæ„å»ºï¼‰ FROM node:20-alpine # 7. åˆ›å»ºérootç”¨æˆ· RUN addgroup -g 1001 -S nodejs && \ adduser -S nodejs -u 1001 WORKDIR /app # 8. åªå¤åˆ¶å¿…è¦æ–‡ä»¶ COPY --from=builder --chown=nodejs:nodejs /app/dist ./dist COPY --from=builder --chown=nodejs:nodejs /app/node_modules ./node_modules COPY --from=builder --chown=nodejs:nodejs /app/package.json ./ # 9. åˆ‡æ¢åˆ°érootç”¨æˆ· USER nodejs # 10. æš´éœ²ç«¯å£ EXPOSE 3000 # 11. å¥åº·æ£€æŸ¥ HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \ CMD node healthcheck.js || exit 1 # 12. å¯åŠ¨å‘½ä»¤ CMD ["node", "dist/index.js"] 1.3 Docker Composeæœ¬åœ°å¼€å‘ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 # docker-compose.yml version: '3.8' services: # å‰ç«¯åº”ç”¨ frontend: build: context: ./frontend dockerfile: Dockerfile target: development ports: - "3000:3000" volumes: - ./frontend:/app - /app/node_modules environment: - NODE_ENV=development - API_URL=http://api:4000 depends_on: - api # åç«¯API api: build: context: ./backend dockerfile: Dockerfile ports: - "4000:4000" environment: - NODE_ENV=development - DATABASE_URL=postgresql://postgres:password@db:5432/myapp - REDIS_URL=redis://redis:6379 depends_on: - db - redis volumes: - ./backend:/app - /app/node_modules # PostgreSQLæ•°æ®åº“ db: image: postgres:16-alpine ports: - "5432:5432" environment: - POSTGRES_USER=postgres - POSTGRES_PASSWORD=password - POSTGRES_DB=myapp volumes: - postgres_data:/var/lib/postgresql/data - ./init.sql:/docker-entrypoint-initdb.d/init.sql # Redisç¼“å­˜ redis: image: redis:7-alpine ports: - "6379:6379" volumes: - redis_data:/data command: redis-server --appendonly yes # Nginxåå‘ä»£ç† nginx: image: nginx:alpine ports: - "80:80" - "443:443" volumes: - ./nginx/nginx.conf:/etc/nginx/nginx.conf:ro - ./nginx/ssl:/etc/nginx/ssl:ro depends_on: - frontend - api volumes: postgres_data: redis_data: äºŒã€Kubernetesæ ¸å¿ƒæ¦‚å¿µ 2.1 Podä¸å®¹å™¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 # pod.yaml - æœ€å°éƒ¨ç½²å•å…ƒ apiVersion: v1 kind: Pod metadata: name: nginx-pod labels: app: nginx spec: containers: - name: nginx image: nginx:1.25-alpine ports: - containerPort: 80 resources: requests: memory: "64Mi" cpu: "250m" limits: memory: "128Mi" cpu: "500m" livenessProbe: httpGet: path: / port: 80 initialDelaySeconds: 30 periodSeconds: 10 readinessProbe: httpGet: path: / port: 80 initialDelaySeconds: 5 periodSeconds: 5 volumeMounts: - name: config mountPath: /etc/nginx/conf.d volumes: - name: config configMap: name: nginx-config 2.2 Deploymentéƒ¨ç½² 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 # deployment.yaml - å£°æ˜å¼éƒ¨ç½² apiVersion: apps/v1 kind: Deployment metadata: name: web-app labels: app: web spec: # æœŸæœ›çš„å‰¯æœ¬æ•° replicas: 3 # é€‰æ‹©å™¨ selector: matchLabels: app: web # Podæ¨¡æ¿ template: metadata: labels: app: web spec: containers: - name: web image: myregistry/web-app:v1.0.0 ports: - containerPort: 3000 env: - name: NODE_ENV value: "production" - name: DATABASE_URL valueFrom: secretKeyRef: name: db-secret key: url resources: requests: memory: "256Mi" cpu: "250m" limits: memory: "512Mi" cpu: "500m" livenessProbe: httpGet: path: /health port: 3000 initialDelaySeconds: 30 periodSeconds: 10 readinessProbe: httpGet: path: /ready port: 3000 initialDelaySeconds: 5 periodSeconds: 5 # æ›´æ–°ç­–ç•¥ strategy: type: RollingUpdate rollingUpdate: maxSurge: 1 # æœ€å¤šå¤š1ä¸ªPod maxUnavailable: 0 # ä¸å…è®¸ä¸å¯ç”¨Pod # å†å²ç‰ˆæœ¬é™åˆ¶ revisionHistoryLimit: 10 2.3 ServiceæœåŠ¡å‘ç° 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # service.yaml - æœåŠ¡æš´éœ² apiVersion: v1 kind: Service metadata: name: web-service spec: # ClusterIP: é›†ç¾¤å†…éƒ¨è®¿é—®ï¼ˆé»˜è®¤ï¼‰ # NodePort: é€šè¿‡èŠ‚ç‚¹IP:ç«¯å£è®¿é—® # LoadBalancer: äº‘æœåŠ¡å•†è´Ÿè½½å‡è¡¡å™¨ type: ClusterIP # é€‰æ‹©å™¨ selector: app: web # ç«¯å£é…ç½® ports: - name: http protocol: TCP port: 80 # Serviceç«¯å£ targetPort: 3000 # Podç«¯å£ # Sessionä¿æŒï¼ˆå¯é€‰ï¼‰ sessionAffinity: ClientIP sessionAffinityConfig: clientIP: timeoutSeconds: 10800 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 # ingress.yaml - HTTPè·¯ç”± apiVersion: networking.k8s.io/v1 kind: Ingress metadata: name: web-ingress annotations: nginx.ingress.kubernetes.io/rewrite-target: / nginx.ingress.kubernetes.io/ssl-redirect: "true" cert-manager.io/cluster-issuer: "letsencrypt-prod" spec: ingressClassName: nginx tls: - hosts: - example.com secretName: web-tls rules: - host: example.com http: paths: - path: / pathType: Prefix backend: service: name: web-service port: number: 80 ä¸‰ã€Kubernetesé«˜çº§é…ç½® 3.1 ConfigMapé…ç½®ç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 # configmap.yaml apiVersion: v1 kind: ConfigMap metadata: name: app-config data: # é”®å€¼å¯¹é…ç½® NODE_ENV: "production" LOG_LEVEL: "info" # æ–‡ä»¶é…ç½® app.json: | { "port": 3000, "database": { "host": "postgres.default.svc.cluster.local", "port": 5432 } } nginx.conf: | server { listen 80; location / { proxy_pass http://web-service:3000; } } 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 # ä½¿ç”¨ConfigMap apiVersion: v1 kind: Pod metadata: name: app-pod spec: containers: - name: app image: myapp:latest env: # ä»ConfigMapè¯»å–ç¯å¢ƒå˜é‡ - name: NODE_ENV valueFrom: configMapKeyRef: name: app-config key: NODE_ENV volumeMounts: # æŒ‚è½½æ–‡ä»¶ - name: config mountPath: /etc/app readOnly: true volumes: - name: config configMap: name: app-config items: - key: app.json path: config.json - key: nginx.conf path: nginx.conf 3.2 Secretå¯†é’¥ç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 # åˆ›å»ºSecret apiVersion: v1 kind: Secret metadata: name: db-secret type: Opaque data: # Base64ç¼–ç çš„å€¼ username: cG9zdGdyZXM= password: cGFzc3dvcmQ= url: cG9zdGdyZXNxbDovL3Bvc3RncmVzOnBhc3N3b3JkQGRiOjU0MzIvbXlhcHA= 1 2 3 4 5 6 7 8 9 10 # ä»å‘½ä»¤è¡Œåˆ›å»ºSecret kubectl create secret generic db-secret \ --from-literal=username=postgres \ --from-literal=password=password \ --from-file=cert=./tls.crt # ä»æ–‡ä»¶åˆ›å»º kubectl create secret tls web-tls \ --cert=path/to/tls.cert \ --key=path/to/tls.key 3.3 PersistentVolumeæŒä¹…åŒ–å­˜å‚¨ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 # persistent-volume.yaml apiVersion: v1 kind: PersistentVolume metadata: name: pv-data spec: capacity: storage: 10Gi accessModes: - ReadWriteOnce # RWO, RWX, ROX persistentVolumeReclaimPolicy: Retain # Retain, Delete, Recycle storageClassName: standard hostPath: path: /data/volume 1 2 3 4 5 6 7 8 9 10 11 12 # persistent-volume-claim.yaml apiVersion: v1 kind: PersistentVolumeClaim metadata: name: pvc-data spec: accessModes: - ReadWriteOnce resources: requests: storage: 5Gi storageClassName: standard 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # ä½¿ç”¨PVC apiVersion: v1 kind: Pod metadata: name: app-pod spec: containers: - name: app image: myapp:latest volumeMounts: - name: data mountPath: /app/data volumes: - name: data persistentVolumeClaim: claimName: pvc-data å››ã€è‡ªåŠ¨æ‰©ç¼©å®¹ 4.1 Horizontal Pod Autoscaler 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 # hpa.yaml - æ°´å¹³Podè‡ªåŠ¨æ‰©ç¼©å®¹ apiVersion: autoscaling/v2 kind: HorizontalPodAutoscaler metadata: name: web-hpa spec: # æ‰©ç¼©å®¹ç›®æ ‡ scaleTargetRef: apiVersion: apps/v1 kind: Deployment name: web-app # æœ€å°å’Œæœ€å¤§å‰¯æœ¬æ•° minReplicas: 2 maxReplicas: 10 # æŒ‡æ ‡é…ç½® metrics: # CPUä½¿ç”¨ç‡ - type: Resource resource: name: cpu target: type: Utilization averageUtilization: 70 # å†…å­˜ä½¿ç”¨é‡ - type: Resource resource: name: memory target: type: AverageValue averageValue: 512Mi # è‡ªå®šä¹‰æŒ‡æ ‡ - type: Pods pods: metric: name: http_requests_per_second target: type: AverageValue averageValue: "100" # è¡Œä¸ºé…ç½® behavior: scaleDown: stabilizationWindowSeconds: 300 policies: - type: Percent value: 50 periodSeconds: 60 scaleUp: stabilizationWindowSeconds: 0 policies: - type: Percent value: 100 periodSeconds: 15 - type: Pods value: 2 periodSeconds: 15 selectPolicy: Max 4.2 Vertical Pod Autoscaler 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 # vpa.yaml - å‚ç›´Podè‡ªåŠ¨æ‰©ç¼©å®¹ apiVersion: autoscaling.k8s.io/v1 kind: VerticalPodAutoscaler metadata: name: web-vpa spec: targetRef: apiVersion: apps/v1 kind: Deployment name: web-app updatePolicy: updateMode: Auto # Off, Initial, Recreate, Auto resourcePolicy: containerPolicies: - containerName: '*' minAllowed: cpu: 100m memory: 128Mi maxAllowed: cpu: 1 memory: 1Gi controlledResources: ["cpu", "memory"] controlledValues: RequestsAndLimits äº”ã€CI/CDé›†æˆ 5.1 GitHub Actions CI/CD 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 # .github/workflows/deploy-k8s.yml name: Build and Deploy to Kubernetes on: push: branches: [main] pull_request: branches: [main] env: REGISTRY: ghcr.io IMAGE_NAME: ${{ github.repository }} jobs: build: runs-on: ubuntu-latest permissions: contents: read packages: write steps: - name: Checkout code uses: actions/checkout@v4 - name: Set up Docker Buildx uses: docker/setup-buildx-action@v3 - name: Login to Container Registry uses: docker/login-action@v3 with: registry: ${{ env.REGISTRY }} username: ${{ github.actor }} password: ${{ secrets.GITHUB_TOKEN }} - name: Extract metadata id: meta uses: docker/metadata-action@v5 with: images: ${{ env.REGISTRY }}/${{ env.IMAGE_NAME }} tags: | type=ref,event=branch type=semver,pattern={{version}} type=semver,pattern={{major}}.{{minor}} type=sha,prefix={{branch}}- - name: Build and push Docker image uses: docker/build-push-action@v5 with: context: . push: true tags: ${{ steps.meta.outputs.tags }} labels: ${{ steps.meta.outputs.labels }} cache-from: type=gha cache-to: type=gha,mode=max - name: Install kubectl uses: azure/setup-kubectl@v3 with: version: 'latest' - name: Configure kubectl run: | echo "${{ secrets.KUBE_CONFIG }}" | base64 -d > kubeconfig export KUBECONFIG=kubeconfig - name: Deploy to Kubernetes run: | # æ›´æ–°deploymentä¸­çš„é•œåƒ kubectl set image deployment/web-app \ web=${{ env.REGISTRY }}/${{ env.IMAGE_NAME }}:${{ github.sha }} # ç­‰å¾…éƒ¨ç½²å®Œæˆ kubectl rollout status deployment/web-app # éªŒè¯éƒ¨ç½² kubectl get pods -l app=web 5.2 Helm Chartsç®¡ç† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 # Helm Chart values.yaml replicaCount: 3 image: repository: ghcr.io/myorg/myapp pullPolicy: IfNotPresent tag: "v1.0.0" imagePullSecrets: [] service: type: ClusterIP port: 80 targetPort: 3000 ingress: enabled: true className: nginx annotations: cert-manager.io/cluster-issuer: letsencrypt-prod hosts: - host: app.example.com paths: - path: / pathType: Prefix tls: - secretName: app-tls hosts: - app.example.com resources: requests: memory: "256Mi" cpu: "250m" limits: memory: "512Mi" cpu: "500m" autoscaling: enabled: true minReplicas: 2 maxReplicas: 10 targetCPUUtilizationPercentage: 70 targetMemoryUtilizationPercentage: 80 database: host: postgres.default.svc.cluster.local port: 5432 name: myapp existingSecret: db-secret 1 2 3 4 5 6 7 8 # éƒ¨ç½²Helm Chart helm upgrade --install myapp ./chart \ --namespace production \ --create-namespace \ --values values.yaml \ --set image.tag=${IMAGE_TAG} \ --wait \ --timeout 5m å…­ã€ç›‘æ§ä¸æ—¥å¿— 6.1 Prometheusç›‘æ§ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 # ServiceMonitor for Prometheus Operator apiVersion: monitoring.coreos.com/v1 kind: ServiceMonitor metadata: name: web-app labels: app: web spec: selector: matchLabels: app: web endpoints: - port: http path: /metrics interval: 30s scrapeTimeout: 10s 6.2 æ—¥å¿—æ”¶é›† 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 # Fluentd ConfigMap apiVersion: v1 kind: ConfigMap metadata: name: fluentd-config data: fluent.conf: | &lt;source> @type tail path /var/log/containers/*.log pos_file /var/log/fluentd-containers.log.pos tag kubernetes.* read_from_head true &lt;parse> @type json &lt;/parse> &lt;/source> &lt;filter kubernetes.**> @type kubernetes_metadata &lt;/filter> &lt;match **> @type elasticsearch host elasticsearch.logging.svc.cluster.local port 9200 logstash_format true logstash_prefix k8s &lt;/match> æ€»ç»“ Dockerå’ŒKubernetesæ„å»ºäº†ç°ä»£å®¹å™¨åŒ–éƒ¨ç½²çš„åŸºç¡€ï¼š
...</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a><a href=/blog/categories/%E5%AE%B9%E5%99%A8%E6%8A%80%E6%9C%AF/ class=category-link>å®¹å™¨æŠ€æœ¯</a></div><span class=post-date>2025-12-24</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to Dockerä¸Kuberneteså®¹å™¨åŒ–éƒ¨ç½²ï¼šä»é›¶æ­å»ºç”Ÿäº§çº§å®¹å™¨åŒ–ç³»ç»Ÿ" href=/blog/articles/docker%E4%B8%8Ekubernetes%E5%AE%B9%E5%99%A8%E5%8C%96%E9%83%A8%E7%BD%B2%E4%BB%8E%E9%9B%B6%E6%90%AD%E5%BB%BA%E7%94%9F%E4%BA%A7%E7%BA%A7%E5%AE%B9%E5%99%A8%E5%8C%96%E7%B3%BB%E7%BB%9F/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>2025å¹´äº‘åŸç”Ÿéƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»å®¹å™¨åŒ–åˆ°Serverlessçš„ç°ä»£åŒ–éƒ¨ç½²ç­–ç•¥</h2></header><div class=entry-content><p>æ·±å…¥æ¢è®¨2025å¹´äº‘åŸç”Ÿéƒ¨ç½²çš„æœ€æ–°æŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬Kubernetesã€Serverlessã€å¾®æœåŠ¡æ¶æ„ã€DevOpsæµæ°´çº¿ã€å¯è§‚æµ‹æ€§å’Œè‡ªåŠ¨åŒ–è¿ç»´ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºé«˜æ•ˆã€å¯æ‰©å±•çš„äº‘åŸç”Ÿåº”ç”¨ã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a></div><span class=post-date>2025-12-22</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to 2025å¹´äº‘åŸç”Ÿéƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»å®¹å™¨åŒ–åˆ°Serverlessçš„ç°ä»£åŒ–éƒ¨ç½²ç­–ç•¥" href=/blog/articles/2025%E5%B9%B4%E4%BA%91%E5%8E%9F%E7%94%9F%E9%83%A8%E7%BD%B2%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E4%BB%8E%E5%AE%B9%E5%99%A8%E5%8C%96%E5%88%B0serverless%E7%9A%84%E7%8E%B0%E4%BB%A3%E5%8C%96%E9%83%A8%E7%BD%B2%E7%AD%96%E7%95%A5/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ</h2></header><div class=entry-content><p>å…¨é¢ä»‹ç»ç°ä»£æœåŠ¡å™¨è¿ç»´çš„æ ¸å¿ƒæŠ€æœ¯å’Œæœ€ä½³å®è·µï¼ŒåŒ…æ‹¬è‡ªåŠ¨åŒ–éƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ã€æ€§èƒ½ä¼˜åŒ–ã€æ•…éšœæ’é™¤å’Œå®‰å…¨åŠ å›ºï¼Œå¸®åŠ©è¿ç»´å›¢é˜Ÿæ„å»ºé«˜æ•ˆã€å¯é çš„æœåŠ¡å™¨ç®¡ç†ä½“ç³»ã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a></div><span class=post-date>2025-12-22</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to ç°ä»£æœåŠ¡å™¨è¿ç»´å®Œå…¨æŒ‡å—ï¼šè‡ªåŠ¨åŒ–ç›‘æ§ä¸æ™ºèƒ½è¿ç»´æœ€ä½³å®è·µ" href=/blog/articles/%E7%8E%B0%E4%BB%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%97%E8%87%AA%E5%8A%A8%E5%8C%96%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%99%BA%E8%83%BD%E8%BF%90%E7%BB%B4%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>å®¹å™¨éƒ¨ç½²æœ€ä½³å®è·µï¼šä»Dockeråˆ°Kubernetesçš„å®Œæ•´éƒ¨ç½²æŒ‡å—</h2></header><div class=entry-content><p>æ·±å…¥æ¢è®¨ç°ä»£å®¹å™¨åŒ–éƒ¨ç½²çš„æœ€ä½³å®è·µï¼ŒåŒ…æ‹¬Dockerå®¹å™¨åŒ–ã€Docker Composeç¼–æ’ã€Kubernetesé›†ç¾¤ç®¡ç†ã€CI/CDé›†æˆå’Œç›‘æ§å‘Šè­¦ï¼Œå¸®åŠ©ä¼ä¸šæ„å»ºå¯é çš„å®¹å™¨åŒ–åº”ç”¨éƒ¨ç½²æµç¨‹ã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a></div><span class=post-date>2025-12-22</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to å®¹å™¨éƒ¨ç½²æœ€ä½³å®è·µï¼šä»Dockeråˆ°Kubernetesçš„å®Œæ•´éƒ¨ç½²æŒ‡å—" href=/blog/articles/%E5%AE%B9%E5%99%A8%E9%83%A8%E7%BD%B2%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5%E4%BB%8Edocker%E5%88%B0kubernetes%E7%9A%84%E5%AE%8C%E6%95%B4%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Dockerå®¹å™¨åŒ–å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç”Ÿäº§å®è·µ</h2></header><div class=entry-content><p>å…¨é¢æŒæ¡Dockerå®¹å™¨åŒ–æŠ€æœ¯ï¼Œä»åŸºç¡€æ¦‚å¿µåˆ°ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„æœ€ä½³å®è·µã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/devops/ class=category-link>DevOps</a><a href=/blog/categories/%E5%90%8E%E7%AB%AF%E5%BC%80%E5%8F%91/ class=category-link>åç«¯å¼€å‘</a></div><span class=post-date>2025-12-21</span><span class=post-author>Util Tech Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to Dockerå®¹å™¨åŒ–å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç”Ÿäº§å®è·µ" href=/blog/articles/docker-containerization-guide/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Kubernetes 1.30æ–°ç‰¹æ€§å…¨é¢è§£æ</h2></header><div class=entry-content><p>å…¨é¢äº†è§£Kubernetes 1.30çš„åˆ›æ–°åŠŸèƒ½ï¼Œæå‡é›†ç¾¤ç®¡ç†æ•ˆç‡ã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E4%BA%91%E5%8E%9F%E7%94%9F/ class=category-link>äº‘åŸç”Ÿ</a></div><span class=post-date>2025-12-19</span><span class=post-author>æŠ€æœ¯å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to Kubernetes 1.30æ–°ç‰¹æ€§å…¨é¢è§£æ" href=/blog/articles/kubernetes-1-30-new-features/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Dockerå®¹å™¨åŒ–æœ€ä½³å®è·µï¼šä»å¼€å‘åˆ°ç”Ÿäº§çš„å®Œæ•´æŒ‡å—</h2></header><div class=entry-content><p>å…¨é¢çš„Dockeræœ€ä½³å®è·µæŒ‡å—ï¼Œæ¶µç›–é•œåƒä¼˜åŒ–ã€å®¹å™¨å®‰å…¨ã€å¤šç¯å¢ƒéƒ¨ç½²ã€ç›‘æ§å‘Šè­¦ç­‰å…³é”®ä¸»é¢˜ï¼Œå¸®åŠ©ä½ æ„å»ºå¯é çš„å®¹å™¨åŒ–åº”ç”¨ã€‚</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E6%8A%80%E6%9C%AF%E5%8D%9A%E5%AE%A2/ class=category-link>æŠ€æœ¯åšå®¢</a></div><span class=post-date>2025-12-18</span><span class=post-author>æœ‰æ¡å·¥å…·å›¢é˜Ÿ</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to Dockerå®¹å™¨åŒ–æœ€ä½³å®è·µï¼šä»å¼€å‘åˆ°ç”Ÿäº§çš„å®Œæ•´æŒ‡å—" href=/blog/articles/docker-best-practices-guide/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2 class=entry-hint-parent>Dockerå®¹å™¨åŒ–éƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç”Ÿäº§ç¯å¢ƒ</h2></header><div class=entry-content><p>å…¨é¢ä»‹ç»Dockerå®¹å™¨åŒ–æŠ€æœ¯ï¼ŒåŒ…æ‹¬åŸºç¡€æ¦‚å¿µã€é•œåƒæ„å»ºã€å®¹å™¨ç¼–æ’ã€ç›‘æ§æ—¥å¿—ã€å®‰å…¨é…ç½®ç­‰ï¼Œå¹¶æä¾›ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²çš„æœ€ä½³å®è·µ</p></div><footer class=entry-footer><div class=post-meta-content><div class=post-categories-inline><a href=/blog/categories/%E8%BF%90%E7%BB%B4%E9%83%A8%E7%BD%B2/ class=category-link>è¿ç»´éƒ¨ç½²</a></div><span class=post-date>2025-12-17</span><span class=post-author>util.cn Team</span></div><style>.post-meta-content{display:flex;align-items:center;flex-wrap:wrap;gap:.75rem;font-family:sf mono,monaco,courier new,monospace;font-size:.875rem;color:#9ca3af !important}.post-categories-inline{display:inline-flex;align-items:center;gap:.5rem}.category-link{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .75rem;background:rgba(255,255,255,.1);color:#e5e7eb !important;text-decoration:none;font-size:.75rem;font-weight:600;text-transform:uppercase;letter-spacing:.05em;border:1px solid rgba(255,255,255,.2);border-radius:0;transition:all .3s ease;white-space:nowrap}.category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3);transform:translateY(-1px)}.category-link::before{content:'ğŸ“';font-size:.7rem;opacity:.8}.post-date,.post-reading-time,.post-word-count,.post-author{color:#9ca3af !important}[data-theme=dark] .post-meta-content{color:#9ca3af !important}[data-theme=dark] .category-link{background:rgba(255,255,255,.1);color:#e5e7eb !important;border-color:rgba(255,255,255,.2)}[data-theme=dark] .category-link:hover{background:rgba(255,255,255,.2);color:#fff !important;border-color:rgba(255,255,255,.3)}[data-theme=dark] .post-date,[data-theme=dark] .post-reading-time,[data-theme=dark] .post-word-count,[data-theme=dark] .post-author{color:#9ca3af !important}[data-theme=light] .post-meta-content{color:#6c757d !important}[data-theme=light] .category-link{background:rgba(0,0,0,5%);color:#495057 !important;border-color:rgba(0,0,0,.15)}[data-theme=light] .category-link:hover{background:rgba(0,102,204,.1);color:#212529 !important;border-color:rgba(0,102,204,.3)}[data-theme=light] .post-date,[data-theme=light] .post-reading-time,[data-theme=light] .post-word-count,[data-theme=light] .post-author{color:#6c757d !important}@media(max-width:768px){.post-meta-content{gap:.5rem;font-size:.8rem}.category-link{padding:.2rem .6rem;font-size:.7rem}}</style></footer><a class=entry-link aria-label="post link to Dockerå®¹å™¨åŒ–éƒ¨ç½²å®Œå…¨æŒ‡å—ï¼šä»å…¥é—¨åˆ°ç”Ÿäº§ç¯å¢ƒ" href=/blog/articles/docker-deployment-guide/></a></article><footer class=page-footer><nav class=pagination><a class=next href=/blog/tags/devops/page/2/>&nbsp;&nbsp;Â»</a></nav></footer></main><footer class=footer><span>Â© 2024-2025 æœ‰æ¡å·¥å…·æŠ€æœ¯åšå®¢</span> Â·</footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script></body></html>