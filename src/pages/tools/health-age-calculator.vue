<template>
  <div class="max-w-6xl mx-auto p-6">
    <div class="mb-8">
      <h1 class="text-3xl font-bold mb-3">å¥åº·å¹´é¾„è¯„ä¼°</h1>
      <p class="text-muted-foreground mb-6">ç»¼åˆè¯„ä¼°ç”Ÿç†å¹´é¾„ï¼Œç”Ÿæ´»æ–¹å¼å› ç´ è¯„åˆ†ï¼Œæ…¢æ€§ç—…é£é™©è¯„ä¼°ï¼Œå¥åº·æ”¹å–„å»ºè®®</p>
    </div>

    <div class="grid lg:grid-cols-2 gap-6">
      <!-- å·¦ä¾§ï¼šç”Ÿæ´»æ–¹å¼è¯„ä¼° -->
      <div class="space-y-6">
        <!-- åŸºæœ¬ä¿¡æ¯ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">åŸºæœ¬ä¿¡æ¯</h3>
          <div class="space-y-4">
            <div class="grid grid-cols-2 gap-4">
              <div>
                <label class="block text-sm font-medium mb-2">å®é™…å¹´é¾„</label>
                <input
                  v-model.number="basicInfo.age"
                  type="number"
                  min="18"
                  max="100"
                  class="w-full px-3 py-2 border rounded-lg"
                  placeholder="30"
                />
              </div>
              <div>
                <label class="block text-sm font-medium mb-2">æ€§åˆ«</label>
                <select v-model="basicInfo.gender" class="w-full px-3 py-2 border rounded-lg">
                  <option value="male">ç”·æ€§</option>
                  <option value="female">å¥³æ€§</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        <!-- é¥®é£Ÿä¹ æƒ¯ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">é¥®é£Ÿä¹ æƒ¯</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">è”¬èœæ°´æœæ‘„å…¥</label>
              <select v-model="lifestyle.fruitsVegetables" class="w-full px-3 py-2 border rounded-lg">
                <option value="rare">å¾ˆå°‘åƒï¼ˆæ¯å‘¨å°‘äº3æ¬¡ï¼‰</option>
                <option value="sometimes">å¶å°”åƒï¼ˆæ¯å‘¨3-5æ¬¡ï¼‰</option>
                <option value="daily">æ¯å¤©åƒï¼ˆ1-2ä»½ï¼‰</option>
                <option value="plenty">å¤§é‡åƒï¼ˆæ¯å¤©3ä»½ä»¥ä¸Šï¼‰</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">åŠ å·¥é£Ÿå“æ‘„å…¥</label>
              <select v-model="lifestyle.processedFood" class="w-full px-3 py-2 border rounded-lg">
                <option value="never">ä»ä¸åƒ</option>
                <option value="rare">å¾ˆå°‘åƒï¼ˆæ¯å‘¨1-2æ¬¡ï¼‰</option>
                <option value="sometimes">å¶å°”åƒï¼ˆæ¯å‘¨3-4æ¬¡ï¼‰</option>
                <option value="often">ç»å¸¸åƒï¼ˆæ¯å‘¨5æ¬¡ä»¥ä¸Šï¼‰</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">å«ç³–é¥®æ–™</label>
              <select v-model="lifestyle.sugaryDrinks" class="w-full px-3 py-2 border rounded-lg">
                <option value="never">ä»ä¸å–</option>
                <option value="rare">å¾ˆå°‘å–ï¼ˆæ¯å‘¨1-2æ¯ï¼‰</option>
                <option value="sometimes">å¶å°”å–ï¼ˆæ¯å‘¨3-4æ¯ï¼‰</option>
                <option value="daily">æ¯å¤©å–ï¼ˆ1æ¯ï¼‰</option>
                <option value="heavy">å¤§é‡å–ï¼ˆæ¯å¤©2æ¯ä»¥ä¸Šï¼‰</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">é¥®é£Ÿè§„å¾‹</label>
              <select v-model="lifestyle.regularMeals" class="w-full px-3 py-2 border rounded-lg">
                <option value="irregular">å¾ˆä¸è§„å¾‹</option>
                <option value="somewhat">ä¸å¤ªè§„å¾‹</option>
                <option value="regular">æ¯”è¾ƒè§„å¾‹</option>
                <option value="very-regular">éå¸¸è§„å¾‹</option>
              </select>
            </div>
          </div>
        </div>

        <!-- è¿åŠ¨ä¹ æƒ¯ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">è¿åŠ¨ä¹ æƒ¯</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">æ¯å‘¨è¿åŠ¨å¤©æ•°</label>
              <select v-model="lifestyle.exerciseDays" class="w-full px-3 py-2 border rounded-lg">
                <option value="none">ä»ä¸è¿åŠ¨</option>
                <option value="1-2">1-2å¤©</option>
                <option value="3-4">3-4å¤©</option>
                <option value="5-6">5-6å¤©</option>
                <option value="daily">æ¯å¤©è¿åŠ¨</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">æ¯æ¬¡è¿åŠ¨æ—¶é•¿</label>
              <select v-model="lifestyle.exerciseDuration" class="w-full px-3 py-2 border rounded-lg">
                <option value="none">ä¸è¿åŠ¨</option>
                <option value="short">å°‘äº30åˆ†é’Ÿ</option>
                <option value="moderate">30-60åˆ†é’Ÿ</option>
                <option value="long">è¶…è¿‡60åˆ†é’Ÿ</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">æ—¥å¸¸æ´»åŠ¨é‡</label>
              <select v-model="lifestyle.dailyActivity" class="w-full px-3 py-2 border rounded-lg">
                <option value="sedentary">ä¹…åï¼ˆå¾ˆå°‘æ´»åŠ¨ï¼‰</option>
                <option value="light">è½»åº¦æ´»åŠ¨ï¼ˆç»å¸¸èµ°åŠ¨ï¼‰</option>
                <option value="moderate">ä¸­åº¦æ´»åŠ¨ï¼ˆå·¥ä½œéœ€è¦ç«™ç«‹æˆ–èµ°åŠ¨ï¼‰</option>
                <option value="active">é«˜åº¦æ´»åŠ¨ï¼ˆä½“åŠ›åŠ³åŠ¨æˆ–å¤§é‡èµ°åŠ¨ï¼‰</option>
              </select>
            </div>
          </div>
        </div>

        <!-- ç”Ÿæ´»ä¹ æƒ¯ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">ç”Ÿæ´»ä¹ æƒ¯</h3>
          <div class="space-y-4">
            <div>
              <label class="block text-sm font-medium mb-2">ç¡çœ æ—¶é•¿</label>
              <select v-model="lifestyle.sleepHours" class="w-full px-3 py-2 border rounded-lg">
                <option value="less-5">å°‘äº5å°æ—¶</option>
                <option value="5-6">5-6å°æ—¶</option>
                <option value="7-8">7-8å°æ—¶</option>
                <option value="9-plus">9å°æ—¶ä»¥ä¸Š</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">ç¡çœ è´¨é‡</label>
              <select v-model="lifestyle.sleepQuality" class="w-full px-3 py-2 border rounded-lg">
                <option value="poor">å¾ˆå·®ï¼ˆç»å¸¸å¤±çœ ï¼‰</option>
                <option value="fair">ä¸€èˆ¬ï¼ˆå¶å°”å¤±çœ ï¼‰</option>
                <option value="good">è‰¯å¥½ï¼ˆå¾ˆå°‘å¤±çœ ï¼‰</option>
                <option value="excellent">ä¼˜ç§€ï¼ˆä»ä¸å¤±çœ ï¼‰</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">å‹åŠ›æ°´å¹³</label>
              <select v-model="lifestyle.stressLevel" class="w-full px-3 py-2 border rounded-lg">
                <option value="very-high">æé«˜å‹åŠ›</option>
                <option value="high">é«˜å‹åŠ›</option>
                <option value="moderate">ä¸­ç­‰å‹åŠ›</option>
                <option value="low">ä½å‹åŠ›</option>
                <option value="very-low">å‡ ä¹æ²¡æœ‰å‹åŠ›</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">å¸çƒŸçŠ¶å†µ</label>
              <select v-model="lifestyle.smoking" class="w-full px-3 py-2 border rounded-lg">
                <option value="never">ä»ä¸å¸çƒŸ</option>
                <option value="quit">å·²æˆ’çƒŸ</option>
                <option value="occasional">å¶å°”å¸çƒŸ</option>
                <option value="regular">ç»å¸¸å¸çƒŸï¼ˆæ¯å¤©å°‘äº1åŒ…ï¼‰</option>
                <option value="heavy">é‡åº¦å¸çƒŸï¼ˆæ¯å¤©1åŒ…ä»¥ä¸Šï¼‰</option>
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium mb-2">é¥®é…’çŠ¶å†µ</label>
              <select v-model="lifestyle.alcohol" class="w-full px-3 py-2 border rounded-lg">
                <option value="never">ä»ä¸å–é…’</option>
                <option value="rare">å¶å°”å–ï¼ˆæ¯æœˆ1-2æ¬¡ï¼‰</option>
                <option value="moderate">é€‚é‡å–ï¼ˆæ¯å‘¨1-3æ¬¡ï¼‰</option>
                <option value="frequent">ç»å¸¸å–ï¼ˆæ¯å‘¨4-6æ¬¡ï¼‰</option>
                <option value="heavy">å¤§é‡å–ï¼ˆæ¯å¤©éƒ½è¦ï¼‰</option>
              </select>
            </div>

            <button @click="calculateHealthAge" class="w-full px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90">
              è¯„ä¼°å¥åº·å¹´é¾„
            </button>
          </div>
        </div>
      </div>

      <!-- å³ä¾§ï¼šè¯„ä¼°ç»“æœ -->
      <div class="space-y-6">
        <!-- å¥åº·å¹´é¾„ç»“æœ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">å¥åº·å¹´é¾„è¯„ä¼°ç»“æœ</h3>
          <div v-if="results.healthAge > 0" class="space-y-4">
            <div class="text-center">
              <div class="text-5xl font-bold mb-2" :class="getHealthAgeClass()">
                {{ results.healthAge }}
              </div>
              <div class="text-lg text-muted-foreground">å¥åº·å¹´é¾„</div>
            </div>

            <!-- å¹´é¾„å¯¹æ¯” -->
            <div class="grid grid-cols-2 gap-4">
              <div class="text-center p-3 bg-blue-50 rounded-lg">
                <div class="text-2xl font-semibold text-blue-600">{{ basicInfo.age }}</div>
                <div class="text-xs text-muted-foreground">å®é™…å¹´é¾„</div>
              </div>
              <div class="text-center p-3 rounded-lg" :class="getAgeDifferenceClass()">
                <div class="text-2xl font-semibold" :class="getAgeDifferenceColorClass()">
                  {{ results.ageDifference > 0 ? '+' : '' }}{{ results.ageDifference }}
                </div>
                <div class="text-xs text-muted-foreground">å¹´é¾„å·®å¼‚</div>
              </div>
            </div>

            <!-- å¥åº·çŠ¶å†µæè¿° -->
            <div class="p-4 rounded-lg" :class="getHealthStatusClass()">
              <div class="text-center">
                <div class="text-lg font-medium mb-1">{{ getHealthStatusText() }}</div>
                <div class="text-sm">{{ getHealthStatusDescription() }}</div>
              </div>
            </div>
          </div>

          <div v-else class="text-center text-muted-foreground py-8">
            å®Œæˆç”Ÿæ´»æ–¹å¼è¯„ä¼°åæŸ¥çœ‹ç»“æœ
          </div>
        </div>

        <!-- é£é™©å› ç´ åˆ†æ -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">é£é™©å› ç´ åˆ†æ</h3>
          <div v-if="riskFactors.length > 0" class="space-y-3">
            <div v-for="factor in riskFactors" :key="factor.category"
                 class="p-3 rounded-lg"
                 :class="getRiskFactorClass(factor.level)">
              <div class="flex items-center justify-between">
                <div>
                  <div class="font-medium text-sm">{{ factor.category }}</div>
                  <div class="text-xs text-muted-foreground">{{ factor.description }}</div>
                </div>
                <span class="text-sm font-medium" :class="getRiskLevelClass(factor.level)">
                  {{ factor.risk }}
                </span>
              </div>
            </div>
          </div>
        </div>

        <!-- æ”¹å–„å»ºè®® -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">å¥åº·æ”¹å–„å»ºè®®</h3>
          <div v-if="improvementSuggestions.length > 0" class="space-y-3">
            <div v-for="suggestion in improvementSuggestions" :key="suggestion.priority"
                 class="p-3 rounded-lg border"
                 :class="getSuggestionClass(suggestion.priority)">
              <div class="flex items-start">
                <span class="mr-2 text-lg">{{ suggestion.icon }}</span>
                <div>
                  <div class="font-medium text-sm">{{ suggestion.title }}</div>
                  <div class="text-xs text-muted-foreground mt-1">{{ suggestion.description }}</div>
                  <div v-if="suggestion.impact" class="text-xs mt-2 font-medium text-green-600">
                    é¢„è®¡å¯é™ä½å¥åº·å¹´é¾„ {{ suggestion.impact }} å²
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- é•¿æœŸå¥åº·å»ºè®® -->
        <div class="bg-card rounded-lg p-6 border">
          <h3 class="text-lg font-semibold mb-4">é•¿æœŸå¥åº·ç®¡ç†</h3>
          <div class="space-y-3 text-sm">
            <div class="flex items-start">
              <span class="text-green-600 mr-2">âœ“</span>
              <span>å®šæœŸä½“æ£€ï¼Œç›‘æµ‹å…³é”®å¥åº·æŒ‡æ ‡å˜åŒ–</span>
            </div>
            <div class="flex items-start">
              <span class="text-green-600 mr-2">âœ“</span>
              <span>ä¿æŒå¥åº·çš„ç”Ÿæ´»æ–¹å¼ï¼Œå³ä½¿å¹´é¾„å¢é•¿ä¹Ÿè¦åšæŒ</span>
            </div>
            <div class="flex items-start">
              <span class="text-green-600 mr-2">âœ“</span>
              <span>å»ºç«‹è‰¯å¥½çš„ç¤¾ä¼šå…³ç³»ï¼Œä¿æŒç§¯æçš„å¿ƒæ€</span>
            </div>
            <div class="flex items-start">
              <span class="text-green-600 mr-2">âœ“</span>
              <span>é€‚æ—¶è°ƒæ•´ç”Ÿæ´»èŠ‚å¥ï¼Œå¹³è¡¡å·¥ä½œå’Œä¼‘æ¯</span>
            </div>
            <div class="flex items-start">
              <span class="text-green-600 mr-2">âœ“</span>
              <span>ç»ˆèº«å­¦ä¹ ï¼Œä¿æŒå¤§è„‘æ´»è·ƒå’Œè®¤çŸ¥åŠŸèƒ½</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script setup>
import { ref, computed } from 'vue'
import { useSEO } from '~/composables/useSEO'

const { setPageTitle } = useSEO()
setPageTitle('å¥åº·å¹´é¾„è¯„ä¼°')

// åŸºæœ¬ä¿¡æ¯
const basicInfo = ref({
  age: 30,
  gender: 'male'
})

// ç”Ÿæ´»æ–¹å¼
const lifestyle = ref({
  fruitsVegetables: 'daily',
  processedFood: 'sometimes',
  sugaryDrinks: 'rare',
  regularMeals: 'regular',
  exerciseDays: '3-4',
  exerciseDuration: 'moderate',
  dailyActivity: 'light',
  sleepHours: '7-8',
  sleepQuality: 'good',
  stressLevel: 'moderate',
  smoking: 'never',
  alcohol: 'moderate'
})

// è®¡ç®—ç»“æœ
const results = ref({
  healthAge: 0,
  ageDifference: 0
})

// é£é™©å› ç´ 
const riskFactors = ref([])

// æ”¹å–„å»ºè®®
const improvementSuggestions = ref([])

// è®¡ç®—å¥åº·å¹´é¾„
const calculateHealthAge = () => {
  const { age, gender } = basicInfo.value
  let healthAge = age
  const risks = []
  const suggestions = []

  // é¥®é£Ÿå› ç´ å½±å“
  const dietImpact = calculateDietImpact()
  healthAge += dietImpact.years
  risks.push(...dietImpact.risks)

  // è¿åŠ¨å› ç´ å½±å“
  const exerciseImpact = calculateExerciseImpact()
  healthAge += exerciseImpact.years
  risks.push(...exerciseImpact.risks)

  // ç”Ÿæ´»ä¹ æƒ¯å½±å“
  const lifestyleImpact = calculateLifestyleImpact()
  healthAge += lifestyleImpact.years
  risks.push(...lifestyleImpact.risks)

  // æ€§åˆ«è°ƒæ•´
  if (gender === 'female') {
    healthAge -= 2 // å¥³æ€§å¹³å‡å¯¿å‘½è¾ƒé•¿
  }

  // å¹´é¾„è°ƒæ•´ï¼ˆå¹´è½»äººå®¹é”™ç‡é«˜ï¼‰
  if (age < 30) {
    healthAge = age + (healthAge - age) * 0.5
  } else if (age > 60) {
    healthAge = age + (healthAge - age) * 1.5 // è€å¹´äººå½±å“æ›´å¤§
  }

  healthAge = Math.round(healthAge)
  const ageDifference = healthAge - age

  // ç”Ÿæˆæ”¹å–„å»ºè®®
  generateSuggestions(suggestions)

  results.value = {
    healthAge,
    ageDifference
  }

  riskFactors.value = risks
  improvementSuggestions.value = suggestions
}

// è®¡ç®—é¥®é£Ÿå½±å“
const calculateDietImpact = () => {
  let years = 0
  const risks = []

  // è”¬èœæ°´æœæ‘„å…¥
  const fruitScores = { rare: 3, sometimes: 1, daily: -1, plenty: -3 }
  years += fruitScores[lifestyle.fruitsVegetables] || 0

  if (lifestyle.fruitsVegetables === 'rare') {
    risks.push({
      category: 'è¥å…»æ‘„å…¥',
      description: 'è”¬èœæ°´æœæ‘„å…¥ä¸è¶³',
      risk: 'é«˜é£é™©',
      level: 'high'
    })
  }

  // åŠ å·¥é£Ÿå“
  const processedScores = { never: -2, rare: -1, sometimes: 1, often: 3 }
  years += processedScores[lifestyle.processedFood] || 0

  // å«ç³–é¥®æ–™
  const drinkScores = { never: -2, rare: -1, sometimes: 0, daily: 2, heavy: 4 }
  years += drinkScores[lifestyle.sugaryDrinks] || 0

  if (lifestyle.sugaryDrinks === 'heavy') {
    risks.push({
      category: 'ç³–åˆ†æ‘„å…¥',
      description: 'å«ç³–é¥®æ–™æ‘„å…¥è¿‡å¤š',
      risk: 'é«˜é£é™©',
      level: 'high'
    })
  }

  // é¥®é£Ÿè§„å¾‹
  const mealScores = { irregular: 2, somewhat: 1, regular: -1, 'very-regular': -2 }
  years += mealScores[lifestyle.regularMeals] || 0

  return { years, risks }
}

// è®¡ç®—è¿åŠ¨å½±å“
const calculateExerciseImpact = () => {
  let years = 0
  const risks = []

  // è¿åŠ¨å¤©æ•°
  const exerciseDayScores = { none: 5, '1-2': 3, '3-4': 0, '5-6': -2, daily: -3 }
  years += exerciseDayScores[lifestyle.exerciseDays] || 0

  // è¿åŠ¨æ—¶é•¿
  const durationScores = { none: 3, short: 1, moderate: -1, long: -2 }
  years += durationScores[lifestyle.exerciseDuration] || 0

  // æ—¥å¸¸æ´»åŠ¨é‡
  const activityScores = { sedentary: 3, light: 1, moderate: -1, active: -2 }
  years += activityScores[lifestyle.dailyActivity] || 0

  if (lifestyle.exerciseDays === 'none') {
    risks.push({
      category: 'è¿åŠ¨ä¸è¶³',
      description: 'ç¼ºä¹è§„å¾‹è¿åŠ¨',
      risk: 'é«˜é£é™©',
      level: 'high'
    })
  }

  return { years, risks }
}

// è®¡ç®—ç”Ÿæ´»ä¹ æƒ¯å½±å“
const calculateLifestyleImpact = () => {
  let years = 0
  const risks = []

  // ç¡çœ æ—¶é•¿
  const sleepScores = { 'less-5': 4, '5-6': 2, '7-8': -1, '9-plus': 1 }
  years += sleepScores[lifestyle.sleepHours] || 0

  // ç¡çœ è´¨é‡
  const qualityScores = { poor: 3, fair: 1, good: -1, excellent: -2 }
  years += qualityScores[lifestyle.sleepQuality] || 0

  // å‹åŠ›æ°´å¹³
  const stressScores = { 'very-high': 4, high: 2, moderate: 0, low: -1, 'very-low': -2 }
  years += stressScores[lifestyle.stressLevel] || 0

  // å¸çƒŸ
  const smokingScores = { never: -3, quit: 0, occasional: 2, regular: 5, heavy: 8 }
  years += smokingScores[lifestyle.smoking] || 0

  if (lifestyle.smoking === 'heavy') {
    risks.push({
      category: 'å¸çƒŸ',
      description: 'é‡åº¦å¸çƒŸ',
      risk: 'æé«˜é£é™©',
      level: 'very-high'
    })
  }

  // é¥®é…’
  const alcoholScores = { never: -1, rare: 0, moderate: 1, frequent: 3, heavy: 5 }
  years += alcoholScores[lifestyle.alcohol] || 0

  return { years, risks }
}

// ç”Ÿæˆæ”¹å–„å»ºè®®
const generateSuggestions = (suggestions) => {
  suggestions.length = 0

  if (lifestyle.value.fruitsVegetables === 'rare' || lifestyle.value.fruitsVegetables === 'sometimes') {
    suggestions.push({
      priority: 'high',
      icon: 'ğŸ¥—',
      title: 'å¢åŠ è”¬èœæ°´æœæ‘„å…¥',
      description: 'æ¯å¤©è‡³å°‘æ‘„å…¥5ä»½è”¬èœæ°´æœï¼Œæä¾›å……è¶³ç»´ç”Ÿç´ å’Œçº¤ç»´',
      impact: '2-3'
    })
  }

  if (lifestyle.value.exerciseDays === 'none' || lifestyle.value.exerciseDays === '1-2') {
    suggestions.push({
      priority: 'high',
      icon: 'ğŸƒ',
      title: 'å¢åŠ è¿åŠ¨é‡',
      description: 'æ¯å‘¨è‡³å°‘è¿›è¡Œ150åˆ†é’Ÿä¸­ç­‰å¼ºåº¦æœ‰æ°§è¿åŠ¨',
      impact: '3-5'
    })
  }

  if (lifestyle.value.sleepHours === 'less-5' || lifestyle.value.sleepHours === '5-6') {
    suggestions.push({
      priority: 'high',
      icon: 'ğŸ˜´',
      title: 'æ”¹å–„ç¡çœ è´¨é‡',
      description: 'ä¿è¯æ¯æ™š7-8å°æ—¶å……è¶³ç¡çœ ï¼Œå»ºç«‹è§„å¾‹ä½œæ¯',
      impact: '2-4'
    })
  }

  if (lifestyle.value.smoking !== 'never') {
    suggestions.push({
      priority: 'very-high',
      icon: 'ğŸš­',
      title: 'æˆ’çƒŸæˆ–å‡å°‘å¸çƒŸ',
      description: 'å¸çƒŸæ˜¯æœ€å¤§çš„å¥åº·é£é™©å› ç´ ä¹‹ä¸€ï¼Œæˆ’çƒŸæ˜¯å¥åº·æŠ•èµ„çš„æœ€å¥½é€‰æ‹©',
      impact: '5-10'
    })
  }

  if (lifestyle.value.processedFood === 'often') {
    suggestions.push({
      priority: 'medium',
      icon: 'ğŸ³',
      title: 'å‡å°‘åŠ å·¥é£Ÿå“',
      description: 'é€‰æ‹©æ–°é²œã€å¤©ç„¶çš„é£Ÿç‰©ï¼Œå‡å°‘é«˜ç³–ã€é«˜ç›ã€é«˜è„‚åŠ å·¥é£Ÿå“',
      impact: '1-2'
    })
  }

  if (lifestyle.value.stressLevel === 'very-high' || lifestyle.value.stressLevel === 'high') {
    suggestions.push({
      priority: 'medium',
      icon: 'ğŸ§˜',
      title: 'ç®¡ç†å‹åŠ›',
      description: 'å­¦ä¹ æ”¾æ¾æŠ€å·§ï¼Œå¦‚å†¥æƒ³ã€æ·±å‘¼å¸ã€ç‘œä¼½ç­‰',
      impact: '1-3'
    })
  }

  // æŒ‰ä¼˜å…ˆçº§æ’åº
  suggestions.sort((a, b) => {
    const priorityOrder = { 'very-high': 4, high: 3, medium: 2, low: 1 }
    return priorityOrder[b.priority] - priorityOrder[a.priority]
  })
}

// è·å–å¥åº·å¹´é¾„æ ·å¼
const getHealthAgeClass = () => {
  if (results.value.healthAge === 0) return 'text-gray-600'
  const diff = results.value.ageDifference

  if (diff <= -5) return 'text-green-600'
  if (diff <= -2) return 'text-blue-600'
  if (diff <= 2) return 'text-yellow-600'
  return 'text-red-600'
}

// è·å–å¹´é¾„å·®å¼‚æ ·å¼
const getAgeDifferenceClass = () => {
  const diff = results.value.ageDifference

  if (diff <= -5) return 'bg-green-50 border-green-200'
  if (diff <= -2) return 'bg-blue-50 border-blue-200'
  if (diff <= 2) return 'bg-yellow-50 border-yellow-200'
  return 'bg-red-50 border-red-200'
}

// è·å–å¹´é¾„å·®å¼‚é¢œè‰²
const getAgeDifferenceColorClass = () => {
  const diff = results.value.ageDifference

  if (diff <= -5) return 'text-green-600'
  if (diff <= -2) return 'text-blue-600'
  if (diff <= 2) return 'text-yellow-600'
  return 'text-red-600'
}

// è·å–å¥åº·çŠ¶æ€æ–‡æœ¬
const getHealthStatusText = () => {
  const diff = results.value.ageDifference

  if (diff <= -5) return 'å¥åº·çŠ¶å†µä¼˜ç§€'
  if (diff <= -2) return 'å¥åº·çŠ¶å†µè‰¯å¥½'
  if (diff <= 2) return 'å¥åº·çŠ¶å†µä¸€èˆ¬'
  if (diff <= 5) return 'éœ€è¦æ”¹å–„'
  return 'éœ€è¦ç«‹å³æ”¹å–„'
}

// è·å–å¥åº·çŠ¶æ€æè¿°
const getHealthStatusDescription = () => {
  const diff = results.value.ageDifference

  if (diff <= -5) return 'æ‚¨çš„å¥åº·å¹´é¾„æ¯”å®é™…å¹´é¾„å°å¾ˆå¤šï¼Œç”Ÿæ´»æ–¹å¼éå¸¸å¥åº·ï¼Œç»§ç»­ä¿æŒï¼'
  if (diff <= -2) return 'æ‚¨çš„å¥åº·å¹´é¾„æ¯”å®é™…å¹´é¾„å°ï¼Œç”Ÿæ´»ä¹ æƒ¯è‰¯å¥½ï¼Œå†æ¥å†å‰ï¼'
  if (diff <= 2) return 'æ‚¨çš„å¥åº·å¹´é¾„ä¸å®é™…å¹´é¾„ç›¸è¿‘ï¼Œå¯ä»¥é€‚å½“æ”¹å–„ç”Ÿæ´»æ–¹å¼ã€‚'
  if (diff <= 5) return 'æ‚¨çš„å¥åº·å¹´é¾„æ¯”å®é™…å¹´é¾„å¤§ï¼Œå»ºè®®æ”¹å–„ç”Ÿæ´»ä¹ æƒ¯ã€‚'
  return 'æ‚¨çš„å¥åº·å¹´é¾„æ˜æ˜¾å¤§äºå®é™…å¹´é¾„ï¼Œè¯·ç«‹å³å’¨è¯¢åŒ»ç”Ÿå¹¶æ”¹å–„ç”Ÿæ´»æ–¹å¼ã€‚'
}

// è·å–å¥åº·çŠ¶æ€æ ·å¼
const getHealthStatusClass = () => {
  const diff = results.value.ageDifference

  if (diff <= -5) return 'bg-green-50 border-green-200 text-green-800'
  if (diff <= -2) return 'bg-blue-50 border-blue-200 text-blue-800'
  if (diff <= 2) return 'bg-yellow-50 border-yellow-200 text-yellow-800'
  if (diff <= 5) return 'bg-orange-50 border-orange-200 text-orange-800'
  return 'bg-red-50 border-red-200 text-red-800'
}

// è·å–é£é™©å› ç´ æ ·å¼
const getRiskFactorClass = (level) => {
  if (level === 'very-high') return 'bg-red-50 border-red-200'
  if (level === 'high') return 'bg-orange-50 border-orange-200'
  if (level === 'medium') return 'bg-yellow-50 border-yellow-200'
  if (level === 'low') return 'bg-blue-50 border-blue-200'
  return 'bg-green-50 border-green-200'
}

// è·å–é£é™©ç­‰çº§æ ·å¼
const getRiskLevelClass = (level) => {
  if (level === 'very-high') return 'text-red-600 font-bold'
  if (level === 'high') return 'text-orange-600 font-semibold'
  if (level === 'medium') return 'text-yellow-600'
  if (level === 'low') return 'text-blue-600'
  return 'text-green-600'
}

// è·å–å»ºè®®æ ·å¼
const getSuggestionClass = (priority) => {
  if (priority === 'very-high') return 'border-red-200 bg-red-50'
  if (priority === 'high') return 'border-orange-200 bg-orange-50'
  if (priority === 'medium') return 'border-yellow-200 bg-yellow-50'
  return 'border-blue-200 bg-blue-50'
}
</script>

<style scoped>
input[type="number"],
select {
  transition: border-color 0.2s, box-shadow 0.2s;
}

input[type="number"]:focus,
select:focus {
  outline: none;
  border-color: #3b82f6;
  box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}
</style>